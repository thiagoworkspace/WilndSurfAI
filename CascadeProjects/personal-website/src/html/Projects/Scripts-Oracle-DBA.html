<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Scripts Oracle DBA </title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="7ff962ea-140c-432c-b409-4bd858af0402" class="page sans"><header><h1 class="page-title">Scripts Oracle DBA </h1><p class="page-description"></p></header><div class="page-body"><p id="15277f1a-4a4a-414a-afac-9d1879c6a671" class="">
</p><figure id="d12ca3a7-0642-4b0d-8dc4-5fd365930ec3" class="link-to-page"><a href="https://www.notion.so/Steps-to-create-a-new-Oracle-database-19c-d12ca3a706424b0d8dc45fd365930ec3?pvs=21">Steps to create a new Oracle database (19c).</a></figure><figure id="7842b276-3ede-4947-b574-df2fd7908b76" class="link-to-page"><a href="https://www.notion.so/Create-Configure-Remove-Oracle-Database-with-DBCA-7842b2763ede4947b574df2fd7908b76?pvs=21">Create/Configure/Remove Oracle Database with DBCA</a></figure><p id="e90efbc4-ef9c-4b34-8582-e3e05f22df47" class=""><a href="https://unknowndba.blogspot.com/2018/03/asmdush-far-better-du-for-asmcmd.html">https://unknowndba.blogspot.com/2018/03/asmdush-far-better-du-for-asmcmd.html</a></p><p id="7024d938-0756-47aa-a358-d2dffeee2859" class=""><a href="https://raw.githubusercontent.com/freddenis/oracle-scripts/master/asmdu.sh">https://raw.githubusercontent.com/freddenis/oracle-scripts/master/asmdu.sh</a></p><p id="47e56e04-2ef7-4de7-9a0e-e398f27e47c6" class="">
</p><p id="2360ba11-3d80-4e0d-ab9c-466fd49617bb" class="">
</p><p id="60dc078d-b535-494b-88c9-cd152d7f2729" class=""><a href="https://github.com/freddenis/oracle-scripts">https://github.com/freddenis/oracle-scripts</a></p><p id="a27ada40-8f9b-49a7-9f8b-f4541edcd9c6" class="">
</p><p id="e9da1ef2-ddd7-4198-93d9-cf3eecbd68e1" class=""><a href="https://dbabrasil.net.br/db4/arquivos/palestras/Frank_Weber_Faust_DBABrasil4_0_Must_have_free_scripts_when_working_with_Exadata_GI_ASM_opatch.pdf">https://dbabrasil.net.br/db4/arquivos/palestras/Frank_Weber_Faust_DBABrasil4_0_Must_have_free_scripts_when_working_with_Exadata_GI_ASM_opatch.pdf</a></p><p id="75a0f66e-241b-4f20-8728-eac827fbbbe4" class="">/tog</p><p id="b1b27adc-fc47-4068-988b-65418dbe1230" class=""><mark class="highlight-red">/**************************************************************************************<br/>---------------------------------------- ORACLE UTILITARIOS  --------------------<br/>**************************************************************************************/</mark></p><ul id="fc2b49f5-a85b-462d-88af-d362433544ea" class="toggle"><li><details open=""><summary>Para verificar os SID (System ID) e os valores do ORACLE_HOME dos bancos no servidor linux</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ab582914-7d3b-45bd-81cb-1b7b33a24cf4" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">vi /etc/oratab</code></pre></details></li></ul><ul id="27f898cf-dc72-4bc0-afac-fbb7698c227f" class="toggle"><li><details open=""><summary>Para se conectar ao usuário oracle</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="215f5a86-1ea4-466b-a633-45a33f0ace21" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">su - oracle</code></pre></details></li></ul><ul id="30f82d46-5b5a-4c6b-a42d-c70a54e9ea2d" class="toggle"><li><details open=""><summary>Comando ORAENV e  setar as variáveis de ambiente oracle de um jeito mais facil</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4cc060c2-fc66-4e33-985a-3b30f0636f64" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">. oraenv
&gt; ORACLE_SID

obs → o oraenv é um utilitario que ao passar o nome da instancia ja “seta” automaticamente as variaveis de ambiente necessarias</code></pre></details></li></ul><ul id="c1563d8a-69bb-4826-a240-2efa6beee117" class="toggle"><li><details open=""><summary>Comandos para gerenciar o Listener </summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ffee963b-46cd-4686-9bb4-e3956299a757" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">lsnrctl status
lsnrctl start
lsnrctl stop
obs → para startar o listener e necessario que as variaveis de ambiente ja sejam setadas</code></pre></details></li></ul><ul id="c76de0e3-ab2f-4db7-90c7-6ca6b2feb6a7" class="toggle"><li><details open=""><summary>Para se conectar ao sqlplus como sys e/ou com outro usuario</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f84680a3-76db-472a-8e03-62d3f40d91b2" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">sqlplus / as sysdba

sqlplus sys@banco (de um servidor com o client oracle)

sqlplus user/senha

sqlplus &#x27;user/senha&#x27; (caso a senha tenha caracter especial)

sqlplus user/&#x27;senha&#x27; (caso a senha tenha caracter especial)

sqlplus user/senha@banco as sysdba (de um servidor com o client oracle, caso a senha tenha caracter especial)

o barra ( / ) indica uma conexao local</code></pre></details></li></ul><ul id="3d2e59c1-e311-41b3-a78e-6437c899a1d7" class="toggle"><li><details open=""><summary>Comandos para start/stop de um banco ou uma instancia (em caso de single instance) via SQLPLUS</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="88132287-aec6-4f39-ab63-b82777c2d322" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">startup ( start na instancia, aloca a SGA starta os processos background, mounted, open)
shutdown ( database close, database dismount, instance shut down

--variações
startup nomount -&gt; ( start na instancia, aloca a SGA starta os processos background acessando o spfile )
startup mount -&gt; ( start na instancia, aloca a SGA starta os processos background, mounted, mas o banco nao esta disponivel para usuario apenas para dbas )
startup pfile=&lt;dir&gt; (start na instância usando um PFILE diferente)
shutdown immediate -&gt; ( desliga o banco )
shutdown abort -&gt; ( forca o desligamento do banco de uma vez só )

obs → Se foi utilizado o comando startup nomount para dar continuidade basta apenas rodar o comando “ALTER DATABASE MOUNT;” em seguida podemos rodar o “ALTER DATABASE OPEN;” liberando o banco para acessos externos ;</code></pre></details></li></ul><ul id="87706071-687a-4964-a6a7-89aa181c9e49" class="toggle"><li><details open=""><summary>Comandos para start/stop/status de um banco ou uma instancia (m caso de RAC) direto no terminal linux</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ba73ec98-e9af-42a5-9dac-81e8166510a8" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">srvctl stop database -d &lt;database_name&gt; -o immediate
srvctl start database -d &lt;database_name&gt;
srvctl status database -d &lt;database_name&gt;</code></pre></details></li></ul><ul id="f747ced6-7924-41bc-b7b1-1df4de6c1a1d" class="toggle"><li><details open=""><summary>Script para consultar a versão do banco de dados</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5b95cac8-0366-4e2f-b1fe-e928ea340b1a" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select * from v$version;</code></pre></details></li></ul><ul id="3de21cf2-d3a4-4c4c-af4d-d43e53cd602d" class="toggle"><li><details open=""><summary>Parametro para definir a instancia primaria e secundaria, valor default é nao tem valor</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="299221e4-d832-4345-a590-4e0ffa1e300c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SHOW PARAMETER ACTIVE_INSTANCE_COUNT</code></pre></details></li></ul><ul id="4a078ac5-0fc1-4a90-9154-bb2a70a270e7" class="toggle"><li><details open=""><summary>Script para consultar queries que foram marcadas pelo AWR.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="05758d3c-6a86-48c4-9be4-f0384694dde7" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT *
FROM DBA_HIST_COLORED_SQL;</code></pre></details></li></ul><ul id="465aabbc-0ebb-4695-9737-66e2c359e00b" class="toggle"><li><details open=""><summary>Script para rodar o lsinventory do Opatch</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0129a41a-9636-4cda-9fd0-64442c63cbf0" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#Conectar com o user ORACLE e setar o ORAENV
su - oracle
. oraenv
&gt; oracle_sid
#Acessar o diretorio do Opatch
cd $ORACLE_HOME/OPatch
#Rodar o comando abaixo para gerar um arquivo com as informações
./opatch lsinventory -detail &gt; /tmp/lsinv202YMMDD_detail.txt</code></pre></details></li></ul><ul id="8ff37c80-02f6-4ae8-ade1-d0d6cc1e5640" class="toggle"><li><details open=""><summary>Script para coletar o TFA</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8b55bfd3-f7c8-422e-8670-bc291a3f790e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">
#Conectar com o user ORACLE e setar o ORAENV
su - oracle
. oraenv
&gt; oracle_sid
#Executar o comando abaixo para gerar o diagnostico do TFA
tfactl diagcollect -database DDFE -from &quot;2022-09-12 09:00:00&quot; -to &quot;2022-09-16 17:00:00&quot;</code></pre></details></li></ul><ul id="60a40574-3007-4150-a76b-3a8237496b26" class="toggle"><li><details open=""><summary>Script para consultar o RECYCLEBIN (Lixeira) do ORACLE</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="05e35ca8-7ce9-4343-b90b-a2f237e1cd65" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT OWNER, OBJECT_NAME, OPERATION, DROPTIME FROM dba_recyclebin
ORDER BY 4 DESC;
/
SELECT OWNER, COUNT(*) FROM dba_recyclebin
GROUP BY OWNER;</code></pre></details></li></ul><ul id="3db8ba49-5717-4440-ac16-5ce71465e555" class="toggle"><li><details open=""><summary>Script para limpar a RECYCLEBIN</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aeedf411-dfb3-4555-981c-3bf5525d8123" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">PURGE dba_recyclebin;</code></pre></details></li></ul><ul id="672121a1-d962-42a0-a71c-9bfabdcc06c1" class="toggle"><li><details open=""><summary>Comando shell para mostrar como esta o status do RAC</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cf88cec6-fb5d-4758-9f2a-37bc208d2ed8" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#com o user ORACLE, primeiro setar o . ORAENV
./rac_status.sh</code></pre></details></li></ul><ul id="7808417b-fd5f-4ffc-be6f-62da157cb32b" class="toggle"><li><details open=""><summary>Passo a Passo para limpar o diretório /u01 quanto estiver cheio.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d9bc8dbc-0604-4c0e-bb71-b6dcffd3add5" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#Podem ser excluidos os arquivos no diretorio /trace (.trc e .trm) e no /alert (.xml)
#tbm pode ser executado o comando purge para excluir os arquivos TFA gerados automaticamente
#executado com o comando root
tgactl purge -older 90d -force

</code></pre></details></li></ul><ul id="46e02b4e-fa44-43be-b80e-9aca077fb60d" class="toggle"><li><details open=""><summary>Comandos GRID (single instance)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d475b765-58a9-45cb-8904-4391df6a1c70" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all"># rodar com user grid
su - grid
#mostra todos os recursos que estão online
crsctl status res -t

#rodar com user root

#status do cluster
$GRID_HOME/bin/crsctl stat res -t
--ou
/u01/app/21.0.0.0/grid/bin/crsctl stat res -t
#parar os serviços
$GRID_HOME/bin/crsctl stop has
--ou
/u01/app/21.0.0.0/grid/bin/crsctl stop has
#para startar 
$GRID_HOME/bin/crsctl start has
--ou
/u01/app/21.0.0.0/grid/bin/crsctl start has
# Por padrão os serviços do grid sobem sozinhos quando startamos a maquina novamente (junto com o listener)</code></pre></details></li></ul><ul id="299effea-4296-4557-8e10-2733e74b0c02" class="toggle"><li><details open=""><summary>Comandos ORACLEASM</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="06ba827c-e3a5-4763-a946-1fbb6931350f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all"># Comando para iniciar o ORACLEASM (ele cria um diretorio chamado /dev/oracleasm/disks)
oracleasm init

# Comando para consultar o status e discover
oracleasm status
oracleasm-discover

# Criando os ALIAS ASM para as partições
oracleasm createdisk ASMDATA01 /dev/sdb1
oracleasm createdisk ARCH01 /dev/partition

# Comando para listar os alias ASM
oracleasm listdisks
</code></pre></details></li></ul><ul id="dec35621-f803-4166-8e3b-dbb16c335232" class="toggle"><li><details open=""><summary>Scripts para consultar informações de ASM disk e diskgroups </summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="695e8a9b-f6b7-4ab5-ba69-1e91949a7ecb" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">set pagesize 200
set lines 200
set long 1000
col path for a50
col name for a10
col header_Status for a12
col read_mb for 99999.99
col write_mb for 99999.99
select name, path, header_status, total_mb, free_mb, trunc(bytes_read/1024/1024) read_mb, trunc(bytes_written/1024/1024)
write_mb from v$asm_disk;</code></pre></details></li></ul><ul id="6dd73bbf-02c2-44e3-b336-d6eeb0658c56" class="toggle"><li><details open=""><summary>Script para consultar o tamanho e o espaço livre em um ASM diskgroup</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d895d21f-5bf0-46ec-ba3e-a98e57b43fcb" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">col name for a10
col percentage 999.99
SELECT name, free_mb, total_mb, free_mb/total_mb*100 as percentage FROM v$asm_diskgroup;</code></pre></details></li></ul><ul id="9ec73ed5-c85d-4de5-9649-c6770b01166e" class="toggle"><li><details open=""><summary>Utilitario ASMCA (ASM Configuration Assistant</summary><p id="10ded4f4-710c-42a7-a792-1641d36781e6" class="">
</p></details></li></ul><ul id="9631ff75-5f98-473a-979a-309ca3d424ce" class="toggle"><li><details open=""><summary>Query para consultar o uptime do banco</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="184e5bfb-76de-4f8b-859b-50becb35dad9" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT host_name, instance_name,
TO_CHAR(startup_time, &#x27;DD-MM-YYYY HH24:MI:SS&#x27;) startup_time,
FLOOR(sysdate-startup_time) days
FROM sys.v_$instance;</code></pre></details></li></ul><ul id="17ba4cec-feeb-4a16-93b7-60027d402b7f" class="toggle"><li><details open=""><summary>Comando para listar as configs de um db (rac)-</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ad7dbf46-3696-48ad-9948-8a537bd194c6" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">srvctl config database -d &lt;database_name&gt;</code></pre></details></li></ul><ul id="5141c64b-d9a4-41b5-b7b3-5eb1804c744b" class="toggle"><li><details open=""><summary>Comando para alterar o SPFILE atual por um PFILE modificado</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ca4f3c49-ccf4-4e1e-96fb-78c4fee9be36" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">srvctl modify database -d &lt;database_name&gt; -spfile &lt;dir&gt;
# é necessario fazer o restar do banco</code></pre></details></li></ul><ul id="099117a9-2ad0-4855-a779-56bbdbb51ca5" class="toggle"><li><details open=""><summary>Criação e uso de logs de erro para operações DML</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="01b3e184-b471-4965-be6f-d19c60c93a53" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">-- Link do artigo:
https://www.profissionaloracle.com.br/2023/12/19/dbms_errlog-criacao-e-uso-de-logs-de-erro-para-operacoes-dml/?utm_source=linkedin&amp;utm_medium=social&amp;utm_campaign=ReviveOldPost

--Passo a Passo para criar e usar logs de erro para operações DML:
-- 1. Criar uma tabela de log de erro usando a função DBMS_ERROLOG.CREATE_LOG.
-- Passar como parametros os nomes da tabela alvo do DML e a tabela de error de logs
 BEGIN
 DBMS_ERRLOG.CREATE_ERROR_LOG(
	  dml_table_name =&gt; &#x27;TABLE DE ORIGEM&#x27;,
    err_log_table_name =&gt; &#x27;ERR_TABLE DE DESTINO&#x27;
    );
  END;
  /
  
 -- 2. Executar as instruções DML usando a cláusula LOG ERROS, que recebe como parametro
 -- o nome da tabela de erro, a tag da operação e o limite de rejeição;
 -- Essa cláusula faz com que a operação DML continue a executar mesmo que ocorram erros
 -- e que as linhas que falharam sejam registradas na tabela de log de erro.
 -- o Limite de rejeição é o numero maximo de erros que a operação pode torelar antes
 -- de ser abortada. Se o limite for omitido ou zero nao terar limite de erros
 -- Quando o limite for atingido, a operação será desfeita e nenhum registro será inserido
 -- na tabela de log.
  INSERT INTO &lt;TABLE_DE_ORIGEM&gt; VALUES (1, &#x27;x&#x27;, &#x27;x&#x27;, &#x27;x&#x27;)
 LOG ERRORS INTO &lt;err_table&gt; (&#x27;op1&#x27;) REJECT LIMIT 10;
 
 -- 3. query para consultar a tabela de erro usando comandos SQL, para verificar as linhas que
 -- Falharam, os codigos e as mensagens de erros, e as tags das operações.

SELECT * FROM err_clientes;

-- Resultado: exibe os registros da tabela de log de erro
ORA_ERR_NUMBER$ ORA_ERR_MESG$                          ORA_ERR_ROWID$ ORA_ERR_OPTYP$ ORA_ERR_TAG$ ID NOME   EMAIL            TELEFONE
--------------- -------------------------------------- -------------- -------------- ------------ -- ------ ---------------- ------------
1               ORA-00001: unique constraint (SYS_C00  AAABWMAAAACgCw0 I              op1          1  Daniel daniel@gmail.com 44-4444-4444
1400            ORA-01400: cannot insert NULL into (&quot;  AAABWMAAAACgCw1 I              op1          4        elisa@gmail.com  55-5555-5555
12899           ORA-12899: value too large for column  AAABWMAAAACgCw2 I              op1          5  Fabio  fabio@gmail.com  66-6666-666666
</code></pre></details></li></ul><ul id="4d65abde-a63d-4499-9f80-2ede639b0574" class="toggle"><li><details open=""><summary>Criando um novo CDB usando SILENT MODE do DBCA</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c823ae5a-7d8c-4931-afa3-fba310e77fdc" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Primeiro passo é criar um arquivo .sh e editar com os seguintes parametros
vi CrCDBTEST.sh

$ORACLE_HOME/bin/dbca -silent -createDatabase -
templateName General_Purpose.dbc -gdbname &lt;CDBTEST&gt; -sid 
&lt;CDBTEST&gt; -createAsContainerDatabase true -numberOfPDBs 0 -
useLocalUndoForPDBs true -responseFile NO_VALUE -totalMemory 
1800 -sysPassword &lt;password&gt; -systemPassword &lt;password&gt; -
pdbAdminPassword &lt;password&gt; -emConfiguration DBEXPRESS -
dbsnmpPassword &lt;password&gt; -emExpressPort 5502 -enableArchive 
true -recoveryAreaDestination 
/u01/app/oracle/fast_recovery_area -recoveryAreaSize 15000 -
datafileDestination /u01/app/oracle/oradata


--Rodar o arquivo .sh

./CrCDBTEST.sh
--Apos a edição do arquivo, conceder permissão de execução
chmod 755 CrCDBTEST.sh


--Após a conclusão, verificar a nova entrada no arquivo oratab
cat /etc/oratab

-- Conectar ao novo banco
. oraenv
ORACLE_SID = [orclcdb] ? CDBTEST
The Oracle base remains unchanged with value /u01/app/oracle
[oracle@edvmr1p0 DBMod_CreateDB]$ sqlplus / as sysdba
SQL*Plus: Release 19.0.0.0.0 - Production on Mon Oct 26 
18:01:44 2020
Version 19.3.0.0.0
Copyright (c) 1982, 2019, Oracle. All rights reserved.
Connected to:
Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 -
Production
Version 19.3.0.0.0
SQL&gt; select cdb from v$database;
CDB
---
YES
SQL&gt;</code></pre></details></li></ul><ul id="36151632-2935-4a29-9857-a4b50cd67b56" class="toggle"><li><details open=""><summary>Criando um novo CDB com CREATE DATABASE (não levando em conta ASM)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="187e4f53-e0d6-4ba4-ae11-d65b73aa152c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">-- 1) Criar um arquivo CreateCDB.sql e inserir o seguinte script
CREATE DATABASE &lt;cdbname&gt; 
USER SYS IDENTIFIED BY &lt;password&gt; 
USER SYSTEM IDENTIFIED BY &lt;password&gt;
 EXTENT MANAGEMENT LOCAL DEFAULT TEMPORARY TABLESPACE temp 
 DEFAULT TABLESPACE users 
 UNDO TABLESPACE undotbs1 
 ENABLE PLUGGABLE DATABASE;
 
 
 -- 2) setar o . oraenv com o nome da nova instancia e seu home (não necessariamente precisa existir para setar)
 -- ps: o ORACLE_HOME pode ser igual dos outros ja instalado, pegar no /etc/oratab
[oracle@oraclearch DBMod_CreateDB]$ . oraenv
ORACLE_SID = [orcl] ? CDBDEV
ORACLE_HOME = [/home/oracle] ? /u01/app/oracle/product/19.0.0/dbhome_1
The Oracle base remains unchanged with value /u01/app/oracle
[oracle@oraclearch DBMod_CreateDB]$


-- 3) Criar o parametro de inicialização (SPFILE) do modelo de template do proprio oracle
[oracle@oraclearch DBMod_CreateDB]$ cd $ORACLE_HOME/dbs
[oracle@oraclearch dbs]$ cp init.ora initCDBDEV.ora

-- editar o arquivo com as configs basicas abaixo:
db_name=&#x27;CDBDEV&#x27;
memory_target=1G
processes = 150
audit_file_dest=&#x27;/u01/app/oracle/admin/CDBDEV/adump&#x27;
audit_trail =&#x27;db&#x27;
db_block_size=8192
db_recovery_file_dest=&#x27;/u01/app/oracle/fast_recovery_area&#x27;
db_recovery_file_dest_size=2G
diagnostic_dest=&#x27;/u01/app/oracle&#x27;
dispatchers=&#x27;(PROTOCOL=TCP) (SERVICE=CDBDEVXDB)&#x27;
open_cursors=300
remote_login_passwordfile=&#x27;EXCLUSIVE&#x27;
undo_tablespace=&#x27;UNDOTBS1&#x27;
control_files = (&#x27;/u02/oradata/ora_control01.ctl&#x27;,&#x27;/u01/app/oracle/fast_recovery_area/ora_control02.ctl&#x27;)
compatible =&#x27;19.0.0.0&#x27;
DB_CREATE_FILE_DEST=&#x27;/u02/oradata&#x27;
ENABLE_PLUGGABLE_DATABASE=true
	
	
-- 4) Verificar se os diretorios DB_CREATE_FILE_DEST, AUDIT_FILE_DEST, e o DB_RECOVERY_FILE_DEST
-- existem Usar o comando abaixo para criar caso não exista
$ mkdir -p /u01/app/oracle/admin/CDBDEV/adump
$ ls /u01/app/oracle/fast_recovery_area
CDBTEST ORCLCDB RCATCDB
$ ls /u01/app/oracle/oradata
ORCLCDB RACTCDB
 
 
 
-- 5) Subir a instancia no modo NOMOUNT.

$ sqlplus / AS SYSDBA
Connected to an idle instance.
SQL&gt; STARTUP NOMOUNT
...
SQL&gt;

-- 6) Executar o script sql com o CREATE DATABASE

SQL&gt; @/home/oracle/labs/DBMod_CreateDB/CrCDBDEV.sql
Database created.
SQL&gt;


--OBS -&gt; Se receber erros do CREATE DATABASE, use o comando shutdown abort.
-- Corrigir os errose restart
-- Checar o arquivo de inicialização

-- 7) Executar os scripts catalog e catproc.
SQL&gt; @$ORACLE_HOME/rdbms/admin/catalog.sql
…
SQL&gt; @$ORACLE_HOME/rdbms/admin/catproc.sql
...
SQL&gt;

-- OBS -&gt; O script catalog.sql leva em torno de 3 minutos para completar
-- enquanto o script catproc.sql leva em torno de 30 miinutos para completar


-- 8) Sair do sqlplus
SQL&gt; EXIT
…
$

-- 9) Adicionar uma nova entrada no arquivo oratab com o seguinte passo

$ echo &quot;CDBDEV:/u01/app/oracle/product/19.0.0/dbhome_1:N&quot; &gt;&gt; /etc/oratab

-- 10) Verificar a nova entrada no arquivo oratab

$ cat /etc/oratab
…
#
orclcdb:/u01/app/oracle/product/19.3.0/dbhome_1:Y
CDBDEV:/u01/app/oracle/product/19.3.0/dbhome_1:N

-- 11) No proximo . oraenv agora não é mais necessario passar o ORACLE_HOME
-- visto que o ORACLE_SID já está adicionado no /et/oratab
$ . oraenv
ORACLE_SID = [CDBDEV] ? CDBDEV
The Oracle base remains unchanged with value /u01/app/oracle
$

-- 12) Verificar se o novo banco é um CDB
$ sqlplus / as sysdba
…
Version 19.3.0.0.0
SQL&gt; select cdb from v$database;
CDB
---
YES
SQL

-- 13) Verificar se os datafiles estão no diretorio correto
SQL&gt; set pagesize 100
SQL&gt; column name format a130
SQL&gt; select name from v$datafile order by 1;
NAME
--------------------------------------------------------------
------------------
/u01/app/oracle/oradata/CDBDEV/B29964A7B1066D26E0536310ED0A031
2/datafile/o1_mf_s
ysaux_hsgbrmkx_.dbf
/u01/app/oracle/oradata/CDBDEV/B29964A7B1066D26E0536310ED0A031
2/datafile/o1_mf_s
ystem_hsgbrgd1_.dbf
/u01/app/oracle/oradata/CDBDEV/B29964A7B1066D26E0536310ED0A031
2/datafile/o1_mf_u
sers_hsgbrp5k_.dbf
/u01/app/oracle/oradata/CDBDEV/datafile/o1_mf_sysaux_hsgbrlw5_
.dbf
/u01/app/oracle/oradata/CDBDEV/datafile/o1_mf_system_hsgbrfc8_
.dbf
/u01/app/oracle/oradata/CDBDEV/datafile/o1_mf_undotbs1_hsgbro6
7_.dbf
/u01/app/oracle/oradata/CDBDEV/datafile/o1_mf_users_hsgbroj3_.
dbf
7 rows selected.
SQL&gt;


-- 14) Verificar se as tablespaces estão criadas para o CDB$ROOT

SQL&gt; SELECT tablespace_name, contents FROM dba_tablespaces;
TABLESPACE_NAME CONTENTS
------------------------------ ---------------------
SYSTEM PERMANENT
SYSAUX PERMANENT
UNDOTBS1 UNDO
TEMP TEMPORARY
USERS PERMANENT
SQL&gt;


-- 15) (optional) Verificar se a porta do EM Express está correta:
SQL&gt; select dbms_xdb_config.gethttpsport() from dual;
DBMS_XDB_CONFIG.GETHTTPSPORT()
------------------------------
 0
SQL&gt;
</code></pre></details></li></ul><ul id="312591f8-06e1-49d4-b0f3-5e7d240cdd22" class="toggle"><li><details open=""><summary>Comando SHOW CON_NAME</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5f2c3ecc-35ac-41bc-94af-863b8d7b4498" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SQL&gt; SHOW CON_NAME

CON_NAME
------------------------------
CDB$ROOT
SQL&gt;</code></pre></details></li></ul><ul id="c0e3ff5a-20f1-4ab4-b2b7-daaac53b3c84" class="toggle"><li><details open=""><summary>Query para consultar informações de CPU, Memoria, Sockets do servidor</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="45472280-2777-47eb-a01d-cf8c475dcf18" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">set pagesize 299
set lines 299
select STAT_NAME,to_char(VALUE) as VALUE ,COMMENTS from v$osstat where 
stat_name IN (&#x27;NUM_CPUS&#x27;,&#x27;NUM_CPU_CORES&#x27;,&#x27;NUM_CPU_SOCKETS&#x27;)
union
select STAT_NAME,ROUND((VALUE/1024/1024/1024),2) || &#x27; GB&#x27; ,COMMENTS from v$osstat where 
stat_name IN (&#x27;PHYSICAL_MEMORY_BYTES&#x27;);</code></pre></details></li></ul><ul id="37124623-9280-43e7-ab95-2d892d7cdf29" class="toggle"><li><details open=""><summary>Passo a Passo para atualizar o Opatch + aplicar patches</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="494f46ce-ca2d-4131-8809-87d04f02da3c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all"># OBS: Caso esteja em um ambiente clusterizado, com mais de um node, deve seguir os passos abaixo para cada node - rowlling.

# 1 - Com o Paatch number em mãos pesquisar o patch, fazer o download do mesmo no site do suporte Oracle na aba &quot;Patches &amp; Updates&quot;
# Filtrar pelo Patch number + A versão da plataform ex Linux x86-64, selecionar o patch e
# na proxima tela baixar o &quot;read me&quot; fazer o download do patch.

# 2 - Com o patch baixado, subir o .zip no diretorio /temp (ou em algum outro diretorio usado para patches) do servido (com o usuario root).

# 3 - Mudar a permissão do arquivo para oracle e descompactar o arquivo.
 chown oracle:oinstall &lt;nome_patch&gt;.zip
 unzip &lt;nome_patch&gt;.zip
 
# 4 - De volta no &quot;readme&quot; aberto no navegador, verificar qual versão do Opatch é necessario para aplicação do Patch.
# 5 - Verificar no servidor o Opatch atual e comparar com o pedido no read me. 
# Para isso com o usuario oracle, setar um oraenv do dbhome que irá receber o patch. 
# Fazer um cd para o diretorio ORACLE_HOME 
 cd $ORACLE_HOME/OPatch
 
# 6 - Rodar o comando abaixo e comparar com o readme
 ./opatch version
 
# OBS: Caso a versão esteja diferente da recomendada, 
#deve-se acessar o link abaixo para baixar a versão pedida do Opatch 
# (SELECIONAR O PATCH E A PLATAFORMA CORRETA), 
# caso contrario pular os passos até a etapa de bkp dos binarios
# no link abaixo, apontar o a &quot;Release&quot; desejada + a plataforma ex Linux x86-64
https://updates.oracle.com/download/6880880.html

# Caso precise ser atualizado o OPatch seguir os passos abaixo:
# 7 - subir o .zip no diretorio /temp do servido (com o usuario root) 
# e mudar as permissões para oracle:oinstall
	# 7.1 - (com o usuario oracle) Entrar no diretorio ORACLE_HOME e fazer um bkp da pasta OPatch/ 
	# (pode ser feito dentro do proprio ORACLE_HOME)
	cd $ORACLE_HOME/
	mv OPatch/ OPatch_bkp/
	# 7.2 - Ainda dentro do oracle_home, descompactar o .zip do novo OPatch
	unzip -oq /tmp/p6880880&lt;versao&gt;Linux-x86-64.zip
	# 7.3 - Entrar no novo diretorio do OPatch e rodar novamente a versão para confirmar.
	./opatch version
	
# Com o Opatch atualizado, seguir com a aplicação do Patch.

# 1 - Fazer o backup dos binários (db_home) que será aplicado o patch
	# 1.1 - Criar uma pasta de bkp em algum diretorio de bkp do servidor e dar permissão de oracle:oinstall
	# 1.2 - Entrar no diretorio /u01/app/oracle/product/&lt;versao_oracle&gt;, exemplo
	cd /u01/app/oracle/product/11.2.0/
	
	# 1.3 - rodar o comando abaixo para fazer um bkp zipado do dbhome desejado
	tar -pcvf /BACKUP4/&lt;diretorio_bkp&gt;/nome_bkp.tar &lt;dbhome_desejado&gt;/

# 2 - Fazer um bkp de todos os bancos que compõem o dbhome (verificar se os bancos estão em archivemode on para ser feito o bkp online).
# 3 - Parar (stop) os bancos
# OBS: caso esteja em um ambiente não-grid, será necessário parar o LISTENER também.

# 4 - Entrar o no diretorio do patch descompactado e rodar o comando abaixo para verificar se não há mais requisitos para fazer antes do patch
$ORACLE_HOME/OPatch/opatch prereq CheckConflictAgainstOHWithDetail -phBaseDir .

# 5 - Caso não tenha mais nenhum pré-requisito, rodar o comando abaixo para aplicar o patch. Pode levar alguns minutos
$ORACLE_HOME/OPatch/opatch apply

# 6 - Após a conclusão da aplicação, rodar o comando abaixo para validar o novo patch
$ORACLE_HOME/OPatch/opatch lsinventory | grep &lt;patch_number&gt;
$ORACLE_HOME/OPatch/opatch lspatches

# 7 - Subir novamente as instancias.
</code></pre></details></li></ul><ul id="1976711a-61bf-4029-b383-568ffbe53bc6" class="toggle"><li><details open=""><summary>Query para listar os parâmetros de configuração</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="31463da0-eeaa-4073-b237-0881f471bebc" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT NAME, ISSES_MODIFIABLE, ISSYS_MODIFIABLE, ISPDB_MODIFIABLE FROM V$PARAMETER;</code></pre></details></li></ul><ul id="f53f2850-ae10-4aee-99be-34ce03631f33" class="toggle"><li><details open=""><summary>Query para listar os caminhos dos alert logs, trace e incidents.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="13eaa274-c8f3-46b5-ad42-463f01f46477" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM gV$DIAG_INFO;</code></pre></details></li></ul><ul id="7edd4fae-2141-4207-9f9e-956511f7b59b" class="toggle"><li><details open=""><summary>ORACLE SQL TUNING ADVISOR</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5837bdff-b4b4-47d9-9460-64e67ba87ff6" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#passar o sql_id da query que queremos analisar + um nome para a tarefa


declare
task_nm varchar2(100);
begin
task_nm := dbms_sqltune.create_tuning_task(SQL_ID=&gt; &#x27;&lt;sql_id&gt;&#x27;,TASK_NAME =&gt; &#x27;SQL_TUNNING_TASK_&lt;sql_id&gt;&#x27;);
end;
/


#Rodar o tuning task
exec dbms_sqltune.execute_tuning_task (TASK_NAME =&gt; &#x27;SQL_TUNNING_TASK_5t5mxfm0ph3n0&#x27;);

#ou rodar via sqlplus
SQL &gt; @create_tuning_task.sql;
Task_Name:
Informe o valor para sql_id:
Informe o valor para time_limit:

#Apos a conclusão, rodar o sql abaixo para listar as recomendações.
SET LONG 10000;
SET PAGESIZE 1000;
SET LINESIZE 200;
SELECT DBMS_SQLTUNE.report_tuning_task(&#x27;SQL_TUNNING_TASK_&lt;sql_id&gt;&#x27;) AS recommendations FROM dual;
SET PAGESIZE 24;


#comando para excluir a tarefa
execute dbms_sqltune.drop_tuning_task( &#x27;SQL_TUNNING_TASK_5t5mxfm0ph3n0&#x27; );


/*
As Finding Sections que contêm as sentenças que ele encontrou como:

- Statistics Finding: Criação de estatisticas em uma tabela obsoleta que a consulta lê
- Index Finding: O que sugere a criação de index no campo que estava na clausula where
- SQL Profile Finding: Sugere habilitar o SQL Profile que ele criou que faz uso de um plano melhor
*/
#OBS -&gt; Caso recomende criar um SQL Profile ou rodar a coleta de estatistica ir na
# aba propria de cada uma nessa documentação.

#Exemplo de saida
RECOMMENDATIONS
--------------------------------------------------------------------------------
GENERAL INFORMATION SECTION
-------------------------------------------------------------------------------
Tuning Task Name   : SQL_TUNNING_TASK_5t5mxfm0ph3n0
Tuning Task Owner  : SYS
Workload Type      : Single SQL Statement
Scope              : COMPREHENSIVE
Time Limit(seconds): 1800
Completion Status  : COMPLETED
Started at         : 01/01/2021 17:22:25
Completed at       : 01/01/2021 17:22:54

-------------------------------------------------------------------------------
Schema Name: USERS
SQL ID     : 5t5mxfm0ph3n0
SQL Text   : SELECT   TR.NAME,
                                                                  TR.AGE,
                                                                  TR.CITY,
                                                                  TR.SIGN_DATE
                                                            FROM    USERS.CUSTOMERS TR
                                                            WHERE   
                                                                  TR.SIGN_DATE  = TO_DATE(&#x27;30/12/2020&#x27;,&#x27;DD/MM/YYYY&#x27;)

-------------------------------------------------------------------------------
FINDINGS SECTION (3 findings)
-------------------------------------------------------------------------------

1- Statistics Finding
---------------------
  Optimizer statistics for table &quot;USERS&quot;.&quot;CUSTOMERS&quot; are stale.

  Recommendation
  --------------
  - Consider collecting optimizer statistics for this table and its indices.
    execute dbms_stats.gather_table_stats(ownname =&gt; &#x27;USERS&#x27;, tabname =&gt;
            &#x27;CUSTOMERS&#x27;, estimate_percent =&gt;
            DBMS_STATS.AUTO_SAMPLE_SIZE, method_opt =&gt; &#x27;FOR ALL COLUMNS SIZE
            AUTO&#x27;, cascade =&gt; TRUE);

  Rationale
  ---------
    The optimizer requires up-to-date statistics for the table and its indices
    in order to select a good execution plan.


2- Index Finding (see explain plans section below)
--------------------------------------------------
  The execution plan of this statement can be improved by creating one or more
  indices.
 
  Recommendation (estimated benefit: 99.99%)
  ------------------------------------------
  - Consider running the Access Advisor to improve the physical schema design
    or creating the recommended index.
    create index USERS.IDX$$_17C0B0001 on
    USERS.CUSTOMERS(&quot;SIGN_DATE&quot;);
	
3- SQL Profile Finding (see explain plans section below)
--------------------------------------------------------
  A potentially better execution plan was found for this statement.

  Recommendation (estimated benefit: 68.27%)
  ------------------------------------------
  - Consider accepting the recommended SQL profile.
    execute dbms_sqltune.accept_sql_profile(task_name =&gt;
            &#x27;SQL_TUNNING_TASK_5t5mxfm0ph3n0&#x27;, task_owner =&gt; &#x27;SYS&#x27;, replace =&gt;
            TRUE);

-------------------------------------------------------------------------------
EXPLAIN PLANS SECTION
-------------------------------------------------------------------------------

1- Original With Adjusted Cost
------------------------------
Plan hash value: 321555184

--------------------------------------------------------------------------------
| Id  | Operation            | Name             | Rows  | Bytes | Cost (%CPU)| T
--------------------------------------------------------------------------------
|   0 | SELECT STATEMENT     |                  |     6 |   330 |    19   (0)| 0
|   1 |  PX RDINATOR      |                  |       |       |            |
|   2 |   PX SEND QC (RANDOM)| :TQ10000         |     6 |   330 |    19   (0)| 0
|   3 |    PX BLOCK ITERATOR |                  |     6 |   330 |    19   (0)| 0
|*  4 |     TABLE ACCESS FULL| CUSTOMERS |     6 |   330 |    19   (0)| 0
--------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   4 - filter(&quot;TR&quot;.&quot;SIGN_DATE&quot;=TO_DATE(&#x27; 2020-12-30 00:00:00&#x27;, &#x27;syyyy-mm-dd&#x27;)

2- Using SQL Profile
--------------------
Plan hash value: 3378393080

--------------------------------------------------------------------------------
| Id  | Operation                           | Name               | Rows  | Bytes
--------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                    |                    |     6 |   330
|   1 |  PARTITION RANGE SINGLE             |                    |     6 |   330
|   2 |   INLIST ITERATOR                   |                    |       |
|   3 |    TABLE ACCESS BY LOCAL INDEX ROWID| CUSTOMERS   |     6 |   330
|*  4 |     INDEX RANGE SCAN                | INX_CUSTOMERS_1 |     1 |
--------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   4 - access(&quot;TR&quot;.&quot;SIGN_DATE&quot;=TO_DATE(&#x27; 2020-12-30 00:00:00&#x27;, &#x27;syyyy-mm-dd&#x27;)
        

-------------------------------------------------------------------------------

PL/SQL procedure successfully completed


</code></pre></details></li></ul><ul id="601f1ceb-4e1f-4420-9d54-dc3086b6d162" class="toggle"><li><details open=""><summary>ORACLE Flashback</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="111f11bc-e0f6-4c92-80c5-411ebbe581d7" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--OBS: Para que o flashback funcione, a tabela nao deve ter sofrido nenhum tipo de alteração
-- a nivel de DDL

--Query para consultar o SCN atual
SELECT current_scn FROM v$database;

--Query para habilitar o row movement (se necessario)
ALTER TABLE schema.tabela disable ROW MOVEMENT;

-- Comando para efetuar o flashback utilizando a data desejada.
FLASHBACK TABLE schema.tabela TO TIMESTAMP TO_TIMESTAMP(&#x27;14/08/2024 16:28:00&#x27;, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;);

-- Comando para efeutar o flashback utilizando o SCN
FLASHBACK TABLE schema.tabela TO SCN (&lt;scn&gt;);

</code></pre></details></li></ul><ul id="1f1864eb-009a-8046-be53-c13ae18e4333" class="toggle"><li><details open=""><summary>Script para consultar o tempo (previsão) do fim do backup do rman</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1f1864eb-009a-801b-acf2-d60078555fcb" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT 
    sl.sid, 
    sl.serial#, 
    sl.elapsed_seconds,
    sl.time_remaining,
    TO_CHAR(ROUND(100 * (sofar / totalwork), 1), &#x27;90.0&#x27;) || &#x27;%&#x27; AS pct_done, 
    sl.start_time,
    TO_CHAR(SYSDATE + (sl.time_remaining / 86400), &#x27;DD-MON-YYYY HH24:MI:SS&#x27;) AS done_by,
    sl.opname
FROM v$session_longops sl
WHERE sofar != totalwork
AND totalwork &gt; 0
ORDER BY sl.start_time DESC;</code></pre></details></li></ul><ul id="24c864eb-009a-8060-8e62-d75a6ad79280" class="toggle"><li><details open=""><summary>DBSAT</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="24c864eb-009a-8097-a277-d4cc412c6418" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">  --1) Logar no servidor com o usuario ORACLE
	--2) oraenv (na instancia desejada)
	--3) Acessar o diretorio /home/oracle/ACS/dbsat/
	--4) Executar o script abaixo, no final será criado um arquivo .json
			./dbsat collect -n SYSTEM &lt;instancia_collect&gt;
	-- OBS: Vai ser solicitado a senha do system.
	
	--5) Executar o script abaixo, no final será criado 4 arquivos .html, .json, .txt, .xlsx
			./dbsat report -a -n &lt;instancia_collect&gt;
			
	--6) Baixar o arquivo .html contendo todas as analises coletadas.
			
	 </code></pre></details></li></ul><ul id="28e864eb-009a-800f-8923-ffceaef58eba" class="toggle"><li><details open=""><summary>Passo a passo para correção de STARTUP UPGRADE com erro ORA-39701</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="28e864eb-009a-806a-8e21-d8c7372cc0a9" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Durante alguma atividade que seja para subir uma instancia em modo STARTUP UPGRADE em um ambiente GRID (com mais de 2 nodes)
--Caso retorne o erro abaixo, seguir os passos para correção.

SQL&gt; Startup upgrade
ORACLE instance started.
Total System Global Area 1.3262E+11 bytes
Fixed Size                  2304584 bytes
Variable Size            2.2481E+10 bytes
Database Buffers         1.1006E+11 bytes
Redo Buffers               74080256 bytes
Database mounted.
ORA-01092: ORACLE instance terminated. Disconnection forced
ORA-39701: database must be mounted EXCLUSIVE for UPGRADE or DOWNGRADE
Process ID: 29206
Session ID: 2002 Serial number: 3

--
</code></pre></details></li></ul><p id="a20f699d-4a18-47ca-906e-260bd12540b8" class=""><mark class="highlight-red">/**************************************************************************************<br/>---------------------------------------- TABLESPACES / DATAFILES --------------------<br/>**************************************************************************************/</mark></p><ul id="72ae2b23-c340-4444-a155-e3ebb8c500a6" class="toggle"><li><details open=""><summary>Consultar as tablespaces do banco</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6a5d11cc-facd-45c1-91ff-2b27a7b075dd" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT TABLESPACE_NAME, STATUS FROM DBA_TABLESPACES;</code></pre></details></li></ul><ul id="7aa20752-fcab-49c4-9259-589ea638e263" class="toggle"><li><details open=""><summary>Consultar as tablespaces e seus datafiles</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b19aa8a6-2cf2-44ac-aa56-a00043d5696e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">COLUMN TABLESPACE_NAME FORMAT A10
COLUMN FILE_NAME FORMAT A50
COLUMN STATUS FORMAT A10
SELECT TABLESPACE_NAME,
			 FILE_NAME,
			 STATUS
FROM DBA_DATA_FILES;</code></pre></details></li></ul><ul id="8db4982c-4b91-4b82-9364-669b3fedd455" class="toggle"><li><details open=""><summary>Consultar a tablespace temp e seus datafiles</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="446a3817-62c9-4c96-92bf-92d25446dcfb" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">COLUMN TABLESPACE_NAME FORMAT A10
COLUMN FILE_NAME FORMAT A50
SELECT TABLESPACE_NAME,
		   FILE_NAME
FROM DBA_TEMP_FILES;</code></pre></details></li></ul><ul id="877cf270-8d4e-4943-a681-685d247b2c8b" class="toggle"><li><details open=""><summary>Script para criação de uma tablespace</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a594492f-e8f1-4c91-8aa0-a5f23eb49b05" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">CREATE TABLESPACE &lt;TBS_NAME&gt; 
       DATAFILE &#x27;DIR/&lt;NAME_TS_01.dbf&#x27; SIZE 1G AUTOEXTEND ON NEXT 32M MAXSIZE UNLIMITED,
									&#x27;DIR/&lt;NAME_TS_01.dbf&#x27; SIZE 1G AUTOEXTEND ON NEXT 32M MAXSIZE UNLIMITED #CASO PRECISE POR MAIS DE UM DBF
			 EXTENT MANAGEMENT LOCAL AUTOALLOCATE SEGMENT SPACE MANAGEMENT AUTO LOGGING;


    OBS → O valor do parametro UNLIMITED varia do tamanho dos datablocks.. por exemplo se o banco foi criado definindo para os datablocks tamanho de 8kbs o valor máximo de unlimited será de 32GB.</code></pre></details></li></ul><ul id="56c27c74-1a1d-45e1-945c-b10399eaf140" class="toggle"><li><details open=""><summary>Adicionando mais datafiles a um tbs.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="88fa638e-594a-418b-9cc9-f9f4009a8f13" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ALTER TABLESPACE &lt;TBS_NAME&gt; ADD DATAFILE &#x27;DIR/&lt;NOVO_DBF&gt;.dbf&#x27;
SIZE 1G AUTOEXTEND ON NEXT 32M
MAXSIZE UNLIMITED;</code></pre></details></li></ul><ul id="e9da4114-4e0e-4a16-964a-2ed0a20583ac" class="toggle"><li><details open=""><summary>Dropar uma tablespace junto com seus datafiles e constraints</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="febd31ec-3f7f-40fd-8ce0-81badb8711ce" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">DROP TABLESPACE &lt;TS_NAME&gt; INCLUDING CONTENTS AND DATAFILES CASCADE CONSTRAINTS;</code></pre></details></li></ul><ul id="87c97805-2538-4d07-ba23-a7e0be7062d6" class="toggle"><li><details open=""><summary>Script para consultar o historico de crescimento de uma tablespace</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8ed6a375-bbc8-4edb-ae44-23e1dfde6c8e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select * from (select (select name from v$tablespace t where t.ts# = tablespace_id) tablespace_name,
       rtime,
       round(tablespace_size*8192/1024/1024/1024, 4) tablespace_size,
       round(tablespace_maxsize*8192/1024/1024/1024, 4) tablespace_maxsize,
       round(tablespace_usedsize*8192/1024/1024/1024, 4) tablespace_usedsize
from dba_hist_tbspc_space_usage) where tablespace_name=&#x27;UNDOTBS1&#x27; order by rtime desc;</code></pre></details></li></ul><ul id="03538f93-fcbd-4491-9ac3-16b6ab141fa2" class="toggle"><li><details open=""><summary>Script para consultar o tamanho da tbs no momento</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8fe12735-c9be-4983-a478-eadd1caf27cd" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select * from dba_tablespace_usage_metrics
where tablespace_name in (&#x27;&lt;TBS1&gt;&#x27;, &#x27;&lt;TBS2&#x27;)
order by 1;

obs → 

- A coluna TABLESPACE_NAME mostra o nome da tablespace, por padrão o Mega utiliza a TSD_MEGA;
- A coluna USED_SPACE mostra qual é o espaço físico que a tablespace aloca;
- A coluna TABLESPACE_SIZE mostra qual é o tamanho limite que a tablespace pode atingir;
- A coluna USED_PERCENT mostra qual é o percentual de utilização de espaço.

  mais links para consulta de tbs ( [link1](https://eduardolegatti.blogspot.com/2013/01/monitorando-o-percentual-de-espaco.html) )</code></pre></details></li></ul><div><ul id="e528a52d-acf4-4886-8c56-626c666ae8c9" class="toggle"><li><details open=""><summary>Script para consultar o tamanho de todos os tablespaces</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="548f0a9a-a8aa-41c3-a818-60c93f7e467c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">set linesize 130 #utilizar essa linha somente se for no SQLPLUS
set pagesize 500 #utilizar essa linha somente se for no SQLPLUS
select df.tablespace_name tablespace, df.total_space_mb total_space_mb,
(df.total_space_mb - fs.free_space_mb) used_space_mb, fs.free_space_mb free_space_mb,
round(100 * (fs.free_space / df.total_space),2) &quot;livre_%&quot;
from (select tablespace_name, sum(bytes) total_space,
      round(sum(bytes) / 1048576) total_space_mb
      from dba_data_files
      group by tablespace_name) df,
     (select tablespace_name, sum(bytes) free_space,
       round(sum(bytes) / 1048576) free_space_mb
       from dba_free_space
       group by tablespace_name) fs
where df.tablespace_name = fs.tablespace_name(+)
order by 5;</code></pre></details></li></ul></div><ul id="24cb9acf-d979-496c-a2b2-cb99e1fbe9bf" class="toggle"><li><details open=""><summary>Consultar o tamanho total, livre e usado da tablespace (MELHORAR ESSA QUERY)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9dfdff66-4289-4b1d-8ab6-80661ac74667" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select a.tablespace_name,
	   a.status,
	   b.tamanho,
	   c.livre,
	   b.tamanho - c.livre usado
from dba_tablespaces a, (select tablespace_name,
                         sum(bytes)/1024/1024 tamanho
						 from dba_data_files
						 group by tablespace_name) b,
						(select tablespace_name,
						 sum(bytes)/1024/1024 livre
						 from dba_free_space
						 group by tablespace_name
						 ) c
where a.tablespace_name = b.tablespace_name
and a.tablespace_name = c.tablespace_name;</code></pre></details></li></ul><ul id="9f52a99c-f66a-4269-bd41-c68c15137c2a" class="toggle"><li><details open=""><summary>Script para mover um segmento (tabela) para uma determinada tbs</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a2753c66-3fea-4c92-be82-78d8bd487694" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ALTER TABLE &lt;TABLE_NAME&gt; MOVE TABLESPACE &lt;TBS_NAME&gt;;</code></pre></details></li></ul><ul id="b992401f-1f7e-42ed-a18e-10d3984bf64b" class="toggle"><li><details open=""><summary>Scripts para consultar se a tabela está com HCC habilitada</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="89a7df88-6b44-4995-8597-63fedfea84c9" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select owner, table_name,compression, compress_for
from dba_tables
where compression = &#x27;ENABLE&#x27;
order by 1,2;</code></pre></details></li></ul><ul id="32a8acd9-2685-4095-a566-d753c05cfefb" class="toggle"><li><details open=""><summary>Script para consultar se existem table partitions com compress(HCC)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cb677bb8-e681-4e33-84de-8b4c04417664" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT partition_name, compression
FROM   user_tab_partitions
where compression &lt;&gt; &#x27;ENABLE&#x27;;</code></pre></details></li></ul><ul id="bb5cb81f-f59c-4980-8ddb-b83dddf1cc5e" class="toggle"><li><details open=""><summary>Script para aplicar a compressão (HCC) em tabelas a nivel de estrutura e dados</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="178bb3e1-6140-48be-be03-a9e2a8b5c7e8" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ALTER TABLE &lt;table_name&gt; COMPRESS;
ALTER TABLE &lt;table_name&gt; MOVE COMPRESS;</code></pre></details></li></ul><ul id="0568edb4-273a-4636-9553-2834cf848ce6" class="toggle"><li><details open=""><summary>Script para remover a compressão (HCC) de tabelas a nivel de estrutura e dados</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c9c5f272-4cd0-4a35-a16d-6859fa599998" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ALTER TABLE &lt;table_name&gt; NOCOMPRESS;
ALTER TABLE &lt;table_name&gt; MOVE NOCOMPRESS;

#Caso a tabela esteja particionada e subparticionada, usar as seguintes queries
#para que monta automaticamente o alter table move nocompress para eles

--HCC nivel de tabela 
SELECT OWNER,
       TABLE_NAME,
       COMPRESSION 
FROM DBA_TABLES 
WHERE OWNER LIKE &#x27;U%&#x27; AND COMPRESSION &lt;&gt; &#x27;DISABLED&#x27;;

/
--HCC nivel de partição
SELECT TABLE_OWNER,
       TABLE_NAME, 
       PARTITION_NAME, 
       COMPRESSION, 
       COMPRESS_FOR, 
       TABLESPACE_NAME 
       FROM DBA_TAB_PARTITIONS
WHERE TABLE_OWNER LIKE &#x27;U%&#x27;
AND COMPRESSION &lt;&gt; &#x27;DISABLED&#x27;;


/
--HCC nivel de subpartição
SELECT TABLE_OWNER, 
       TABLE_NAME,
       PARTITION_NAME, 
       SUBPARTITION_NAME,
       COMPRESSION, 
       COMPRESS_FOR, 
       TABLESPACE_NAME
FROM DBA_TAB_SUBPARTITIONS
WHERE TABLE_OWNER LIKE &#x27;U%&#x27;
AND COMPRESSION &lt;&gt; &#x27;DISABLED&#x27;;


/

--Remover a Compressão de partições
SELECT &#x27;ALTER TABLE &#x27; || TABLE_OWNER || &#x27;.&#x27; || TABLE_NAME || &#x27; MOVE PARTITION &#x27; || PARTITION_NAME || &#x27; NOCOMPRESS;&#x27;
FROM DBA_TAB_PARTITIONS
WHERE TABLE_OWNER LIKE &#x27;U%&#x27; AND COMPRESSION &lt;&gt; &#x27;DISABLED&#x27;;

--CASO DE ERRO EM ALGUMA PARTIÇÃO E NÃO CONSEGUIR REALIZAR O NOCOMPRESS, UTILIZAR A VARIAÇÃO DA QUERY ABAIXO
SELECT &#x27;ALTER TABLE &#x27; || TABLE_OWNER || &#x27;.&#x27; || TABLE_NAME || &#x27; NOCOMPRESS;&#x27;
FROM DBA_TAB_PARTITIONS
WHERE TABLE_OWNER LIKE &#x27;U%&#x27; AND COMPRESSION &lt;&gt; &#x27;DISABLED&#x27;;

/



--Remover a Compressão de subpartições
SELECT &#x27;ALTER TABLE &#x27; || TABLE_OWNER || &#x27;.&#x27; || TABLE_NAME || &#x27; MOVE SUBPARTITION &#x27; || SUBPARTITION_NAME || &#x27; NOCOMPRESS;&#x27;
FROM DBA_TAB_SUBPARTITIONS
WHERE TABLE_OWNER LIKE &#x27;U%&#x27; AND COMPRESSION &lt;&gt; &#x27;DISABLED&#x27;;</code></pre></details></li></ul><ul id="e3876b51-09c0-4cdd-a373-1d24b8249c26" class="toggle"><li><details open=""><summary>Script para consultar qual tablespace uma determinada tabela pertence</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b9e75f37-2603-41b1-b600-532056c05036" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">select t.table_name, t.tablespace_name as &quot;TS Name For Table&quot;,
       i.index_name, i.tablespace_name as &quot;TS Name For Indexes&quot;
  from user_tables t
  join user_indexes i on i.table_name = t.table_name
 order by t.table_name, i.index_name;</code></pre></details></li></ul><ul id="7b0db9aa-5151-41f7-83f7-96f0dbff4d60" class="toggle"><li><details open=""><summary>Script para consultar o que está consumindo na tablespace SYSAUX</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e64034b2-0d5f-4eca-b637-7b6698bfaaf3" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM 
(SELECT OWNER, SEGMENT_NAME || &#x27;~&#x27; || PARTITION_NAME SEGMENT_NAME, (BYTES/(1024*1024*1024)) SIZE_B
FROM DBA_SEGMENTS
WHERE TABLESPACE_NAME = &#x27;SYSAUX&#x27; ORDER BY BLOCKS DESC) WHERE ROWNUM &lt; 6;</code></pre></details></li></ul><ul id="cbd402cb-944c-4073-ba6f-af003709644e" class="toggle"><li><details open=""><summary>Script para alterar o tablespace padrão de um user.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b3a3be77-6206-4d9b-83fe-be19a850488a" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">alter user &lt;username&gt; default tablespace users;</code></pre></details></li></ul><ul id="5d47902c-c2b4-418e-aa9b-a212b81b9101" class="toggle"><li><details open=""><summary>Script para consultar o max_size de uma tablespace</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="926e4539-d139-423e-869c-77b4eac87a5f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select tablespace_name, max_size 
from dba_tablespaces</code></pre></details></li></ul><ul id="054fac2e-4bc6-47cd-9873-ad18bfb4e63d" class="toggle"><li><details open=""><summary>Monitorar o consumo da tablespace TEMP</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9992b8b7-9f4f-4e79-912f-01142b16c88c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select 
    a.tablespace_name tablespace, 
    ROUND(d.TEMP_TOTAL_GB, 2), 
    ROUND((sum (a.used_blocks * d.block_size) / 1024 / 1024/1024), 2) TEMP_USED_GB, 
    ROUND((d.TEMP_TOTAL_GB - sum (a.used_blocks * d.block_size) / 1024 / 1024/1024)) TEMP_FREE_GB 
from v$sort_segment a, 
( 
    select b.name, 
           c.block_size, 
           sum (c.bytes) / 1024 / 1024/1024 TEMP_TOTAL_GB 
    from v$tablespace b, v$tempfile c 
    where b.ts#= c.ts# 
    group by b.name, 
             c.block_size 
) d 
where a.tablespace_name = d.name 
group by a.tablespace_name, d.TEMP_TOTAL_GB;</code></pre></details></li></ul><ul id="2b6864eb-009a-8019-9193-fa2ae3f2875f" class="toggle"><li><details open=""><summary>Shell script para criacao automatica de dbfs via crontab</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b6864eb-009a-804d-a6af-df077822c849" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">WITH dfcalc AS (
    SELECT  tablespace_name,
            SUM(bytes) AS total_space,
            ROUND(SUM(bytes) / 1048576) AS total_space_mb,
            ROUND(SUM(maxbytes) / 1048576) AS maximo
    FROM dba_data_files
    GROUP BY tablespace_name
),

fscalc AS (
    SELECT  tablespace_name,
            SUM(bytes) AS free_space,
            ROUND(SUM(bytes) / 1048576) AS free_space_mb
    FROM dba_free_space
    GROUP BY tablespace_name
),

-- Captura o número do datafile extraindo padrões como _01.dbf, _7.dbf, _12.dbf etc.
maxdf AS (
    SELECT df.tablespace_name,
           df.file_name,
           TO_NUMBER(
               REGEXP_SUBSTR(df.file_name, &#x27;_([0-9]+)\.dbf&#x27;, 1, 1, NULL, 1)
           ) AS file_number
    FROM dba_data_files df
),

-- Seleciona somente o MAIOR número de datafile por tablespace
max_by_tbs AS (
    SELECT tablespace_name,
           file_name,
           file_number,
           ROW_NUMBER() OVER (PARTITION BY tablespace_name ORDER BY file_number DESC) AS rn
    FROM maxdf
)

SELECT 
    d.tablespace_name,

    CASE 
        WHEN m.file_number + 1 &lt; 10 THEN
            &#x27;ALTER TABLESPACE &quot;&#x27; || d.tablespace_name || 
            &#x27;&quot; ADD DATAFILE &#x27;&#x27;&#x27; ||
            REGEXP_REPLACE(m.file_name, &#x27;_([0-9]+)\.dbf&#x27;, &#x27;_&#x27; ||
                           LPAD(m.file_number + 1, 2, &#x27;0&#x27;) || &#x27;.dbf&#x27;) ||
            &#x27;&#x27;&#x27; SIZE 1G AUTOEXTEND ON NEXT 32M MAXSIZE UNLIMITED&#x27;
        ELSE
            &#x27;ALTER TABLESPACE &quot;&#x27; || d.tablespace_name ||
            &#x27;&quot; ADD DATAFILE &#x27;&#x27;&#x27; ||
            REGEXP_REPLACE(m.file_name, &#x27;_([0-9]+)\.dbf&#x27;, &#x27;_&#x27; ||
                           (m.file_number + 1) || &#x27;.dbf&#x27;) ||
            &#x27;&#x27;&#x27; SIZE 1G AUTOEXTEND ON NEXT 32M MAXSIZE UNLIMITED&#x27;
    END AS comando_add_datafile

FROM dfcalc d
JOIN fscalc f ON d.tablespace_name = f.tablespace_name
JOIN max_by_tbs m ON d.tablespace_name = m.tablespace_name AND m.rn = 1

WHERE ((d.total_space_mb - f.free_space_mb) / d.maximo * 100) &gt;= 82
AND d.tablespace_name NOT IN (&#x27;SAS_WORK_TS_IDX&#x27;,&#x27;SAS_WORK_TS&#x27;,&#x27;SAS_WORK_USR_TS&#x27;)
AND d.tablespace_name LIKE &#x27;%_TS%&#x27;          -- ✔ filtro solicitado

ORDER BY d.tablespace_name;
</code></pre></details></li></ul><p id="77bb7fc4-ba83-46e9-a2c6-a94232a11b02" class="">
</p><p id="3009ccea-7545-4a17-9f03-e63db8c06651" class=""><mark class="highlight-red">/**************************************************************************************<br/>---------------------------------------- SCHEMAS / USERS --------------------<br/>**************************************************************************************/</mark></p><ul id="42ed7345-d9cf-494b-8174-4494be409a80" class="toggle"><li><details open=""><summary>Exemplo de script para criação de schema</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9d8440c9-2889-4cfb-99ff-ffa3da0e90ad" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">CREATE USER &lt;nome_schema&gt; PROFILE &quot;DEFAULT&quot; 
IDENTIFIED BY &quot;&lt;senha&gt;&quot; DEFAULT TABLESPACE &quot;&lt;tablespace&gt;&quot; 
TEMPORARY TABLESPACE &quot;TEMP&quot; QUOTA UNLIMITED ON &quot;&lt;tablespace&gt;&quot; 
QUOTA UNLIMITED ON &quot;&lt;tablespace_IDX&gt;&quot; ACCOUNT UNLOCK;
GRANT UNLIMITED TABLESPACE TO &quot;&lt;tablespace&gt;&quot;;
GRANT &quot;CONNECT&quot; TO &quot;&lt;nome_schema&gt;&quot;;
GRANT &quot;DBA&quot; TO &quot;&lt;nome_schema&gt;&quot;;
GRANT CREATE TABLE TO &quot;&lt;nome_schema&gt;&quot;;
GRANT CREATE SESSION TO &quot;&lt;nome_schema&gt;&quot;;
GRANT &quot;&lt;rolex&gt;&quot; TO &quot;&lt;nome_schema&gt;&quot;;
GRANT &quot;&lt;roley&gt;&quot; TO &quot;&lt;nome_schema&gt;&quot;;
GRANT &quot;&lt;rolez&gt;&quot; TO &quot;&lt;nome_schema&gt;&quot;;</code></pre></details></li></ul><ul id="76936034-2d56-4133-8113-1c07a66f32a5" class="toggle"><li><details open=""><summary>Exemplo de criação de usuário</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f684aa8d-b690-42b2-bc15-671c429b2fce" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">CREATE USER &quot;THIAGO&quot; IDENTIFIED BY &quot;********&quot; ACCOUNT UNLOCK;
GRANT &quot;DBA&quot; TO &quot;THIAGO&quot;;
GRANT &quot;CONNECT&quot; TO &quot;THIAGO&quot;;
GRANT CREATE SESSION TO &quot;THIAGO&quot;;</code></pre></details></li></ul><ul id="6573104b-449e-4eb6-a160-6e5543c3f681" class="toggle"><li><details open=""><summary>Dropar schema/users</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c6aeebea-7b2d-41d1-a81f-dcd5ceae11ad" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">drop user &lt;nome_schema&gt; cascade;</code></pre></details></li></ul><ul id="2fd54bfc-c9c4-4c7b-a7b8-f6091755a41f" class="toggle"><li><details open=""><summary>Script force drop</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9e9ad293-384f-4f7f-8c10-ba166dd5aa77" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">DECLARE
  open_count integer;
BEGIN
  -- prevent any further connections
  EXECUTE IMMEDIATE &#x27;alter user @USERNAME account lock&#x27;;
  --kill all sessions
  FOR session IN (SELECT sid, serial# 
                  FROM  v$session 
                  WHERE username = &#x27;@USERNAME&#x27;)
  LOOP
    -- the most brutal way to kill a session
    EXECUTE IMMEDIATE &#x27;alter system disconnect session &#x27;&#x27;&#x27; || session.sid || &#x27;,&#x27; || session.serial# || &#x27;&#x27;&#x27; immediate&#x27;;
  END LOOP;
  -- killing is done in the background, so we need to wait a bit
  LOOP
    SELECT COUNT(*) 
      INTO open_count 
      FROM  v$session WHERE username = &#x27;@USERNAME&#x27;;
    EXIT WHEN open_count = 0;
    dbms_lock.sleep(0.5);
  END LOOP;
  -- finally, it is safe to issue the drop statement
  EXECUTE IMMEDIATE &#x27;drop user @USERNAME cascade&#x27;;
END;</code></pre></details></li></ul><ul id="bfd89e66-89a4-4f0e-b2af-2b1693f69b08" class="toggle"><li><details open=""><summary>Script para consultar o tamanho de um schema</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="af4f6f99-8d36-4dd2-8241-3a901b2efb9f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select owner AS Schema, 
       sum(bytes/1024/1024/1024) AS size_in_GB
from dba_segments
where OWNER = &#x27;&lt;schema_name&gt;&#x27;
group by owner
order by owner desc;</code></pre></details></li></ul><ul id="814ed3f3-a64f-4d86-a645-94114fdbaf66" class="toggle"><li><details open=""><summary>Script para consultar o tamanho do schema, agrupado por seguimentos.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5a1b166b-40bd-41d8-9765-5d525c812f1a" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select segment_type, sum(bytes)/1024/1024/1024 size_in_GB
from dba_segments
where OWNER = &#x27;&#x27;
group by segment_type;</code></pre></details></li></ul><ul id="dc926f26-6752-4c57-a7c5-e2c9a853f58b" class="toggle"><li><details open=""><summary>Script para consultar o tamanho de um seguimento (tabela)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8ecdda63-82aa-4eef-9479-88f6ef45de7f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select segment_name,segment_type, sum(bytes/1024/1024/1024) GB
 from dba_segments
 where segment_name IN (&#x27;DIM_PESSOA&#x27;, &#x27;FAT_COMPARATIVO&#x27;)
group by segment_name,segment_type;</code></pre></details></li></ul><ul id="01384277-c97a-4b16-89a4-db441e625fdc" class="toggle"><li><details open=""><summary>Script para consultar se um usuário esta bloqueado ou não</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cca6e2bf-3dfd-41f9-aeb2-74e29e766ced" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT username, account_status, created, lock_date, expiry_date
  FROM dba_users
 WHERE account_status != &#x27;OPEN&#x27;;</code></pre></details></li></ul><ul id="9cc67e95-b654-490b-b515-33b30ed6a687" class="toggle"><li><details open=""><summary>Query para checar as roles concedidas de um usuário.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="38d1b5ef-5bea-48b5-a9df-344e8fb8d6bc" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT *
FROM DBA_ROLE_PRIVS
WHERE GRANTEE = &#x27;&amp;USER&#x27;;</code></pre></details></li></ul><ul id="e8ac54d7-02f4-4d0b-a1d2-201a4e19748c" class="toggle"><li><details open=""><summary>Query para checar as os privilégios concedidos para um usuário</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e576e0ec-aa5e-4af2-8fca-fe51b5bdaf60" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT *
FROM DBA_TAB_PRIVS
WHERE GRANTEE = &#x27;&amp;USER&#x27;</code></pre></details></li></ul><ul id="27f5be49-6477-4305-9221-3430dd168fd0" class="toggle"><li><details open=""><summary>Query para checar os privilégios dados a uma role concedida a um usuário</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a6445c1b-ecf0-4369-a30b-1ee1cc6299b5" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM DBA_TAB_PRIVS WHERE GRANTEE IN
(SELECT granted_role FROM DBA_ROLE_PRIVS WHERE GRANTEE = &#x27;&amp;USER&#x27;) order by 3;</code></pre></details></li></ul><ul id="acc6b00e-5fac-4a80-a7e5-d790ec865bf6" class="toggle"><li><details open=""><summary>Script para exibir todos os objetos pertencentes ao seu usuário.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aa10c106-a107-4c47-b71a-a8b3ba50f512" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM user_objects;</code></pre></details></li></ul><ul id="c1a2a572-0168-492b-830f-2b20b05c0e61" class="toggle"><li><details open=""><summary>Script para exibir todos os objetos pertencentes a usuário e aos quais tem acesso.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e6f3e2e9-0634-441f-97d6-b1cb6e47cf44" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM all_objects;</code></pre></details></li></ul><ul id="8e4de4c8-8c58-45a2-b18b-17a1d4d51706" class="toggle"><li><details open=""><summary>Script usado para consultar as tentativas de login com falha</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0a671bf6-ee6b-4cf2-9d9f-8ca92dfd6618" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SET SERVEROUTPUT ON
EXEC DBMS_OUTPUT.PUT_LINE(SQLERRM(-904));

SELECT INSTANCE_NUMBER INUM,
       OS_USERNAME,
       USERNAME,
       USERHOST,
       TO_CHAR(EXTENDED_TIMESTAMP,&#x27;DD-MON-YYYY HH24:MI:SS&#x27;) TIMESTAMP,
       ACTION_NAME,
       RETURNCODE,
       TERMINAL AS &quot;MACHINE&quot;
FROM
       DBA_AUDIT_SESSION
WHERE 
       EXTENDED_TIMESTAMP &gt; (SYSDATE - 1) AND RETURNCODE &gt; 0 and USERNAME
ORDER BY EXTENDED_TIMESTAMP desc;</code></pre></details></li></ul><ul id="08f746b1-549c-4f4b-b92b-cf7cc23e5306" class="toggle"><li><details open=""><summary>Script usado para consultar o ultimo login/logoff de um usuario</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3ba158e5-3b95-492f-8885-b0823bd695eb" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT ACTION_NAME,  MAX(to_char(TIMESTAMP, &#x27;hh24:mi:ss dd/mm/yy&#x27;)) LAST_LOGIN, USERNAME FROM DBA_AUDIT_TRAIL  
WHERE ACTION_NAME IN (&#x27;LOGON&#x27;, &#x27;LOGOFF&#x27;) AND USERNAME = &#x27;&lt;username&gt;&#x27; GROUP BY ACTION_NAME, USERNAME ORDER BY LAST_LOGIN DESC;</code></pre></details></li></ul><ul id="7fda69f3-3fdc-4f8c-9143-f1da0d636c36" class="toggle"><li><details open=""><summary>Script usado para consultar a data de criação de um usuario e a ultima alteração de senha</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="557d5187-704b-4011-baa4-381008013bd1" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT
   name,
   TO_CHAR(ctime, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;) &quot;User was created on&quot;,
   TO_CHAR(PTIME, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;) &quot;Password was last changed on&quot;
FROM 
   sys.user$
WHERE
    NAME=&#x27;USERNAME&#x27;;</code></pre></details></li></ul><ul id="4faa8cb2-edcd-4260-bf36-f0339033d22a" class="toggle"><li><details open=""><summary>Script para pegar o SPID de um SID.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7520553a-6f2c-4d77-bb6e-a26b65283b90" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">set lines 123 
col USERNAME for a15 
col OSUSER for a8 
col MACHINE for a15 
col PROGRAM for a20 
select b.spid, a.username, a.program , a.osuser ,a.machine, a.sid, a.serial#, 
a.status from gv$session a, gv$process b 
where addr=paddr(+) and sid=&amp;sid;</code></pre></details></li></ul><ul id="a4c40025-89c7-40d9-bd73-f90b1c390da9" class="toggle"><li><details open=""><summary>Script para pegar o SID de um SPID.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="74be82e0-7162-4305-bcb4-f3cf311526be" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">col sid format 999999 
col username format a20 
col osuser format a15 
select b.spid,a.sid, a.serial#,a.username, a.osuser 
from v$session a, v$process b 
where a.paddr= b.addr 
and b.spid=&#x27;&amp;spid&#x27; 
order by b.spid;</code></pre></details></li></ul><p id="4b91242c-6899-425b-901c-688790833612" class="">
</p><p id="70e1780c-a13e-4065-9fbb-3a34b6ecd2fc" class="">
</p><p id="9abf32b8-eeb9-433a-92fd-5b1edc5905d9" class=""><mark class="highlight-red">/**************************************************************************************<br/>---------------------------------------- TABELAS/INDEX/LOBS--------------------<br/>**************************************************************************************/</mark></p><p id="1c4887f1-c78f-40c5-b441-e3a39894db30" class="">
</p><ul id="524092d9-5011-4319-870e-daa474264c63" class="toggle"><li><details open=""><summary>Script para exibir a descrição de todas as tabelas do usuário e as que foram concedidas a ele, mesmo ele não sendo o owner.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dad78774-d9b8-4d30-aece-ecf9fc74628d" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT OWNER, 
       TABLE_NAME,
       TABLESPACE_NAME,
       STATUS
       FROM all_tables
WHERE OWNER NOT IN (&#x27;SYS&#x27;, &#x27;OUTLN&#x27;, &#x27;SYSTEM&#x27;);</code></pre></details></li></ul><ul id="49625f7b-aef3-4ae1-acbd-cc7ea75d7f15" class="toggle"><li><details open=""><summary>Script para exibir a descrição de todas as tabelas do usuário.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="eb204e4d-fc29-4506-99f6-7a467cdf47fe" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">Select * from user_tables;</code></pre></details></li></ul><ul id="2273ef55-290c-4216-ba44-6838601edc38" class="toggle"><li><details open=""><summary>Script para consultar o tamanho de uma determinada tabela/schema</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="475c4406-42d7-4658-a1f7-92a457245142" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT
   owner, 
   table_name, 
   TRUNC(sum(bytes)/1024/1024/1024) GB,
   ROUND( ratio_to_report( sum(bytes) ) over () * 100) Percent
FROM
(SELECT segment_name table_name, owner, bytes
 FROM dba_segments
 WHERE segment_type IN (&#x27;TABLE&#x27;, &#x27;TABLE PARTITION&#x27;, &#x27;TABLE SUBPARTITION&#x27;)
 UNION ALL
 SELECT i.table_name, i.owner, s.bytes
 FROM dba_indexes i, dba_segments s
 WHERE s.segment_name = i.index_name
 AND   s.owner = i.owner
 AND   s.segment_type IN (&#x27;INDEX&#x27;, &#x27;INDEX PARTITION&#x27;, &#x27;INDEX SUBPARTITION&#x27;)
 UNION ALL
 SELECT l.table_name, l.owner, s.bytes
 FROM dba_lobs l, dba_segments s
 WHERE s.segment_name = l.segment_name
 AND   s.owner = l.owner
 AND   s.segment_type IN (&#x27;LOBSEGMENT&#x27;, &#x27;LOB PARTITION&#x27;)
 UNION ALL
 SELECT l.table_name, l.owner, s.bytes
 FROM dba_lobs l, dba_segments s
 WHERE s.segment_name = l.index_name
 AND   s.owner = l.owner
 AND   s.segment_type = &#x27;LOBINDEX&#x27;)
WHERE table_name in UPPER(&#x27;DFE_NFE_EVENTO&#x27;)
GROUP BY table_name, owner
HAVING SUM(bytes)/1024/1024 &gt; 10  /* Ignore really small tables */
ORDER BY SUM(bytes) desc
;</code></pre></details></li></ul><ul id="1da61a00-c2d7-40fe-a13a-eb7460b00914" class="toggle"><li><details open=""><summary>Script para listar o tamanho de cada seguimento</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4122c8b4-bc05-4266-9b58-dfe034d90819" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select segment_type, 
       segment_name, 
       sum(bytes/1024/1024/1024) GB
 from dba_segments
--where segment_name=&#x27;&amp;Your_Table_Name&#x27; 
group by segment_type, segment_name
order by segment_type desc;</code></pre></details></li></ul><ul id="2ba86e4b-0d91-48eb-95d3-df5299786c44" class="toggle"><li><details open=""><summary>Script para consultar o informações das colunas de lob</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3720bb64-8d1d-46f1-a9f8-539309695254" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM DBA_LOBS
WHERE 
    OWNER = &#x27;&lt;owner_schema&gt;&#x27;
    AND
    TABLE_NAME = &#x27;&lt;table_name&gt;&#x27;;
</code></pre></details></li></ul><ul id="7a77b976-c1a3-4053-a0cf-b5675db8765b" class="toggle"><li><details open=""><summary>Script para obter informações detalhadas sobre as colunas das suas tabelas. No qual, você é dono.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="eb7d17d1-122d-499d-9c74-17660fe9cc11" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM user_tab_columns;</code></pre></details></li></ul><ul id="90a30ed9-ef6c-4e4c-a785-b61f042b6165" class="toggle"><li><details open=""><summary>script para descrever os objetos de tabela para o usuario corrente/atual</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5efb4770-4c18-478f-8fec-d7c38597172e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT OWNER, --DONO DA TABELA
       TABLE_NAME, --NOME DA TABELA
       TABLESPACE_NAME, --NOME DA TABLEPACE QUE CONTEM A TABELA, NULL PARA TABELAS PARTICIONADAS E TEMP...
       STATUS, -- SE UM DROP TABLE ANTERIOR FALHOU INDICA SE A TBL ESTA UNUSABLE OU VALID
       COMPRESSION, --INDICA SE O HCC ESTÁ HABILITADA OU NÃO
       COMPRESS_FOR -- COMPRESSÃO PADRÃO PRA QUE TIPO DE OPERAÇÃO
       FROM ALL_ALL_TABLES;</code></pre></details></li></ul><ul id="ea82a2c0-344f-42ef-bd2f-d651543a9d43" class="toggle"><li><details open=""><summary>Script para descrever todos os objetos de tabelas no banco de dados</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dc384adf-5419-461a-8097-b9b577952fd6" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT OWNER, --DONO DA TABELA
       TABLE_NAME, --NOME DA TABELA
       TABLESPACE_NAME, --NOME DA TABLEPACE QUE CONTEM A TABELA, NULL PARA TABELAS PARTICIONADAS E TEMP...
       STATUS, -- SE UM DROP TABLE ANTERIOR FALHOU INDICA SE A TBL ESTA UNUSABLE OU VALID
       COMPRESSION, --INDICA SE O HCC ESTÁ HABILITADA OU NÃO
       COMPRESS_FOR -- COMPRESSÃO PADRÃO PRA QUE TIPO DE OPERAÇÃO
       FROM DBA_ALL_TABLES;</code></pre></details></li></ul><ul id="63b268f8-fff2-44a5-9e75-38c046221080" class="toggle"><li><details open=""><summary>Script para descrever todos os objetos de tabelas onde o user atual é o owner</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="68d234ed-b011-48e6-94fa-ca9f54e68a80" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT 
       TABLE_NAME, --NOME DA TABELA
       TABLESPACE_NAME, --NOME DA TABLEPACE QUE CONTEM A TABELA, NULL PARA TABELAS PARTICIONADAS E TEMP...
       STATUS, -- SE UM DROP TABLE ANTERIOR FALHOU INDICA SE A TBL ESTA UNUSABLE OU VALID
       COMPRESSION, --INDICA SE O HCC ESTÁ HABILITADA OU NÃO
       COMPRESS_FOR -- COMPRESSÃO PADRÃO PRA QUE TIPO DE OPERAÇÃO
       FROM USER_ALL_TABLES;</code></pre></details></li></ul><ul id="247864eb-009a-808c-b7f4-d77af9d057d5" class="toggle"><li><details open=""><summary>Scripts para consultar as ultimas movimentações em uma tabela.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="247864eb-009a-805a-a274-f495e7871956" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">    SELECT
        o.owner,
        o.object_name,
        o.object_type,
        to_char(s.last_active_time, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;),
        s.sql_text
    FROM
        v$sqlarea s
    JOIN
        dba_objects o ON s.parsing_schema_name = o.owner AND s.sql_text LIKE &#x27;%&#x27; || o.object_name || &#x27;%&#x27;
    WHERE
        o.object_type = &#x27;TABLE&#x27;
        AND o.object_name = &#x27;Z&#x27;
        AND UPPER(s.sql_text) not like &#x27;%X%&#x27;
        AND UPPER(s.sql_text) LIKE &#x27;%Y%&#x27;        
        AND s.last_active_time between SYSDATE - 31 AND SYSDATE;
        
      //=============================================================================
      
	--  4. Verificar SCN (último número de mudança) via DBA_TAB_MODIFICATIONS

BEGIN
  DBMS_STATS.FLUSH_DATABASE_MONITORING_INFO;
END;
/

SELECT table_name, inserts, updates, deletes, timestamp
FROM dba_tab_modifications
WHERE table_name = &#x27;NOME_DA_TABELA&#x27;;

-- A coluna TIMESTAMP pode indicar a última modificação.

-- Mas pode estar desatualizada se o FLUSH_DATABASE_MONITORING_INFO não for chamado recentemente.

-- Funciona apenas se monitoramento de estatísticas estiver habilitado.

</code></pre></details></li></ul><p id="d91f3297-f096-4db2-9d45-a1e547900c7c" class="">
</p><p id="fdc2627c-114a-4db6-ad0e-2ac20c53f1c7" class="">
</p><p id="3f9b91ed-1c2c-47c9-90d8-dd210dd217da" class=""><mark class="highlight-red">/**************************************************************************************<br/>----------------------------------------SESSÃO DE USUARIO/PROCESSOS--------------------<br/>**************************************************************************************/</mark></p><p id="0c318478-578d-412d-8c08-e19f24d92898" class="">
</p><ul id="76070f4a-8306-4fef-a022-4c967a35a2a4" class="toggle"><li><details open=""><summary>Encerrar imediatamente uma sessão em ambos os nós do banco (não necessariamente pegando o SQL_ID).</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="427b3881-eb40-47a7-8e34-cf27b28d02fd" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">BEGIN

   FOR x IN (SELECT *
              FROM v$session
              WHERE SQL_ID = &#x27;&lt;SQL_ID&gt;&#x27;)
   LOOP
   
    EXECUTE IMMEDIATE &#x27;alter system kill session &#x27;&#x27;&#x27; || x.sid || &#x27;,&#x27; || x.serial# || &#x27;,@1&#x27; || &#x27;&#x27;&#x27; immediate&#x27;;
    --EXECUTE IMMEDIATE &#x27;alter system kill session &#x27;&#x27;&#x27; || x.sid || &#x27;,&#x27; || x.serial# || &#x27;,@2&#x27; || &#x27;&#x27;&#x27; immediate&#x27;;
   END LOOP;
 
 END;

/

BEGIN

   FOR x IN (
                select *
                from Gv$session
                where username is not null
									 and 
                   and status = &#x27;KILLED&#x27;
                   and username not in (&#x27;SYS&#x27;, &#x27;SYSMAN&#x27;, &#x27;DBSNMP&#x27;)
            )
   LOOP
   
    EXECUTE IMMEDIATE &#x27;ALTER SYSTEM DISCONNECT SESSION &#x27;&#x27;&#x27;||x.sid||&#x27;,&#x27;||x.serial#|| &#x27;,@&#x27; || x.INST_ID || &#x27;&#x27;&#x27; IMMEDIATE&#x27;;
    
   END LOOP;
 
 END;
 
 
 /</code></pre></details></li></ul><ul id="c38601f4-37d4-42ef-b598-9ac9297cc326" class="toggle"><li><details open=""><summary>query para monitorar a quantidade de processos executando por sessão ativa</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="48ea6c0a-c850-4346-a228-97ec6bd68111" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select username,program,MACHINE,prev_sql_id,count(1) as process
from gv$session
group by username,program,MACHINE,prev_sql_id
having count(1) &gt; 5
order by 5 desc;</code></pre></details></li></ul><ul id="05e3916d-7ba4-4d01-a0c8-692bb633dd78" class="toggle"><li><details open=""><summary>TODO HISTORICO DE SESSOES ABERTAS E O QUE ELAS FIZERAM</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e0e9e16e-0a6f-4f73-97ac-5646f4da8b55" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT SAMPLE_TIME,SESSION_ID,SESSION_SERIAL#,SQL_ID,SQL_OPNAME,PROGRAM,MACHINE FROM DBA_HIST_ACTIVE_SESS_HISTORY 
WHERE SAMPLE_TIME LIKE &#x27;01/12/2022 17:%&#x27;
ORDER BY SAMPLE_TIME ASC;</code></pre></details></li></ul><ul id="1fccd750-118b-40b4-a725-aa0fdc615188" class="toggle"><li><details open=""><summary>Script1 para listar e matar as sessões inativas</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9ed2a714-2c48-4f48-9633-a0df8d906d66" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select &#x27;ALTER SYSTEM DISCONNECT SESSION &#x27;&#x27;&#x27;||sid||&#x27;,&#x27;||serial#||&#x27;,&#x27; || &#x27;@&#x27;|| INST_ID || &#x27;&#x27;&#x27; IMMEDIATE;&#x27;
from Gv$session
where username is not null
   and status &lt;&gt; &#x27;ACTIVE&#x27;
   and username not in (&#x27;SYS&#x27;, &#x27;SYSMAN&#x27;, &#x27;DBSNMP&#x27;)
   and last_call_et &gt; 1500</code></pre></details></li></ul><ul id="f4988afb-b191-4626-a507-288266f7dfd8" class="toggle"><li><details open=""><summary>Script2 para listar e matar as sessões inativas</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a2cc4686-ed35-4b0c-8f13-fe8ef8401f5e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT &#x27;ALTER SYSTEM KILL SESSION &#x27;&#x27;&#x27;||sid||&#x27;,&#x27;||serial#||&#x27;,&#x27;||&#x27;@&#x27;||INST_ID||&#x27;&#x27;&#x27; IMMEDIATE;&#x27; as &quot;MataUsuariosConectados&quot;
FROM GV$SESSION
WHERE USERNAME=&#x27;&lt;user&gt;&#x27; AND STATUS=&#x27;INACTIVE&#x27;;</code></pre></details></li></ul><ul id="ef319490-7b3a-4acd-9f63-f168d01db32f" class="toggle"><li><details open=""><summary>Passo a Passo para matar um processo via SO</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3a9e8608-ef42-40d8-a489-15d84b39e20c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Rodar o script para pegar o valor do PROCESS
--Process -&gt; é uma coluna que se refere ao ID do processo a nivel de SO
select inst_id, sid, serial#, username, process
from Gv$session
where username is not null
   and username IN (&#x27;&lt;schema&gt;&#x27;);

--Com o processo em mãos, acessar o servidor do banco, conectar com o user oracle
-- indicar o ORAENV e pesquisar o Process com o ps aux para confirmar
ps aux | grep &lt;Process_number&gt;

-- Rodar o comando kill 
kill -9 &lt;process_number&gt;</code></pre></details></li></ul><ul id="bfb2e5f2-f09c-4438-bf42-7bfcc41625b4" class="toggle"><li><details open=""><summary>Script usado em uma job para disconnect automático de sessões inativas com mais de 6h</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c4b9fddc-b773-43a6-954d-b4408f0803dd" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">	BEGIN
	
	   FOR x IN (
	                select *
	                from gv$session
	                where username is not null
	                   and status = &#x27;INACTIVE&#x27;
	                   and username not in (&#x27;SYS&#x27;, &#x27;SYSMAN&#x27;, &#x27;DBSNMP&#x27;)
	                   and last_call_et &gt; 21600
	            )
	   LOOP
	
	    EXECUTE IMMEDIATE &#x27;ALTER SYSTEM DISCONNECT SESSION &#x27;&#x27;&#x27;||x.sid||&#x27;,&#x27;||x.serial#||&#x27;,&#x27; || &#x27;@&#x27;|| x.INST_ID || &#x27;&#x27;&#x27; IMMEDIATE&#x27;;
	
	   END LOOP;
	
	 END;</code></pre></details></li></ul><ul id="10d064bc-10fd-4101-bf13-8311aba47442" class="toggle"><li><details open=""><summary>Count da quantidade de processos ativos</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5cfb2344-b49d-44a6-90eb-1381f6828be4" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">
COL USERNAME FORMAT A15
COL USERNAME FORMAT A15
COL STATUS FORMAT A15
select username, status, count(1)
from gv$session
where status = &#x27;INACTIVE&#x27;
group by username, status
order by 3 desc;</code></pre></details></li></ul><ul id="cfec1b73-72f7-4001-b90f-a68ce6e0da57" class="toggle"><li><details open=""><summary>Script para consultar o historico das sessões ativas na memoria.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5c3b8cc1-b6f9-47bc-8257-b1b78cd64110" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">
SELECT TO_CHAR(SAMPLE_TIME, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;), -- DATA
       SESSION_ID, -- ID DA SESSÃO
       SESSION_SERIAL#, -- SERIAL DA SESSÃO
       SQL_ID,
       SQL_OPNAME, -- NOME DO COMANDO USADO
       SQL_PLAN_OPERATION -- NOME DA OPERAÇÃO DO PLANO DE EXECUÇÃO
FROM DBA_HIST_ACTIVE_SESS_HISTORY
WHERE TO_CHAR(SAMPLE_TIME, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;) BETWEEN &#x27;&lt;DATA_INICIAL&gt;&#x27; AND &#x27;&lt;DATA_FINAL&gt;&#x27;;
</code></pre></details></li></ul><ul id="f802b6a6-2e2b-4724-bc16-9dda58cdeb2c" class="toggle"><li><details open=""><summary>Script para consultar as sessões bloqueadas / bloqueadoras</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ede9900b-042f-4392-ac49-599aaf956dbb" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select &#x27;SID &#x27; || l1.sid ||&#x27; está bloqueando &#x27; || l2.sid blocking
from v$lock l1, v$lock l2
where l1.block =1 and l2.request &gt; 0
and l1.id1=l2.id1
and l1.id2=l2.id2;</code></pre></details></li></ul><ul id="e33bdef4-f978-4c62-90c7-1a9c3e039cc6" class="toggle"><li><details open=""><summary>Script 2 para consultar as sessões bloqueadas / bloqueadoras</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="76079f11-4cbe-4c2f-b48a-084df74dab40" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">-- na coluna blocking_session mostra qual sessão está bloqueado aquela linha
select sid, 
       serial#, 
       status, 
       username, 
       osuser, 
       program, 
       blocking_session blocking, 
       event 
from gv$session 
where blocking_session is not null;

--</code></pre></details></li></ul><ul id="f79ebb5c-a0c0-4043-8930-05aabad33032" class="toggle"><li><details open=""><summary>Script para consultar qual sessão iniciou todo o processo de bloqueio</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e59c20f2-f5a1-436e-a7a1-3a34691c60f6" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select waiting_session,holding_session from dba_waiters;</code></pre></details></li></ul><ul id="fb701db1-b90d-4757-a476-edaaa023ea1a" class="toggle"><li><details open=""><summary>Script para obter a lista dos processos em execução</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="68a1b996-3947-4a6c-9af7-8ce81f3ec99a" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select sid, serial#, 
       process, 
       name, 
       description
 from v$session join v$bgprocess using(paddr) ;</code></pre></details></li></ul><ul id="552f3208-acef-4aef-ae82-c7ccbe8e6b0c" class="toggle"><li><details open=""><summary>Lista das sessões ativas no banco</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dde54d09-33be-4b8c-836c-3b66a427d8dd" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">set echo off 
set linesize 95 
set head on 
set feedback on 
col sid head &quot;Sid&quot; form 9999 trunc 
col serial# form 99999 trunc head &quot;Ser#&quot; 
col username form a8 trunc 
col osuser form a7 trunc 
col machine form a20 trunc head &quot;Client|Machine&quot; 
col program form a15 trunc head &quot;Client|Program&quot; 
col login form a11 
col &quot;last call&quot; form 9999999 trunc head &quot;Last Call|In Secs&quot; 
col status form a6 trunc
select sid,
      serial#,
      substr(username,1,10) username,
      substr(osuser,1,10) osuser, 
      substr(program||module,1,15) program,
      substr(machine,1,22) machine, 
      to_char(logon_time,&#x27;ddMon hh24:mi&#x27;) login, 
      last_call_et &quot;last call&quot;,status
from gv$session where status=&#x27;ACTIVE&#x27; 
order by 1 </code></pre></details></li></ul><ul id="0367d27c-8777-4f6a-a59e-8f3201006080" class="toggle"><li><details open=""><summary>Script para encontrar sessões gerando muito redo</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fb4fcede-5c20-466a-9921-a96228fc07d8" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">
set lines 2000 
set pages 1000 
col sid for 99999 
col name for a09 
col username for a14 
col PROGRAM for a21 
col MODULE for a25 
select s.sid,sn.SERIAL#,n.name, round(value/1024/1024/1024,2) redo_gb, 
sn.username,sn.status,substr (sn.program,1,21) &quot;program&quot;, sn.type, 
sn.module,sn.sql_id 
from v$sesstat s join v$statname n on n.statistic# = s.statistic# 
join v$session sn on sn.sid = s.sid 
where n.name like &#x27;redo size&#x27; and s.value!=0
order by redo_gb desc;</code></pre></details></li></ul><ul id="56649131-6ee4-4db0-9089-fa7bc397dafe" class="toggle"><li><details open=""><summary>Script para listar as TOP queries com maior tempo de consumo (elapsed_time)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6420b9dd-79a7-47c6-88dd-efe766dc1b9a" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Elapsed Time é o tempo decorrido e total consumido para realizar as execuções das instruções SQL
Select
INST_ID,
module,
parsing_schema_name,
inst_id,
sql_id,
CHILD_NUMBER,
sql_plan_baseline,
sql_profile,
plan_hash_value,
sql_fulltext,
to_char(last_active_time,&#x27;DD/MM/YY HH24:MI:SS&#x27; ),executions, 
elapsed_time/executions/1000/1000,
rows_processed,sql_plan_baseline 
from gv$sql where last_active_time&gt;sysdate-1/24 
and executions &lt;&gt; 0 order by elapsed_time/executions desc;
</code></pre></details></li></ul><p id="b135f3e3-dabe-454c-83ba-cd9d78265af7" class="">
</p><p id="a4e89019-a829-4732-ab47-b8689c908289" class="">
</p><p id="d51e5154-4a13-43b3-8fe3-7f6b4df2c1b9" class="">
</p><p id="c7139e90-8589-430a-af4e-9adff7e6ed93" class=""><mark class="highlight-red">/**************************************************************************************<br/>----------------------------------------MONITORAMENTO UNDO--------------------<br/>**************************************************************************************/</mark></p><p id="e3c86c3c-301f-4b69-b78e-81281f2f6dc0" class="">
</p><p id="14f675d2-cd89-4d9e-b43b-92f16c067a4d" class="">
</p><ul id="6d467dfd-df4f-4750-8350-680d976a4f43" class="toggle"><li><details open=""><summary>Consulta de UNDOTBS</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d5340bd2-711c-4883-b9af-42d10975f5f2" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select s.username,
       ROUND(sum(ss.value) / 1024 / 1024 /1024,2) AS GB
from  v$sesstat ss
  join v$session s on s.sid = ss.sid
  join v$statname stat on stat.statistic# = ss.statistic#
where s.username IS NOT NULL
group by s.username
order by GB desc;</code></pre></details></li></ul><ul id="756cec46-331b-45ff-adf9-9439d348cb8f" class="toggle"><li><details open=""><summary>Consultando SQL_IDS e querys que usaram a UNDO.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4b935d4a-4553-4649-9038-a59c79d3291c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT A.BEGIN_TIME, 
        A.END_TIME, 
        A.INSTANCE_NUMBER, 
        A.TXNCOUNT, 
        A.MAXQUERYSQLID,
        B.SQL_TEXT
FROM DBA_HIST_UNDOSTAT A INNER JOIN V$SQL B ON A.MAXQUERYSQLID = B.SQL_ID
ORDER BY 1 desc;</code></pre></details></li></ul><ul id="24acec89-8f91-466a-88e6-a4ef7a0fd9f2" class="toggle"><li><details open=""><summary>Para consultar o parametro undo_retention</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9c0dac30-ed43-4c75-88ea-47129d15c3d2" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SHOW PARAMETER UNDO_RETENTION;</code></pre></details></li></ul><ul id="9e508161-284b-494a-a835-c78dfabe1f56" class="toggle"><li><details open=""><summary>Para alterar o valor do undo_retention</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d54056a2-b2a6-49b7-a449-7374f2130fbd" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ALTER SYSTEM SET UNDO_RETENTION=&lt;NEW_VALOR&gt; SCOPE=BOTH SID=&#x27;*&#x27;;</code></pre></details></li></ul><ul id="1e1842ac-90e2-4fe8-8925-70ad2ce8aa7b" class="toggle"><li><details open=""><summary>Para consultar o melhor valor da undo_retention</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bd7d9939-edec-456d-8616-45f232bd08e8" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select to_char(begin_time, &#x27;DD-MON-RR HH24:MI&#x27;) 
begin_time,
to_char(end_time, &#x27;DD-MON-RR HH24:MI&#x27;) end_time, 
tuned_undoretention
from v$undostat order by end_time;</code></pre></details></li></ul><ul id="2f996c9d-c7c3-4937-8e01-c0e148bf9f39" class="toggle"><li><details open=""><summary>Para checar se o retention guarantee está habilitado</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="52a98da1-8ea4-4fa6-af2c-72752d33d8f0" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select RETENTION from dba_tablespaces where 
tablespace_name=&#x27;UNDOTBS1&#x27;;</code></pre></details></li></ul><ul id="3528a799-f08e-47e9-b8fa-436b57b24e78" class="toggle"><li><details open=""><summary>Para habilitar o retention guarantee</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="191bc43a-9491-4a9d-a5f9-cce010da6351" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">alter tablespace UNDOTBS1 retention 
GUARANTEE</code></pre></details></li></ul><ul id="511ce263-c79c-41a1-afa4-08ce84309c5b" class="toggle"><li><details open=""><summary>Para consultar os status EXPIRED, UNEXPIRED, ACTIVE da UNDO</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9f0c51d7-fc32-40fe-9842-0508d2dfe7a2" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select tablespace_name, status, sum(blocks) * 8192/1024/1024/1024 GB from dba_undo_extents group by tablespace_name, status
order by 1
;</code></pre></details></li></ul><ul id="80121ca8-d98a-405b-84d9-c0b25cd00f26" class="toggle"><li><details open=""><summary>The following command will give you the total space used, and the free space still available in the undo tablespace.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b24dcde4-8c0f-4e5e-b113-1f3fff40e812" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select
  a.tablespace_name,
  sum(a.bytes)/(1024*1024) total_space_MB,
  round(b.free,2) Free_space_MB,
  round(b.free/(sum(a.bytes)/(1024*1024))* 100,2) percent_free
 from dba_data_files a,
  (select tablespace_name,sum(bytes)/(1024*1024) free  from dba_free_space
  group by tablespace_name) b
 where a.tablespace_name = b.tablespace_name(+)
  group by a.tablespace_name,b.free;</code></pre></details></li></ul><p id="f66afef8-4b2f-4547-ba3c-9189d150827e" class="">
</p><p id="d5914038-ac80-486a-be31-74e0750cbb26" class=""><mark class="highlight-red">/**************************************************************************************<br/>----------------------------------------MONITORAMENTO TEMP--------------------<br/>**************************************************************************************/</mark></p><ul id="d7736f1e-86ce-46a7-b7ab-5e7ef350df83" class="toggle"><li><details open=""><summary>Passo a Passo parar criar um monitoramento de uso da TEMP</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="609757b6-9382-4d88-b230-fe97e7297340" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all"># Criar um schema onde será armazenado as informações do monitoramento


CREATE USER &quot;MON_TEMP&quot; PROFILE &quot;DEFAULT&quot; IDENTIFIED BY &quot;*******&quot; DEFAULT TABLESPACE &quot;USERS&quot; TEMPORARY TABLESPACE &quot;TEMP&quot; QUOTA 5242880 K ON &quot;USERS&quot; ACCOUNT UNLOCK;
GRANT UNLIMITED TABLESPACE TO &quot;MON_TEMP&quot;;
GRANT &quot;CONNECT&quot; TO &quot;MON_TEMP&quot;;
GRANT &quot;DBA&quot; TO &quot;MON_TEMP&quot;;

# Criando a tabela de monitoramento da temp

CREATE TABLE &quot;MON_TEMP&quot;.&quot;MONITORAMENTOTEMP&quot; 
   (	&quot;PERIODO&quot; DATE, 
	&quot;TABLESPACE&quot; VARCHAR2(30 BYTE), 
	&quot;TEMP_SIZEGB&quot; NUMBER, 
	&quot;SID_SERIAL&quot; VARCHAR2(81 BYTE), 
	&quot;USERNAME&quot; VARCHAR2(128 BYTE), 
	&quot;PROGRAM&quot; VARCHAR2(48 BYTE), 
	&quot;STATUS&quot; VARCHAR2(8 BYTE), 
	&quot;SQL_ID&quot; VARCHAR2(13 BYTE), 
	&quot;QUERY&quot; VARCHAR2(1000 BYTE), 
	&quot;TOTAL_TEMP_SIZE_USAGE_GB&quot; NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE &quot;USERS&quot; ;


# Dentro do schema de monitoramento, criar uma job que executará uma procedure para inserir
# os dados na tabela
# Nome da JOB: PRC_MONITORAMENTO_TEMP
# Descrição: Monitoramento das querys que mais consomem a TEMP
# Classe da JOB: SYS.DEFAULT_JOB_CLASS
# Bloco PL/SQL
# Quando executar a JOB: 
	# Intervalo de repetição: FREQ=MINUTELY
	# Data inicial: data que a job foi startada
  # Data Final: null
--Apaga os registros com mais de 7 dias
delete from SUBAP.MonitoramentoTemp where periodo &lt;= (sysdate-7);

--Insere dados de consumo da tablespace TEMP quando a query estiver consumindo mais de 10GB 
INSERT INTO MON_TEMP.monitoramentotemp (periodo, tablespace, temp_sizegb, total_temp_size_usage_gb, sid_serial, username, program, status, sql_id, query)
SELECT 
sysdate as periodo,
b.tablespace as tablespace,
ROUND(((b.blocks*p.value)/1024/1024/1024),2) AS temp_sizeGB,
(SELECT round((tablespace_size - free_space)/1024/1024/1024,2) FROM   dba_temp_free_space) as total_temp_size_usage_GB, 
a.sid||&#x27;,&#x27;||a.serial# AS sid_serial,
NVL(a.username, &#x27;(oracle)&#x27;) AS username,
a.program as program,
a.status as status,
a.sql_id as SQL_ID,
c.sql_text as query
FROM gv$session a,
gv$sort_usage b,
gv$parameter p,
gv$sqlarea c
WHERE p.name = &#x27;db_block_size&#x27;
AND a.saddr = b.session_addr
AND a.inst_id=b.inst_id
AND a.inst_id=p.inst_id
AND c.address= a.sql_address
AND c.hash_value = a.sql_hash_value
AND ((b.blocks*p.value)/1024/1024/1024) &gt; 10;
stop_JOB


</code></pre></details></li></ul><p id="22b3a3e5-5c87-41c3-a1a4-23f7e69cafe8" class="">
</p><p id="deff72d5-98be-4406-926f-eac6da35d2c2" class=""><mark class="highlight-red">/**************************************************************************************<br/>----------------------------------------SPFILE / PFILE--------------------<br/>**************************************************************************************/</mark></p><p id="fa6e0a36-5a9b-46e3-9ad0-bf52cf4954b9" class="">
</p><p id="27a2b38a-1111-415b-8746-5ef3283e50e9" class="">
</p><ul id="05ba87f1-252f-4abe-b607-73a798ed9c88" class="toggle"><li><details open=""><summary>comando para consultar a localização do spfile</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5a738ac4-6d50-4ba7-b596-36f18bebe0d5" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">show parameter spfile


obs → esse comando pode ser executado tanto no sqlplus quanto no Oracle Developer</code></pre></details></li></ul><ul id="ca3ae175-e8c2-4bd7-93a5-429682a1188f" class="toggle"><li><details open=""><summary>Comando usado para criar um pfile de um spfile</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0dfe4f18-1a57-4680-b36a-7b817d8aedfe" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">create pfile=&#x27;&lt;dir/init.ora&gt;&#x27; from spfile=&#x27;dir/spfileorcl.ora&#x27;;


obs → caso quiséssemos ver os valores dos parametros listados no SPFILE sem precisar criar o PFILE para isso, podemos usar os comandos abaixo para mostrar mais detalhes dos valores de cada parametro.</code></pre></details></li></ul><ul id="5185f9be-2c7b-410b-9b66-1a341067a4cd" class="toggle"><li><details open=""><summary>comando usado para consultar os valores setados para SGA</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0536ce93-08aa-437d-9599-5e64eda7ab57" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">show parameter sga;</code></pre></details></li></ul><ul id="56423a8e-c47d-4adf-a029-919be241444c" class="toggle"><li><details open=""><summary>comando usado para consultar os valores setados para PGA</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3b59124c-2f39-4977-8479-6028cd973b76" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">show parameter pga;</code></pre></details></li></ul><ul id="1ff018bc-3561-445b-a2ed-119f8ac73be2" class="toggle"><li><details open=""><summary>comando usado para consultar detalhes da undotbs</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4042c1fd-f626-47bd-8f84-1738c298044f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">show parameter undo;</code></pre></details></li></ul><ul id="9138b312-42b3-4775-b5ad-e35bd2f70b8f" class="toggle"><li><details open=""><summary>Comando usado para consultar o total de SGA usado</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="619a1a7c-7724-455a-9374-711c7504babe" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Check the Usage of SGA
select round(used.bytes /1024/1024/1024 ,2) used_GB
, round(free.bytes /1024/1024/1024 ,2) free_GB
, round(tot.bytes /1024/1024/1024 ,2) total_GB
from (select sum(bytes) bytes
from v$sgastat
where name != &#x27;free memory&#x27;) used
, (select sum(bytes) bytes
from v$sgastat
where name = &#x27;free memory&#x27;) free
, (select sum(bytes) bytes
from v$sgastat) tot ;</code></pre></details></li></ul><ul id="ef17d4d3-fb4a-4264-a6fa-c35aed2aab79" class="toggle"><li><details open=""><summary>Comando usado para consultar o sga_max_size</summary><p id="d3c3246c-3089-4793-814f-8c3d5999067d" class="">
</p></details></li></ul><ul id="377f3dbe-fa9f-497f-a19d-91663b0057e2" class="toggle"><li><details open=""><summary>Comando usado para listar os parametros do Oracle</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6884daec-00db-4ddf-a327-bbfa1954c284" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#AS COLUNAS MODIFIABLE INDICAM SE AQUELE PARAMETRO É ALTERADO ONLINE OU SE PRECISA REINICIAR
SELECT * FROM V$PARAMETER;</code></pre></details></li></ul><p id="aeb9f24a-2c9d-4679-8def-fd8b18a66c48" class="">
</p><p id="130b0c46-f3f1-4f7c-ab0c-189bab55d8da" class="">
</p><p id="d4fe4b14-0207-4ff5-b069-0d1aba9a03ad" class=""><mark class="highlight-red">/**************************************************************************************<br/>---------------------------------------- REDO LOG FILES / ARCHIVE LOGS--------------------<br/>**************************************************************************************/</mark></p><ul id="77fdd94e-b6e8-43ff-a661-2a2e4d53d92d" class="toggle"><li><details open=""><summary>Script para consultar o grupo, sequencia e status de um log file.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9cf718c3-9851-4765-8e02-f8e75f3b3b5d" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT GROUP#, SEQUENCE#, (BYTES/1024/1024/1024) GB, STATUS FROM  V$LOG;

#OBS: O STATUS &quot;CURRENT&quot; INDICA O LOG FILE QUE ESTÁ SENDO ESCRITO NESSE MOMENTO.
# Os que tem status inativo são os que já podem ser utilizados novamente.
#Podemos ter tbm o status active, em que ele ainda será necessario em um evento de instance recovery.
#Sequence# -&gt; é a sequencia que o Oracle coloca em cada redo a cada log switch, quando esse redo for
a#arquivado , archived, esse número de sequencia tbm irá para o archive.</code></pre></details></li></ul><ul id="c14e07db-672a-468e-a98d-400afba2aa17" class="toggle"><li><details open=""><summary>Script para listar a localização dos log files no disco</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1ba187e2-6279-4e40-a4da-df8d373877ef" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT GROUP#, SEQUENCE#, (BYTES/1024/1024) GB, STATUS FROM  V$LOG;</code></pre></details></li></ul><ul id="27a13950-d53a-497b-8a84-426cbca801d3" class="toggle"><li><details open=""><summary>Script para força o log switch</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b6cbedb4-f381-48ca-899b-0860915a420c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">
#COMANDO USADO PARA SINGLE INSTANCE
ALTER SYSTEM SWITCH LOGFILE;
#COMANDO USADO EM RAC, CASO QUEIRA ALTERAR O LOGFILE CURRENT DE TODAS AS INSTANCIAS.
ALTER SYSTEM SWITCH ALL LOGFILES;</code></pre></details></li></ul><ul id="5e0ff2a7-0662-4c6a-8ca8-8ca1a66d98e9" class="toggle"><li><details open=""><summary>Script para trazer detalhes dos redologs</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="16f5ac01-2bf4-4b99-adf5-5a1f38ebcec1" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">set lines 180
COL group# FORM 99999
COL thread# FORM 99999
COL grp_status FORM a10
COL member FORM a44
COL mem_status FORM a10
COL mbytes FORM 999999
SELECT
a.group#
,a.thread#
,a.status grp_status
,b.member member
,b.status mem_status
,a.bytes/1024/1024 mbytes
FROM v$log a,
v$logfile b
WHERE a.group# = b.group#
ORDER BY a.group#, b.member;</code></pre></details></li></ul><ul id="ed6280fd-3e5a-4c06-b1f7-d46845f5ff43" class="toggle"><li><details open=""><summary>Script para adicionar novos grupos de redolog usando padrão OFA </summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="02bcb341-1497-4bc4-8c5a-a5510cf95a3e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">alter database add logfile group 4
(&#x27;+DATA&#x27;,&#x27;+ARCH&#x27;) SIZE 200M;

#( é importante que cada membro do novo grupo tenha o mesmo tamanho dos grupos existentes)</code></pre></details></li></ul><ul id="216a2c80-ec56-4971-935c-de6431e94ecf" class="toggle"><li><details open=""><summary>Script para consultar a frequência de log Switch</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7865995c-2d32-400e-9175-ab9b366a0486" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">set pages 999 lines 400
col Day form a10
col h0 format 999
col h1 format 999
col h2 format 999
col h3 format 999
col h4 format 999
col h5 format 999
col h6 format 999
col h7 format 999
col h8 format 999
col h9 format 999
col h10 format 999
col h11 format 999
col h12 format 999
col h13 format 999
col h14 format 999
col h15 format 999
col h16 format 999
col h17 format 999
col h18 format 999
col h19 format 999
col h20 format 999
col h21 format 999
col h22 format 999
col h23 format 999
	SELECT TRUNC (first_time) &quot;Date&quot;, inst_id, TO_CHAR (first_time, &#x27;Dy&#x27;) &quot;Day&quot;,
	COUNT (1) &quot;Total&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;00&#x27;, 1, 0)) &quot;h0&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;01&#x27;, 1, 0)) &quot;h1&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;02&#x27;, 1, 0)) &quot;h2&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;03&#x27;, 1, 0)) &quot;h3&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;04&#x27;, 1, 0)) &quot;h4&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;05&#x27;, 1, 0)) &quot;h5&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;06&#x27;, 1, 0)) &quot;h6&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;07&#x27;, 1, 0)) &quot;h7&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;08&#x27;, 1, 0)) &quot;h8&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;09&#x27;, 1, 0)) &quot;h9&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;10&#x27;, 1, 0)) &quot;h10&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;11&#x27;, 1, 0)) &quot;h11&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;12&#x27;, 1, 0)) &quot;h12&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;13&#x27;, 1, 0)) &quot;h13&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;14&#x27;, 1, 0)) &quot;h14&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;15&#x27;, 1, 0)) &quot;h15&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;16&#x27;, 1, 0)) &quot;h16&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;17&#x27;, 1, 0)) &quot;h17&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;18&#x27;, 1, 0)) &quot;h18&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;19&#x27;, 1, 0)) &quot;h19&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;20&#x27;, 1, 0)) &quot;h20&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;21&#x27;, 1, 0)) &quot;h21&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;22&#x27;, 1, 0)) &quot;h22&quot;,
	SUM (DECODE (TO_CHAR (first_time, &#x27;hh24&#x27;), &#x27;23&#x27;, 1, 0)) &quot;h23&quot;,
	ROUND (COUNT (1) / 24, 2) &quot;Avg&quot;
	FROM gv$log_history
	WHERE thread# = inst_id
	AND first_time &gt; sysdate -7
	GROUP BY TRUNC (first_time), inst_id, TO_CHAR (first_time, &#x27;Dy&#x27;)
	ORDER BY 1,2;</code></pre></details></li></ul><ul id="bc77b114-a6e2-4803-8c7a-df32ce572244" class="toggle"><li><details open=""><summary>Script para consultar a recovery area usage</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="82cf053d-95a9-4780-9dd4-a414979e71f6" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select * from V$RECOVERY_AREA_USAGE;</code></pre></details></li></ul><ul id="f4ae1b57-327c-4184-bcab-40b41dd6d406" class="toggle"><li><details open=""><summary>Mostrar o valor atual do parâmetro  DB_RECOVERY_FILE_DEST_SIZE</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ee52344b-a7ea-4330-a0f6-a4aa703cb242" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">show parameter db_recovery_file_dest</code></pre><p id="95af14fe-1e27-4978-aa3c-fd77754138ef" class="">
</p></details></li></ul><ul id="27d864eb-009a-80ef-8e42-fd43cf2137b6" class="toggle"><li><details open=""><summary>Manutenção de REDOLOGS</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="27d864eb-009a-80bc-825f-df599be9eb3c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">Assunto
MANUTENÇÃO REDOLOGS
Conteúdo
MANUTENÇÃO REDOLOGS

 

Em resumo, como boa prática, os redologs devem ser enviados a cada 15 minutos. Os envios podem ser vistos por exemplo em &quot;/u01/app/oracle/diag/rdbms/sit/SIT1/trace/alert_SIT1.log&quot;

Todos os scripts devem ser executado com o usuário no banco de dados em que se deseja realizar a manutenção (sqlplus ou mesmo atraves do client).

 

Comandos para identificação dos logfiles

select thread#,group#,status,bytes/1024/1024 from v$log;
select thread#,group#,status,bytes/1024/1024 from v$standby_log;

Servidor DR (S3A11102P1)

ALTER SYSTEM SET STANDBY_FILE_MANAGEMENT=MANUAL;


Servidor PRINCIPAL (EXADATA) - Em qualquer nó


Apagar logfile

alter database drop logfile group 11;
alter database drop logfile group 12;
alter database drop logfile group 13;
alter database drop logfile group 14;
alter database drop logfile group 15;
alter database drop logfile group 16;
alter database drop logfile group 17;
alter database drop logfile group 18;

alter database drop logfile group 21;
alter database drop logfile group 22;
alter database drop logfile group 23;
alter database drop logfile group 24;
alter database drop logfile group 25;
alter database drop logfile group 26;
alter database drop logfile group 27;
alter database drop logfile group 28;

Caso o logfile que se deseja apagar estiver como Active ou Current deverá executar o comando abaixo para que o sistema passe para a atividade para outro logfile.

alter system switch logfile;


Adicionar logfile

alter database add logfile THREAD 1 group 11 size 2048M;
alter database add logfile THREAD 1 group 12 size 2048M;
alter database add logfile THREAD 1 group 13 size 2048M;
alter database add logfile THREAD 1 group 14 size 2048M;
alter database add logfile THREAD 1 group 15 size 2048M;
alter database add logfile THREAD 1 group 16 size 2048M;
alter database add logfile THREAD 1 group 17 size 2048M;
alter database add logfile THREAD 1 group 18 size 2048M;

alter database add logfile THREAD 2 group 21 size 2048M;
alter database add logfile THREAD 2 group 22 size 2048M;
alter database add logfile THREAD 2 group 23 size 2048M;
alter database add logfile THREAD 2 group 24 size 2048M;
alter database add logfile THREAD 2 group 25 size 2048M;
alter database add logfile THREAD 2 group 26 size 2048M;
alter database add logfile THREAD 2 group 27 size 2048M;
alter database add logfile THREAD 2 group 28 size 2048M;


Apagar standby logfile

alter database drop standby logfile group 101;
alter database drop standby logfile group 102;
alter database drop standby logfile group 103;
alter database drop standby logfile group 104;
alter database drop standby logfile group 105;
alter database drop standby logfile group 106;
alter database drop standby logfile group 107;
alter database drop standby logfile group 108;

alter database drop standby logfile group 201;
alter database drop standby logfile group 202;
alter database drop standby logfile group 203;
alter database drop standby logfile group 204;
alter database drop standby logfile group 205;
alter database drop standby logfile group 206;
alter database drop standby logfile group 207;
alter database drop standby logfile group 208;

Adicionar standby logfile

alter database add standby logfile THREAD 1 group 101 size 2048M;
alter database add standby logfile THREAD 1 group 102 size 2048M;
alter database add standby logfile THREAD 1 group 103 size 2048M;
alter database add standby logfile THREAD 1 group 104 size 2048M;
alter database add standby logfile THREAD 1 group 105 size 2048M;
alter database add standby logfile THREAD 1 group 106 size 2048M;
alter database add standby logfile THREAD 1 group 107 size 2048M;
alter database add standby logfile THREAD 1 group 108 size 2048M;

alter database add standby logfile THREAD 2 group 201 size 2048M;
alter database add standby logfile THREAD 2 group 202 size 2048M;
alter database add standby logfile THREAD 2 group 203 size 2048M;
alter database add standby logfile THREAD 2 group 204 size 2048M;
alter database add standby logfile THREAD 2 group 205 size 2048M;
alter database add standby logfile THREAD 2 group 206 size 2048M;
alter database add standby logfile THREAD 2 group 207 size 2048M;
alter database add standby logfile THREAD 2 group 208 size 2048M;


Servidor DR (S3A11102P1)

 

alter database recover managed standby database cancel;

Apagar logfile

alter database clear logfile group 11;
alter database clear logfile group 12;
alter database clear logfile group 13;
alter database clear logfile group 14;
alter database clear logfile group 15;
alter database clear logfile group 16;
alter database clear logfile group 17;
alter database clear logfile group 18;

alter database clear logfile group 21;
alter database clear logfile group 22;
alter database clear logfile group 23;
alter database clear logfile group 24;
alter database clear logfile group 25;
alter database clear logfile group 26;
alter database clear logfile group 27;
alter database clear logfile group 28;

alter database drop logfile group 11;
alter database drop logfile group 12;
alter database drop logfile group 13;
alter database drop logfile group 14;
alter database drop logfile group 15;
alter database drop logfile group 16;
alter database drop logfile group 17;
alter database drop logfile group 18;

alter database drop logfile group 21;
alter database drop logfile group 22;
alter database drop logfile group 23;
alter database drop logfile group 24;
alter database drop logfile group 25;
alter database drop logfile group 26;
alter database drop logfile group 27;
alter database drop logfile group 28;

 

Adicionar logfile

alter database add logfile THREAD 1 group 11 size 2048M;
alter database add logfile THREAD 1 group 12 size 2048M;
alter database add logfile THREAD 1 group 13 size 2048M;
alter database add logfile THREAD 1 group 14 size 2048M;
alter database add logfile THREAD 1 group 15 size 2048M;
alter database add logfile THREAD 1 group 16 size 2048M;
alter database add logfile THREAD 1 group 17 size 2048M;
alter database add logfile THREAD 1 group 18 size 2048M;

alter database add logfile THREAD 2 group 21 size 2048M;
alter database add logfile THREAD 2 group 22 size 2048M;
alter database add logfile THREAD 2 group 23 size 2048M;
alter database add logfile THREAD 2 group 24 size 2048M;
alter database add logfile THREAD 2 group 25 size 2048M;
alter database add logfile THREAD 2 group 26 size 2048M;
alter database add logfile THREAD 2 group 27 size 2048M;
alter database add logfile THREAD 2 group 28 size 2048M;

 

Apagar standby logfile


alter database drop standby logfile group 101;
alter database drop standby logfile group 102;
alter database drop standby logfile group 103;
alter database drop standby logfile group 104;
alter database drop standby logfile group 105;
alter database drop standby logfile group 106;
alter database drop standby logfile group 107;
alter database drop standby logfile group 108;

alter database drop standby logfile group 201;
alter database drop standby logfile group 202;
alter database drop standby logfile group 203;
alter database drop standby logfile group 204;
alter database drop standby logfile group 205;
alter database drop standby logfile group 206;
alter database drop standby logfile group 207;
alter database drop standby logfile group 208;

 

Adicionar standby logfile


alter database add standby logfile THREAD 1 group 101 size 2048M;
alter database add standby logfile THREAD 1 group 102 size 2048M;
alter database add standby logfile THREAD 1 group 103 size 2048M;
alter database add standby logfile THREAD 1 group 104 size 2048M;
alter database add standby logfile THREAD 1 group 105 size 2048M;
alter database add standby logfile THREAD 1 group 106 size 2048M;
alter database add standby logfile THREAD 1 group 107 size 2048M;
alter database add standby logfile THREAD 1 group 108 size 2048M;

alter database add standby logfile THREAD 2 group 201 size 2048M;
alter database add standby logfile THREAD 2 group 202 size 2048M;
alter database add standby logfile THREAD 2 group 203 size 2048M;
alter database add standby logfile THREAD 2 group 204 size 2048M;
alter database add standby logfile THREAD 2 group 205 size 2048M;
alter database add standby logfile THREAD 2 group 206 size 2048M;
alter database add standby logfile THREAD 2 group 207 size 2048M;
alter database add standby logfile THREAD 2 group 208 size 2048M;


ALTER SYSTEM SET STANDBY_FILE_MANAGEMENT=AUTO;

 

alter database recover managed standby database disconnect from session using current logfile;</code></pre></details></li></ul><p id="67de85be-f10a-43fe-9cd9-90d1e11ff9b3" class="">
</p><p id="1cc5134a-51a3-4a83-9419-00067329a2e1" class="">
</p><p id="5d0d8965-d55a-4b19-9722-82eff4fc7e51" class=""><mark class="highlight-red">/**************************************************************************************<br/>---------------------------------------- SEQUENCE--------------------<br/>**************************************************************************************/</mark></p><ul id="36fe6f96-cc98-4c0b-806b-577217287d40" class="toggle"><li><details open=""><summary>Passo a Passo para correção de sequence com valor errado.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e56a95c6-3be7-4305-ab78-ed48d97d22f8" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Antes de fazer qualquer alteração é preciso saber qual schema-tabela-coluna a sequence esta vinculada
-- Caso nao esteja descrito na coluna &quot;DATA DEFAULT&quot; da descrição da tabela
-- Deve perguntar ao desenvolvedor ou administrador de dados que gerencia as estruturas dos objetos

-- Com o nome da sequence em mãos e sabendo qual coluna esta vinculada, deve-se comparar seus valores
-- para saber qual o valor atual da coluna referenciada pela sequence, roda o script abaixo.

SELECT MAX(&lt;coluna&gt;) FROM schema.tabela;

-- Depois verificar o valor atual da sequence
-- Para isso ou pode ser executado o valor abaico ou ir via SQL Developer
-- na aba de sequences, selecionar a desejada, vai abrir uma nova tela com detalhes do objeto
-- procurar pela descrição last_number ou rodar o script abaixo

SELECT SCHEMA.SEQUENCE FROM DUAL;

-- O valor da coluna deve ser inferior ao da sequence 
-- Para saber qual vai ser o novo valor basta rodar 
SELECT MAX(&lt;coluna&gt; + 1) FROM schema.tabela;

-- Com isso, atualizar o objeto da sequence
--Caso na descrição da tabela no campo &quot;DATA DEFAULT&quot; estiver setado ja a sequence 
--rodar o comando abaixo.
ALTER TABLE schema.tabela
MODIFY(coluna GENERATED BY DEFAULT AS IDENTITY (START WITH novo_valor));

-- Caso não eteja na descrição default da tabela
--Rodar o comando de alteração direto no objeto sequence

ALTER SEQUENCE schema.sequence restart START WITH novo_valor;</code></pre></details></li></ul><p id="eec68b89-45ba-446a-b3d3-52a03668722a" class="">
</p><p id="6f1dde00-63df-4706-aea3-6a3a647cb361" class=""><mark class="highlight-red">/**************************************************************************************<br/>---------------------------------------- Como matar Oracle RMAN backup job --------------------<br/>**************************************************************************************/</mark></p><p id="2b6864eb-009a-80ea-a4bd-cf1b9d5b3d66" class="">
</p><ul id="2b6864eb-009a-8006-9ea8-f958c11dc21c" class="toggle"><li><details open=""><summary>Method 1</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b6864eb-009a-8073-b367-cdcb078a257e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--First, get the SID and SERIAL# from below query:
select b.sid, b.serial#, a.spid, b.client_info
from gv$process a, v$session b
where a.addr=b.paddr and client_info like &#x27;rman%&#x27;;

--or

SELECT SID, SERIAL#, CONTEXT, SOFAR, TOTALWORK,
ROUND (SOFAR/TOTALWORK*100, 2) &quot;% COMPLETE&quot;
FROM GV$SESSION_LONGOPS
WHERE OPNAME LIKE &#x27;RMAN%&#x27; AND OPNAME NOT LIKE &#x27;%aggregate%&#x27;
AND TOTALWORK! = 0 AND SOFAR &lt;&gt; TOTALWORK;</code></pre></details></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="124616cc-79c4-4216-a26a-6b7ab4170595" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all"></code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0b2570ba-fe79-491f-8c53-e6c96dda8c49" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Use the following command to kill RMAN backup job:
alter system kill session &#x27;&lt;sid&gt;,&lt;serial&gt;&#x27; immediate;</code></pre><p id="91d7bdb1-7728-414f-8714-7d49d24b0c11" class="">
</p><ul id="023b2e87-feff-4db0-8560-9cf94cc985d1" class="bulleted-list"><li style="list-style-type:disc">Method 2</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5f6570e3-81ef-4ed5-acc0-0e8257ac1c4c" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">--Directly kill RMAN job from OS level with the help of “kill -9”

kill -9 id</code></pre><p id="ce87c8ec-61b7-40bb-919a-f1fbe4ebfe59" class="">
</p><p id="0aac5626-57b4-4e5e-bf8f-c28932980935" class="">
</p><p id="63a25b99-59a6-451c-8324-c628f445ad92" class="">
</p><p id="e49c739d-20b5-4d3a-82ea-58946514b769" class="">
</p><ul id="7cb53252-7669-47e2-b445-5d3d66ec8cd4" class="bulleted-list"><li style="list-style-type:disc">Grep para listar erros de RMAN em logs</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1c5ef4a6-9322-4139-90a2-3963aa6c4009" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">grep &quot;EXIT 1&quot; *.log</code></pre><p id="629045ba-554b-4bcd-b07c-46b3fd739d79" class="">
</p><ul id="7f27fadb-e835-40dc-b2cf-0521c5833d84" class="bulleted-list"><li style="list-style-type:disc">ps para listar todos os process background de uma instancia </li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="03be6cae-e93a-4b5b-b167-9f1d76f1997d" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ps -ef | grep &lt;instance&gt;</code></pre><p id="df8ec34c-d5a0-4ded-b22f-1d9213435595" class="">
</p><p id="e878b77a-9583-4e11-b98a-320d2fab157f" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cc797a35-6917-4d2e-b550-634e8d0f0838" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">&gt;kill_job</code></pre><p id="9a349cdd-9c29-4412-bc50-4172e24d8a8e" class="">
</p><p id="c2fa07b6-147b-4d2e-82f9-3e7c19d71328" class="">
</p><p id="2280ae71-3ebb-460a-808a-b4decd56d6f5" class=""><mark class="highlight-red">/**************************************************************************************<br/>----------------------------------------PROFILE USERS--------------------<br/>**************************************************************************************/</mark></p><p id="3558fba3-3c82-4274-afbb-feb9d27ae216" class="">
</p><ul id="19f880cd-da5e-4c55-b9ae-ae8f4a04ed43" class="bulleted-list"><li style="list-style-type:disc">Para encontrar o perfil atual de um usuario.</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b3cca2fa-afcb-4abf-96f0-9acc395c0da1" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">		SELECT 
		    username, 
		    profile
		FROM 
		    dba_users
		WHERE 
		    username = &#x27;&lt;username&gt;&#x27;;</code></pre><p id="6f7c064f-7143-47a5-b568-9a34b58bd471" class="">
</p><ul id="c2ee5ef6-988a-40d7-8362-358c9aab5ea5" class="bulleted-list"><li style="list-style-type:disc">Para encontrar os parâmetros do DEFAULT ou outro PROFILE.</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="212e3716-f57e-4d4d-87b7-3c2e00328a74" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT 
  * 
FROM 
    dba_profiles
WHERE 
    PROFILE = &#x27;&lt;profile_name&gt;&#x27;
ORDER BY 
    resource_type, 
    resource_name;</code></pre><p id="5be52b96-aeb6-4e0e-8046-52ece0ce9bb7" class="">
</p><ul id="2e1d5a6a-e479-43b0-a5ea-601d4ac06e82" class="bulleted-list"><li style="list-style-type:disc">comando usado para criação de um profile novo</li></ul><div><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7db35c97-ebc6-4a30-b1ef-e1a932ec5705" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">CREATE PROFILE &lt;profilename&gt; LIMIT 
    SESSIONS_PER_USER          UNLIMITED
    CPU_PER_SESSION            UNLIMITED 
    CPU_PER_CALL               3000 
    CONNECT_TIME               15
    .
    .
    .
    .;
		</code></pre></div><p id="1bb361c0-0cd6-4fc9-bd5b-5be36bc4ff53" class="">
</p><ul id="68d937c8-2971-4edd-b2fb-29ad337f1da4" class="bulleted-list"><li style="list-style-type:disc">Alter profile</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="93835ed8-1876-42b8-ac3a-375bf650afa9" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ALTER PROFILE DEFAULT LIMIT &lt;profile_name&gt; UNLIMITED;</code></pre><p id="1577b544-811a-4cd2-8777-e07314398e81" class="">
</p><ul id="70da6b25-a947-4bbc-a808-6951d37b78ae" class="bulleted-list"><li style="list-style-type:disc">Comando usado para alterar o profile default de um user</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8dbecc7a-1a23-4db0-8047-7dc9c94ebb0f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ALTER USER &lt;USERNAME&gt; PROFILE &lt;PROFILENAME&gt;;</code></pre><p id="9c7bb5b4-4c73-41fc-b119-674d2a02139f" class="">
</p><p id="00e5197b-78b0-4167-b04d-36ac0c26e830" class="">
</p><p id="d7d1c67f-eeac-4125-bcf0-e4ca70b3a04a" class=""><mark class="highlight-red">/**************************************************************************************<br/>----------------------------------------CONTROLFILES--------------------<br/>**************************************************************************************/</mark></p><p id="ab1e55db-3b0e-4131-96f9-aef04715af5c" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="199b3dd0-b5e7-422d-92e0-41819407894d" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SHOW PARAMETER CONTROL;</code></pre><p id="37d1950d-2435-40c5-8fae-110847cb6ad6" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3c5d59f6-4540-423d-bcbf-c4dde551d243" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select name from v$controlfile;</code></pre><p id="5e656304-7ebe-4653-871c-03a177bce143" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8954cba2-4d62-46ff-9fb6-a29491918ae0" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#Backup do controlfile para um arquivo binario
ALTER DATABASE BACKUP CONTROLFILE TO &#x27;/dir/controlfile.bkp&#x27;;

#Backup trace
ALTER DATABASE BACKUP CONTROLFILE TO TRACE;

</code></pre><p id="fb4dbc25-ba0f-4910-b9fe-b0a24052e98c" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e153356a-6523-4c5d-b1ef-6b274dc2960b" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all"># arquivo texto
ALTER DATABASE BACKUP CONTROLFILE TO TRACE;</code></pre><p id="40aa2632-c8e9-44d9-a6b7-0109bbfd0bc4" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ea2e2b9-ffd9-4978-bacc-5217494c85cb" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all"># Via RMAN
rman target /
COPY CURRENT CONTROLFILE TO &#x27;/dir/controlfile.bkp&#x27;;</code></pre><p id="44f17670-6f10-4b7b-b843-6695ac1aa9b3" class="">
</p><p id="2102e8e9-0389-4f24-afbc-1d39dda9ba95" class="">
</p><p id="6f0be0d9-aeb0-44c8-b08d-3fe4d2f79e4f" class=""><mark class="highlight-red">/**************************************************************************************<br/>----------------------------------------AUDITORIA--------------------<br/>**************************************************************************************/</mark></p><p id="8ba0b5f0-f960-4d83-a62d-45d304383ba6" class="">
</p><p id="9cb61edb-d35b-498d-a353-eedd74f085a6" class="">
</p><ul id="fd0a81c1-3bad-43a0-a58e-20581c8a94db" class="toggle"><li><details open=""><summary>Comandos usados para habilitar auditoria a nivel de DDL e DML</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aab45e6c-0a07-4673-888a-093f51e83a96" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">AUDIT TABLE BY nome_do_usuario BY ACCESS;

AUDIT INSERT TABLE BY nome_do_usuario BY ACCESS;
AUDIT UPDATE TABLE BY nome_do_usuario BY ACCESS;
AUDIT DELETE TABLE BY nome_do_usuario BY ACCESS;</code></pre></details></li></ul><ul id="fc2c267e-c26c-4688-ada8-63cbbbe69d6f" class="toggle"><li><details open=""><summary>Comandos usados para desabilitar a auditoria a nivel de DDL e DML</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="18a9fc36-028a-4a48-bc5b-edd66f18f3e7" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">NOAUDIT TABLE BY nome_do_usuario;

NOAUDIT INSERT TABLE BY nome_do_usuario;
NOAUDIT UPDATE TABLE BY nome_do_usuario;
NOAUDIT DELETE TABLE BY nome_do_usuario;</code></pre></details></li></ul><ul id="59a53aed-8576-4d78-a622-36b6e72ced17" class="toggle"><li><details open=""><summary>Query para pesquisar tudo que foi auditado</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3da03ea8-c0a9-485a-bb5b-a8deb04779e3" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT
timestamp,
username,
userhost,
owner,
obj_name,
action_name,
sql_text
FROM dba_audit_trail
WHERE UPPER(USERNAME) = &#x27;nome_do_usuario&#x27;
AND UPPER(USERHOST) = &#x27;&lt;maquina&gt;&#x27;
AND TIMESTAMP BETWEEN TO_DATE(&#x27;24/08/2020 11:00:00&#x27;,&#x27;DD/MM/YYYY HH24:MI:SS&#x27;) AND TO_DATE(&#x27;24/08/2020 11:02:00&#x27;,&#x27;DD/MM/YYYY HH24:MI:SS&#x27;)
ORDER BY timestamp desc;</code></pre></details></li></ul><ul id="e98c0143-918b-46e3-9622-3a5e8fa5b814" class="toggle"><li><details open=""><summary>Query para pesquisar tudo que foi auditado 2</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="941d2581-f5fd-47c9-913b-0a8a2f4dd615" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select syaud.current_user,
       syaud.spare1,
       syaud.ntimestamp#,
       syaud.userhost,
       aact.name,
       syaud.returncode,
       syaud.sqltext,
       syaud.comment$text
from sys.aud$ syaud inner join audit_actions aact on syaud.action# = aact.action 
where spare1 not in (&#x27;oracle&#x27;, &#x27;orarom&#x27;, &#x27;grid&#x27;)
and aact.name not in (&#x27;LOGON&#x27;, &#x27;LOGOFF&#x27;, &#x27;LOGOFF BY CLEANUP&#x27;);
/

SET SERVEROUTPUT ON
EXEC DBMS_OUTPUT.PUT_LINE(SQLERRM(-904)); </code></pre><p id="e6f68f1d-bd75-4ca7-8596-e79a00bb8138" class="">
</p></details></li></ul><ul id="f7c905fe-1e59-4e66-9dac-196567997176" class="toggle"><li><details open=""><summary>Verificar todos os usuários auditados da database, assim como também o que está sendo auditado:</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9f0c24f1-b0e0-4290-a427-cb802bb075fa" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select * from dba_stmt_audit_opts;</code></pre></details></li></ul><ul id="d2efa4bd-7ef3-4f43-8a72-3de3448a299e" class="toggle"><li><details open=""><summary>Tamanho da tabela de auditoria</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b22ad698-e3e2-4073-9796-f03038cd9f6e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select segment_name table_name ,bytes/1024/1024 size_in_megabytes from dba_segments where segment_name in (&#x27;AUD$&#x27;);</code></pre></details></li></ul><ul id="76fa1ea6-ffe8-471c-a136-7f718f24f77a" class="toggle"><li><details open=""><summary>Habilitar auditoria de falha de logon</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f9907d42-86f4-4200-a798-e8f38653052b" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Ajustar o parâmetro no banco de dados (é necessario restart da base)
--Mas antes salvar o valor atual do parâmetro se tiver
 show parameter audit_trail;
alter system set audit_trail=&quot;db_extended&quot; scopre=spfile;

--configurar auditoria
--falha de login:
audit session whenever not successful;

--qualquer login
audit session by access;

--testar uma conexão com falha
connect notauser/notmypass

--Verificar log gerado - somente as 10 tentativas mais recentes (via SQL*Plus)
column USERHOST format a30

select * from ( select OS_USERNAME,USERNAME,USERHOST,TIMESTAMP,ACTION_NAME,RETURNCODE,INSTANCE_NUMBER from dba_audit_session  order by timestamp desc) where rownum &lt;= 10;

--Desativar auditoria de conexão
noaudit session;</code></pre></details></li></ul><ul id="87c52db3-33ea-4db4-b084-0fedfc37bb4f" class="toggle"><li><details open=""><summary>Gerenciamento automático de auditoria (AUD$)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="293d1c15-811d-4459-826f-17222da0dcec" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">https://www.oracle.com/technetwork/pt/articles/database-performance/gerenciamento-automatico-auditoria-3002076-ptb.html

--Criando a tablespace e alterando o local da auditoria
create tablespace ORACLE_AUDITORIA
datafile &#x27;+DATA/&lt;database_name&gt;/datafile/aud_oracle_01.dbf&#x27; size 25G autoextend on next 32M maxsize unlimited
extent management LOCAL
autoallocate
segment space management AUTO
LOGGING;

--this moves table AUD$
BEGIN
DBMS_AUDIT_MGMT.set_audit_trail_location(
audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD,
audit_trail_location_value =&gt; &#x27;ORACLE_AUDITORIA&#x27;);
END;
/
--this moves table FGA_LOG$
BEGIN
DBMS_AUDIT_MGMT.set_audit_trail_location(
audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD,--this moves table FGA_LOG$
audit_trail_location_value =&gt; &#x27;ORACLE_AUDITORIA&#x27;);
END

--Habilitando o Gerenciamento automático
Begin
DBMS_AUDIT_MGMT.INIT_CLEANUP(
audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_DB_STD,
default_cleanup_interval =&gt; 720);
End;
/

--CREATE_PURGE_JOB
BEGIN
DBMS_AUDIT_MGMT.CREATE_PURGE_JOB(
audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_DB_STD
, audit_trail_purge_interval =&gt; 720 --intervalo de limpeza, em horas
, audit_trail_purge_name =&gt; &#x27;JOB_Limpeza_Auditoria&#x27; --nome do job
,use_last_arch_timestamp =&gt; TRUE
);
END;
/

--Marcando registros a serem excluidos
CREATE OR REPLACE PROCEDURE AUDIT_DefineMarcacaoAudit
IS
BEGIN
DBMS_AUDIT_MGMT.SET_LAST_ARCHIVE_TIMESTAMP(
audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_AUD_STD,
last_archive_time =&gt; SYSDATE - 45);

DBMS_AUDIT_MGMT.SET_LAST_ARCHIVE_TIMESTAMP(
audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_FGA_STD,
last_archive_time =&gt; SYSDATE - 45);
END;
/

BEGIN
DBMS_SCHEDULER.CREATE_JOB(
job_name =&gt; &#x27;JOB_MarcaExclusaoAudit&#x27;, --nome do job
job_type =&gt; &#x27;STORED_PROCEDURE&#x27;,
job_action =&gt; &#x27;AUDIT_DefineMarcacaoAudit&#x27;,
repeat_interval =&gt; &#x27;FREQ=MONTHLY;INTERVAL=1&#x27;, -- uma vez ao mes
comments =&gt; &#x27;Job que executa a procedure que marca ate que ponto a auditoria pode ser removida&#x27;);

--Todo o job vem desabilitado por padrao no scheduler do 11.2, habilitando

DBMS_SCHEDULER.ENABLE(name =&gt; &#x27;JOB_MarcaExclusaoAudit&#x27;);

END;
/


--Alinhando JOBs
--ajusta data inicial comum e aninhada
DBMS_SCHEDULER.SET_ATTRIBUTE(
name =&gt; &#x27;JOB_MARCAEXCLUSAOAUDIT&#x27;,
attribute =&gt; &#x27;start_date&#x27;,
value =&gt; TO_TIMESTAMP(&#x27;20/02/2021 18:00:00&#x27;, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;));

DBMS_SCHEDULER.SET_ATTRIBUTE(
name =&gt; &#x27;AUDSYS.JOB_LIMPEZA_AUDITORIA&#x27;,
attribute =&gt; &#x27;start_date&#x27;,
value =&gt; TO_TIMESTAMP(&#x27;20/02/2021 18:30:00&#x27;, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;));

--Segundo sabado do mes
DBMS_SCHEDULER.SET_ATTRIBUTE(
name =&gt; &#x27;JOB_MARCAEXCLUSAOAUDIT&#x27;,
attribute =&gt; &#x27;repeat_interval&#x27;,
value =&gt; &#x27;FREQ=MONTHLY; BYDAY=2SAT&#x27;);

--Segundo sabado do mes
DBMS_SCHEDULER.SET_ATTRIBUTE(
name =&gt; &#x27;AUDSYS.JOB_LIMPEZA_AUDITORIA&#x27;,
attribute =&gt; &#x27;repeat_interval&#x27;,
value =&gt; &#x27;FREQ=MONTHLY; BYDAY=2SAT&#x27;);

END;
/

--Tabelas importantes
SELECT audit_trail, cleanup_time, delete_count FROM DBA_AUDIT_MGMT_CLEAN_EVENTS ORDER BY cleanup_time DESC;

SELECT * FROM DBA_AUDIT_MGMT_CLEANUP_JOBS;

SELECT * FROM DBA_AUDIT_MGMT_LAST_ARCH_TS;

SELECT * FROM DBA_AUDIT_MGMT_CONFIG_PARAMS;

SELECT DSJ.OWNER, DSJ.JOB_NAME, DSJ.JOB_TYPE, DSJ.JOB_ACTION, DSJ.START_DATE, DSJ.REPEAT_INTERVAL, DSJ.NEXT_RUN_DATE, DSJ.RUN_COUNT, DSJ.FAILURE_COUNT
FROM DBA_SCHEDULER_JOBS DSJ
WHERE JOB_NAME IN (&#x27;JOB_LIMPEZA_AUDITORIA&#x27;, &#x27;JOB_MARCAEXCLUSAOAUDIT&#x27;);</code></pre></details></li></ul><ul id="bdf6c8fb-3dc6-46b9-b488-5caf9db3b117" class="toggle"><li><details open=""><summary>Truncate na tabela sys.aud$</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="11096d91-5c23-4143-b8c7-ca8fad0f1259" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">truncate table sys.aud$;

BEGIN
DBMS_AUDIT_MGMT.init_cleanup(
audit_trail_type =&gt; DBMS_AUDIT_MGMT.AUDIT_TRAIL_ALL,
default_cleanup_interval =&gt; 12 /* hours */);
END;
/</code></pre></details></li></ul><ul id="51adc0ce-5923-4362-8f6d-4f5802048375" class="toggle"><li><details open=""><summary>Passo a Passo para ativar auditoria geral no banco</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2841ed9f-288f-4449-958d-62941670651e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">-- Primeiro passo: setar um dos seguintes valores para o parametro AUDIT_TRAIL
-- none (ou false): Auditoria desativada.
-- OS: Os registros de auditoria são gravados na trilha de audi do sistem operacional
-- DB: Os registros de auditoria são gravados em uma tabela do dicionario de dados SYS.AUD$. Existem views que permitem ver o conteúdo dessa tabela
-- DB_EXTENDED: Igual ao DB, mas incluíndo as instruções SQL com variaveis bind que geram os registros de auditoria.
-- XML: Como o parâmetro OS, mas formatado com tags XML.
-- XML_EXTENDED: Como o parâmetro XML, mas com instruções SQL e variaveis bind.

-- Comando usado para altearar o parametro audit_trail
-- acessar o usuario oracle
su - oracle
-- setar o oraenv
. oraenv
--Via sqlplus ou sql developer, rodar o alter system abaixo.
ALTER SYSTEM SET AUDIT_TRAIL=&#x27;DB_EXTENDED&#x27; SCOPE = SPFILE;

-- Ainda no SQLPLUS
SHUTDOWN IMMEDIATE OU srvctl stop database -d &lt;NOME_DB&gt; -o immediate
STARTUP OU srvctl start database -d &lt;nome_db&gt; 

-- Apos o reinicio do banco, verificar se o parametro audit_trail está ligado, verificar
-- na coluna value.
SHOW PARAMETER AUDIT_TRAIL;

-- Agora rodar os seguintes comandos para habilitar o que a auditoria vai auditar
AUDIT SELECT TABLE, UPDATE TABLE, INSERT TABLE, DELETE TABLE BY ACCESS;

--Em seguida definir a politica de auditoria para incluir o texto SQL completo.
AUDIT SELECT ANY TABLE BY ACCESS;

--Esse comando habilitará os selects em todas as tabelas, incluindo textos sql completos.

-- Verificar as configurações de auditoria
SELECT * FROM DBA_AUDIT_TRAIL WHERE ACTION_NAME = &#x27;SELECT&#x27;;
-- O comando anterior mostrará os registros de auditoria para os selects, incluindo texto SQL

	</code></pre></details></li></ul><ul id="2b8864eb-009a-8049-8db6-c5e71b60f42e" class="toggle"><li><details open=""><summary>Scripts uteis para consultar melhor a auditoria</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b8864eb-009a-8034-bbcf-d77e1db08b1e" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">--Query universal para ver quem está gerando mais auditoria
SELECT
    USERID AS db_user_id,
    USERHOST,
    TERMINAL,
    COUNT(*) AS total_registros
FROM sys.aud$
GROUP BY USERID, USERHOST, TERMINAL
ORDER BY total_registros DESC;

/
--. Query universal para ver crescimento por ação
SELECT
    a.ACTION#,
    a.USERID AS db_user_id,
    act.NAME AS action_name,
    COUNT(*) AS total
FROM
    sys.aud$ a
    LEFT JOIN audit_actions act
        ON a.action# = act.action
GROUP BY
    a.ACTION#, a.USERID, act.NAME
ORDER BY
    total DESC;

/
--Ver os eventos mais recentes
SELECT
    SESSIONID,
    ENTRYID,
    USERID,
    ACTION#,
    NTIMESTAMP#
FROM sys.aud$
ORDER BY NTIMESTAMP# DESC
FETCH FIRST 50 ROWS ONLY;


--. Query mais importante:
SELECT
    USERID AS db_user_id,
    USERHOST,
    TERMINAL,
    COUNT(*) AS registros_2h
FROM sys.aud$
WHERE NTIMESTAMP# &gt; SYSTIMESTAMP - INTERVAL &#x27;2&#x27; HOUR
GROUP BY USERID, USERHOST, TERMINAL
ORDER BY registros_2h DESC;</code></pre></details></li></ul><p id="92a95c13-db1d-4c13-bd1e-f92fb9c6144e" class="">
</p><p id="52908b35-b301-4455-bbff-8b3541ec29fe" class=""><mark class="highlight-red">/**************************************************************************************<br/>-------------------- DICIONARIO DE DADOS / DATA DICTIONARY ------------------<br/>**************************************************************************************/</mark></p><ul id="98fbac1b-ad27-423b-80cf-cdef61e8becb" class="toggle"><li><details open=""><summary>Lista todas as tabelas e views do dicionario de dados que estão acessiveis ao usurio</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a8cdaef4-6192-4fb4-a213-e6082a2ae327" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM DICTIONARY;
/
SELECT * FROM DIC;</code></pre></details></li></ul><ul id="bf223056-041d-43c9-94c7-3bce06214506" class="toggle"><li><details open=""><summary>Comando usado para trazer todos as tabelas pertencentes ao usuario que executou.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="66ee7bc4-cbe6-4668-823e-588853e00633" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM TAB;</code></pre></details></li></ul><p id="920d805e-1ded-4a0c-b10d-7a9e4e6d8d38" class="">
</p><ul id="ccf102eb-8d77-49e2-a684-2164bbb26695" class="toggle"><li><details open=""><summary>Criar um DIRETORIO ORACLE</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="543d30c2-5c14-45f6-808e-3ff0a4e35932" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">CREATE OR REPLACE DIRECTORY &lt;nome_alas&gt; AS &#x27;&lt;dir/*/&gt;&#x27;;</code></pre><p id="deb1a7ff-cec6-4bd3-b689-0235a7466d55" class="">
</p><p id="0bb5a8c4-5ae3-4134-a855-90891ea84f22" class="">
</p></details></li></ul><ul id="f2ae1908-bd7a-408c-a46d-7ae777f6833e" class="toggle"><li><details open=""><summary>Consultar as colunas que possuem HCC</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5d5a072f-e932-4778-8bed-61953aaaa152" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT OWNER,
       TABLE_NAME,
       COMPRESSION 
FROM DBA_TABLES 
WHERE OWNER IN ( 
                 SELECT USERNAME 
                 FROM DBA_USERS 
                 WHERE USERNAME LIKE &#x27;U\_%&#x27; ESCAPE &#x27;\&#x27; 
                ) 
AND COMPRESSION &lt;&gt; &#x27;DISABLED&#x27;;

/</code></pre><p id="6c8b401c-3cc1-4887-9103-43a7f233cdd4" class="">
</p></details></li></ul><p id="32dfaf3e-e1eb-4282-9c29-6918b2d615f5" class="">
</p><p id="217c39c0-70bc-41c3-92ff-d6a700a64916" class="">
</p><p id="9d880082-7b53-47fb-9c1e-e993dec414ec" class=""><mark class="highlight-red">/**************************************************************************************<br/>----------------------------------- BACKUP  DATAPUMP --------------------<br/>**************************************************************************************/</mark></p><ul id="a86d2efa-59ff-48c9-a24a-85cd2448b938" class="toggle"><li><details open=""><summary>Script para criação de um novo objeto “directory”</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e6ee14fa-f092-4ef4-99da-8f155ca4d128" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">
#OBS -&gt; É NECESSARIO QUE O DIRETORIO A NIVEL DE SO SEJA CRIADO PRIMEIRO, O DIRETORIO PRECISA
#TER ACESSO ORACLE:OINSTALL

#CRIAR O OBJETO DIRECTORY
CREATE OR REPLACE DIRECTORY &lt;name&gt; AS &#x27;/DIR&#x27;;</code></pre></details></li></ul><ul id="4c3c911c-4b2a-4b83-8a5b-92bc59dfef28" class="toggle"><li><details open=""><summary>Script para conceder permissão de leitura/escrita do objeto a um determinado user</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="42061965-c298-494e-9b02-0b5616f6748e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">GRANT READ, WRITE ON DIRECTORY &lt;NAME&gt; TO &lt;USER&gt;</code></pre></details></li></ul><ul id="bd8690d6-c128-4284-a374-b39eb9f0bb32" class="toggle"><li><details open=""><summary>Script para consultar detalhes dos objetos “directory” criados</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2906ebf0-3b2e-4032-8428-36d7483f5c38" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM DBA_DIRECTORIES;
/
SELECT * FROM ALL_DIRECTORIES</code></pre></details></li></ul><ul id="97b85ef5-ee97-4914-a128-e591c685f6bb" class="toggle"><li><details open=""><summary>Comando help para o expdp e impdp</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="389e455a-9e60-4a0b-bbd7-f7ad7e424078" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#O HELP É USADO FORA DO SQLPLUS, É EXECUTADO NO PROPRIO TERMINAL.
[oracle@oraclelinux ~]$ expdp help=y
[oracle@oraclelinux ~]$ impdp help=y</code></pre></details></li></ul><ul id="1358ba65-816c-4f4a-8df9-f31d60e69b55" class="toggle"><li><details open=""><summary>Comandos para exportar / importar tabelas via terminal linux</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3d3918ee-b8ff-4cf1-929d-2eaae276898f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">expdp directory=dir_name dumpfile=file.dmp logfile=file.log tables=table_names
impdp directory=dir_name dumpfile=file.dmp logfile=file.log tables=table_names</code></pre><p id="0b348168-18c7-438e-889e-407de241724b" class="">
</p></details></li></ul><ul id="aad6a42b-1061-4abc-94c4-696fe555eb13" class="toggle"><li><details open=""><summary>Comando para importar tabela para um outro schema via terminal linux</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="71e5a280-8ad0-4e6b-a923-38b2f52ac083" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">impdp directory=dir_name dumpfile=file.dmp logfile=file.log tables=table_name
schemas=schema_original remap_schema=new_schema:table_name</code></pre></details></li></ul><ul id="f52aa31b-39c9-4798-883b-b7dcf5df88a6" class="toggle"><li><details open=""><summary>Comando para importar tabelas para outra tablespace (somente em Datapump)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="356f9eee-79a9-4994-bbaa-03adbeef3b42" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">impdp directory=dir_name dumpfile=file.dmp logfile=file.log tables=table_name
schema=original_schema remap_schema=new_schema:table_name remap_tablespace=new_tbs:table_name
</code></pre></details></li></ul><ul id="af2d9b73-3f0c-4987-9c4b-d323cc7b9122" class="toggle"><li><details open=""><summary>Comando para importar tabela para um nome diferente ou renomear uma tabela</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e9137386-b996-4dad-8718-d9c7d336a751" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">impdp directory=dir_name dumpfile=file.dmp logfile=file.log tables=table_name
remap_table=schema.original_table_name:schema(new_schema).new_tb_name</code></pre></details></li></ul><ul id="ed6a7f1a-e7d2-466b-8f4c-a05037e5698c" class="toggle"><li><details open=""><summary>Comando para importar somente os dados ou somente a estrutura</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3b7d13a3-3611-47cc-93e8-566e5b1c89cb" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">impdp directory=dir_name dumpfile=file.dmp logfile=file.log tables=tb_name
content=data_only
/
impdp directory=dir_name dumpfile=file.dmp logfile=file.log tables=tb_name
content=metadata_only</code></pre></details></li></ul><ul id="cedbc2b6-e811-45cc-bd23-3bfdba916773" class="toggle"><li><details open=""><summary>Comando para importar somente o schema e importar alterando o nome</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="31ee76a9-843b-49fd-8ec6-15c42630f58e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">impdp directory=dir_name dumpfile=file.dmp logfile=file.log schema=schema_name
/
impdp directory=dir_name dumpfile=file.dmp logfile=file.log schema=original_sch_name
remap_schema=original_sch_name:new_sch_name</code></pre></details></li></ul><ul id="21b618f9-72c2-460a-a67e-5ee6ddf2a59f" class="toggle"><li><details open=""><summary>Comando para exportar uma tabela com filtro de linhas</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c0de9190-221a-4748-9581-c4a073489b18" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">expdp directory=dir_name dumpfile=file.dmp logfile=file.log 
tables=schema.tb query=\&quot;where condição\&quot;</code></pre></details></li></ul><ul id="f2877c1a-dc0d-4530-9359-1e4f5f1a8ec3" class="toggle"><li><details open=""><summary>Comando para um full database export </summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="058bdfde-9d42-4d85-a060-dccee6126dca" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">expdp directory=dir_name dumpfile=file.dmp logfile=file.log full=y</code></pre></details></li></ul><ul id="83840341-9694-4036-a33c-d43f87253349" class="toggle"><li><details open=""><summary>Comando para importar um database completo</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8d8b11ee-1637-4a7e-9a1d-e8dbc0411be0" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--On source
select name from v$tablespace;

--On target
select name from v$tablespace;

--Create missing tb on target
--Make sure target tb has enough free space
--Drop all non-oracle schemas (done during refresh)
--DROP USER &lt;username&gt; CASCADE;

impdp directory=dir_name dumpfile=file.dmp logfile=file.log full=y</code></pre></details></li></ul><ul id="4064de98-cf6a-4b81-bd5e-98a433953639" class="toggle"><li><details open=""><summary>Comandos para uma melhor performance no Data Pump</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2554aaa2-9e8e-4ae0-a907-4b370ebd02c6" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--You can always use DIRECT=y parameter to perform faster exports and imports.
--You can also use PARALLEL parameter to start multiple export and import process
-- for faster performance
--Make sure to use %U with the dumpfile name so multiple dumpfiles can be read/write
-- Simultaneously

expdp directory=dir_name DIRECT=y dumpfile=file_%U.dmp logfile=file.log
schemas=sch_name parallel=4
/
impdp directory=dir_name DIRECT=y dumpfile=file_%U.dmp logfile=file.log
schemas=sch_name parallel=4</code></pre></details></li></ul><ul id="a18e91a3-5945-4061-9e34-568fec2a2b38" class="toggle"><li><details open=""><summary>Trabalhar com arquivo PAR File no Data Pump</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1239c25f-acbf-4677-93b4-87da01b5b615" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Data Pump jobs can be automated using PAR file.
--You basically create one par file which contains all the export or import
-- parameters and just call the par file at expdp utility
-- First you need to create a file with .par extention
-- Second, you need to edit this par file with Data pump parameters
vi exp.par

DIRECTORY=DIR_NAME
DUMPFILE=FILE_%U.dmp
LOGFILE=FILE.LOG
JOB_NAME=JOB
SCHEMAS=SCH_NAME
PARALLEL=4

--And it&#x27;s very simple to call the above export PAR file.
expdp parfile=exp.par</code></pre></details></li></ul><ul id="86e894ed-3ea8-44d1-bd3c-34a714b7cbd8" class="toggle"><li><details open=""><summary>Script para schedular no crontab Data Pump</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ecd851c-fdda-492e-b32d-9a26be67af96" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Create a file which contains expdp script
vi daily_export.sh

export DATA=$(date +%m_%d_%y_%H_%M)
export ORACLE_SID=orcl
export ORACLE_HOME=dir_oracle_home

$ORACLE_HOME/bin/expdp username/password@sid directory=export_dir 
dumpfile=backup_$DATE.dmp logfile=backup_$DATE.log full=y

--Give permissions to execeute on above file
chmod 755 daily_export.sh

--Schedule export under crontab
crontab -e -u oracle

0020***/home/oracle/backup_script</code></pre></details></li></ul><ul id="3c890a4e-df89-4181-bb7f-0d2de5fc7513" class="toggle"><li><details open=""><summary>Script para consultar o progresso de uma exportação DataPump</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aad33d5c-089e-4206-bd2a-e1b254503d9f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--When you run a data pump export in the background and want to know the progress 
-- status, use below query to get the percentage(%) completion of the export process

SELECT SID, SERIAL#, USERNAME, CONTEXT, SOFAR, TOTALWORK,
ROUND(SOFAR/TOTALWORK*100,2) &quot;%_COMPLETE&quot; FROM V$SESSION_LONGOPS
WHERE TOTALWORK !=0 AND SOFAR &lt;&gt; TOTALWORK;
/
SELECT SID, SERIAL#, USERNAME, OPNAME, CONTEXT, SOFAR, TOTALWORK,
ROUND(SOFAR/TOTALWORK*100,2) &quot;%_COMPLETE&quot; FROM V$SESSION_LONGOPS
WHERE TOTALWORK !=0 AND SOFAR &lt;&gt; TOTALWORK AND OPNAME LIKE &#x27;IMP%&#x27;;</code></pre></details></li></ul><ul id="52b35730-8892-4c68-a1fb-d378ffd770e1" class="toggle"><li><details open=""><summary>Script para consultar o status de uma exportação</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="67348364-f8f7-42e8-bb4e-8886e997b857" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select * from dba_datapump_jobs</code></pre></details></li></ul><ul id="73704e10-9852-426c-9a76-faff31f4e7f0" class="toggle"><li><details open=""><summary>Parametros para remap</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="12b9339c-6498-4954-bbfa-0893aeeeab58" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">REMAP_TABLE=[schema.]old_tablename[.partition]:new_tablename

REMAP_DATA=[schema.]tablename.column_name:[schema.]pkg.function

REMAP_TABLESPACE=source_tablespace:target_tablespace

REMAP_SCHEMA=source_schema:target_schema

REMAP_DATAFILE=source_datafile:target_datafile</code></pre></details></li></ul><ul id="f14e8430-4687-4c4b-9b94-084a5b2bf76f" class="toggle"><li><details open=""><summary>Comando para interromper uma job datapump</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5c9c6a33-5b1b-4fa2-aa04-4f265d9b4ce3" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">KILL_JOB</code></pre></details></li></ul><ul id="a5d63b1f-887b-40d4-8dda-99ed060d048f" class="toggle"><li><details open=""><summary>Parametros de Exclude e Include</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2f727f32-8041-45ff-99ef-8ffef5f086f9" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">expdp hr DIRECTORY=dpump_dir1 DUMPFILE=hr_exclude.dmp EXCLUDE=VIEW,PACKAGE,FUNCTION</code></pre></details></li></ul><p id="9a95ca4a-900d-47e8-8c50-4e1a8b6b16e0" class="">
</p><p id="15bf7e1c-2130-4a10-8162-58a4ca98a031" class=""><mark class="highlight-red">/**************************************************************************************<br/>---------------------------------- BACKUP  RMAN -------------------—————<br/>**************************************************************************************/</mark></p><ul id="1edf44c2-26e9-44c3-84a9-8a3d44e712a5" class="toggle"><li><details open=""><summary>Passos para se conectar ao prompt RMAN</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="295e2d82-0594-41e5-aa79-b8ea758ee257" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#Acessar o usuario oracle
#setar o SID no oraenv
#Rodar o comando rman target

rman target /</code></pre></details></li></ul><ul id="1f33c633-c4bf-4e88-9f10-b9e312cb5f6c" class="toggle"><li><details open=""><summary>Para ver as configurações atuais do RMAN</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c7719bf8-b468-4fb7-b4f5-cae162c2a3ea" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">show all;</code></pre></details></li></ul><ul id="22de8389-cd8f-4e25-96c7-8dd73ce131cd" class="toggle"><li><details open=""><summary>Mudando o valor de um parametro RMAN</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="eaf1c22b-c03d-4bd0-adfb-0691d0b6b24e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#Para mudar o valor de um parametro no rman basta </code></pre></details></li></ul><p id="351e8659-8879-47cb-9a95-9ac7481a8d2b" class="">
</p><p id="052496e3-037d-476e-97ee-3f81e197be14" class="">
</p><p id="5cc8c20a-e361-4c1c-b6e0-a371c4331c45" class=""><mark class="highlight-red">/**************************************************************************************<br/>--------------------------------- MONITORING SGA and PGA ------------------<br/>**************************************************************************************/</mark></p><p id="524c389f-2fdf-4808-a8d5-4cb3c03c0a43" class=""><a href="https://www.dba-oracle.com/o10g_v_dollar_sga.htm">https://www.dba-oracle.com/o10g_v_dollar_sga.htm</a></p><ul id="1b920f8d-abea-4291-9047-80e516e74377" class="toggle"><li><details open=""><summary>Displays summary information about the system global area (SGA).</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9b7919e0-9f27-4665-90c3-b2d0029283f3" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM GV$SGA;
#INST_ID INSTANCE
#NAME = SGA component group
#VALUE = Memory size (in bytes)
#CON_ID = The ID container to which the data pertains possible values include</code></pre><p id="5ab7f259-8d6d-43e0-ab0c-4015acd94540" class="">
</p></details></li></ul><ul id="11e44181-8c8c-452d-ae82-e165d9a63bc5" class="toggle"><li><details open=""><summary>Displays size information about the SGA, including the sizes of different SGA components, the granule size, and free memory.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="74f286eb-b236-46ed-9eb3-5f20a8b270e2" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM GV$SGAINFO;

#NAME = NAME OF THE SGA SIZE ITEM
#BYTES = SIZE OF THE ITEM (IN BYTES)
#REIZEABLE = INDICATES WHETHER THE ITEM IS RESIZEABLE (YES) OR NOT (NO)</code></pre></details></li></ul><ul id="748888aa-dc92-424b-82bb-c1dedf62ac77" class="toggle"><li><details open=""><summary>Displays detailed information about the SGA.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="14bed12d-b346-4f69-809c-b5e59f86bf83" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM GV$SGASTAT;
#POOL = DESIGNATES THE POOL IN WHICH THE MEMORY IN NAME RESIDES:
				# IN - MEMORY POOL = MEMORY IS ALLOCATED FRO THE IN-MEMORY POOL
        # JAVA POOL = MEMORY IS ALLOCATED FROM THE JAVA POOL
        # LARGE POOL = MEMORY IS ALLOCATED FROM THE LARGE POOL
        # NUMA POOL = MEMORY IS ALLOCATED FROM THE NUMA POOL
				# SHARED POOL = MEMORY IS ALLOCATED FROM THE SHARED POOL
        # STREAMS POOL = MEMORY IS ALLOCATED FROM THE STREAMS POOL
# NAME = SGA COMPONENT NAME
</code></pre></details></li></ul><ul id="46d1bf79-656b-4a4b-bdf1-a1b6ea75ee64" class="toggle"><li><details open=""><summary>Displays information about the dynamic SGA components. This view summarizes information based on all completed SGA resize operations since instance startup</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="015516a7-6737-47d5-a6c4-bf9d7437fa30" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM GV$SGA_DYNAMIC_COMPONENTS</code></pre></details></li></ul><ul id="ce42d6b1-cf44-470a-967d-a019425f266c" class="toggle"><li><details open=""><summary>Displays information about the amount of SGA memory available for future dynamic SGA resize operations.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="369858e6-ad7b-4a59-847d-fe1ed71320a7" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT * FROM GV$SGA_DYNAMIC_FREE_MEMORY;</code></pre></details></li></ul><ul id="4c73c7f8-e300-4eea-83cb-c3e6d256c44f" class="toggle"><li><details open=""><summary>Comando usando para consultar o TOP SQL_ID consumo de PGA</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="657dc754-b13d-473c-87bb-38b1bb0dcd69" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Top sql_id&#x27;s that consumed PGA: 
WITH PGA_USAGE AS (select SESSION_ID, 
                          SESSION_SERIAL#,
                          INSTANCE_NUMBER, 
                          SQL_ID, 
                          PGA_MAX_GB, 
                          PROGRAM, 
                          SAMPLE_TIME
                    from (select SESSION_ID, 
                                 SESSION_SERIAL#,
                                 instance_number, 
                                 sql_id, 
                                 max(pga_sum_mb) pga_max_GB, 
                                 PROGRAM, 
                                 sample_time 
                          from (select SESSION_ID,
                                       SESSION_SERIAL#,
                                       instance_number, 
                                       sample_time,
                                       sql_id, 
                                       round(sum(nvl(pga_allocated, 0))/1024/1024/1024) pga_sum_mb, 
                                       PROGRAM
                                 from dba_hist_active_sess_history
                                 where sample_time between &#x27;01/05/24 09:00:00&#x27; and SYSDATE
                                 group by instance_number, sample_time, sql_id, PROGRAM, SESSION_ID, SESSION_SERIAL#
                                 )
                                 group by instance_number, sql_id, PROGRAM, sample_time, SESSION_ID, SESSION_SERIAL#
                                 order by SAMPLE_TIME desc)
)


SELECT S.USERNAME, 
       P.SESSION_ID,
       P.SESSION_SERIAL#,
       P.INSTANCE_NUMBER, 
       P.SQL_ID, P.PGA_MAX_GB, 
       P.PROGRAM, 
       P.SAMPLE_TIME 
       FROM GV$SESSION S inner join PGA_USAGE  P ON S.SID = P.SESSION_ID
where rownum &lt;= 10;



</code></pre></details></li></ul><ul id="4485ac50-5817-4ce9-aed8-edba73b090cb" class="toggle"><li><details open=""><summary>Script usado para  exibe objetos de banco de dados que estão armazenados em cache no cache da biblioteca. Os objetos incluem tabelas, índices, clusters, definições de sinônimos, procedimentos e pacotes PL/SQL e gatilhos.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="40d65fce-b09a-4c68-aeee-39f2d836b479" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--This view displays database objects that are cached in the library cache. Objects include tables, indexes, clusters, synonym definitions, PL/SQL procedures and packages, and triggers.
--Quantidade de memória compartilhável no pool compartilhado consumida pelo objeto
--https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/V-DB_OBJECT_CACHE.html#GUID-5A9003C9-088A-4272-B508-BD2C3BA35729
select OWNER, NAME||&#x27; - &#x27;||TYPE object, SHARABLE_MEM / 1024/ 1024
from v$db_object_cache
where SHARABLE_MEM &gt; 10000
and type in (&#x27;PACKAGE&#x27;,&#x27;PACKAGE BODY&#x27;,&#x27;FUNCTION&#x27;,&#x27;PROCEDURE&#x27;) and owner not in (&#x27;SYS&#x27;, &#x27;DBSNMP&#x27;)
order by SHARABLE_MEM desc;</code></pre></details></li></ul><ul id="abff5764-a62e-4fc9-8132-3003af8e0ed3" class="toggle"><li><details open=""><summary>Script para consultar uma nova metrica para PGA</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ec3d06fd-8747-4e7f-b397-b5643d963e6f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">WITH
   MAX_PGA as
     (select round(value/1024/1024/1024,1) max_pga from v$pgastat where name=&#x27;maximum PGA allocated&#x27;),
   MGA_CURR as
     (select round(value/1024/1024/1024,1) mga_curr from v$pgastat where name=&#x27;MGA allocated (under PGA)&#x27;),
   MAX_UTIL as
     (select max_utilization as max_util from v$resource_limit where resource_name=&#x27;processes&#x27;),
    pga_aggr_limit as 
        (select value/1024/1024/1024 as curr_pga_aggregate_limit from v$parameter where name like &#x27;pga_aggregate_limit&#x27;),
    pga_aggr_target as 
        (select value/1024/1024/1024 as curr_pga_aggregate_target from v$parameter where name like &#x27;pga_aggregate_target&#x27;)
SELECT
   a.max_pga &quot;Max PGA (GB)&quot;,
   b.mga_curr &quot;Current MGA (GB)&quot;,
   c.max_util &quot;Max # of processes&quot;,
   round(((a.max_pga - b.mga_curr) + (c.max_util * 5)/1024) * 1.1, 1) &quot;New PGA_AGGREGATE_LIMIT (MB)&quot;,
   d.curr_pga_aggregate_limit,
   e.curr_pga_aggregate_target
FROM MAX_PGA a, MGA_CURR b, MAX_UTIL c, pga_aggr_limit d, pga_aggr_target e
WHERE 1 = 1;</code></pre></details></li></ul><ul id="5dd35660-d45f-45ad-98af-109402961caf" class="toggle"><li><details open=""><summary>Find which process is continue to consume more and more memory</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cc841457-dc29-44d5-9290-f2b0df2f0803" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--ORACLE DOC https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=286494379343899&amp;parent=EXTERNAL_SEARCH&amp;sourceId=HOWTO&amp;id=822527.1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=s8g9hpynf_4
--Find which process is continue to consume more and more memory. This can be found by using the following query:
SELECT s.inst_id,
       s.username, 
       SUBSTR(s.sid,1,5) sid,
       s.serial#,
       p.spid, 
       to_char(logon_time, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;),
       SUBSTR(s.program,1,22) program , 
       s.process pid_remote,
       s.status,
       ROUND((pga_used_mem/1024/1024), 2) &quot;Used GB&quot;,
       ROUND((pga_alloc_mem/1024/1024), 2) &quot;Allocated GB&quot;,
       ROUND((pga_freeable_mem/1024/1024), 2) &quot;Freeable GB&quot;,
       ROUND((pga_max_mem/1024/1024/1024),2 ) &quot;Max GB&quot;
FROM  Gv$session s,v$process p
WHERE p.addr=s.paddr and (s.username is not null and s.username not in (&#x27;DBSNMP&#x27;, &#x27;SYS&#x27;, &#x27;SYSRAC&#x27;))
ORDER BY pga_max_mem,logon_time;
/


-- To get more detailed information in which component is growing can view V$PROCESS_MEMORY be used.
SELECT pid, 
       category, 
       allocated &quot;Allocated Bytes&quot;, 
       used &quot;Used Bytes&quot;, 
       max_allocated &quot;Max Allocated Bytes&quot;
FROM   gv$process_memory
WHERE  pid = (SELECT pid
              FROM   gv$process
              WHERE  addr= (select paddr
                            FROM   gv$session
                            WHERE  sid = 12 and serial# = 4180 ));
</code></pre></details></li></ul><ul id="07534469-10db-4fd1-943b-a9798859fd9b" class="toggle"><li><details open=""><summary>Script para encontrar a memoria PGA total da instancia e a sessão que mais consumiu</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="07c4a104-916d-4624-84ea-73c165d61013" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">#https://www.dataplatform.gr/en/pos-mporoyme-na-lamvanoyme-email-kathe-fora-5-2/
set echo off
set pagesize 0
set feedback off
select &#x27;Warning: Session&#x27;&#x27;s Program Page Area (PGA) Memory on &#x27;|| (select instance_name from v1TP4Instance) || &#x27;@&#x27; ||(select host_name from v1TP4Instance)||&#x27; is too high!!!       ---&gt; &#x27;  ||to_char(pga_sum_gb, &#x27;999g999g990d00&#x27;, &#x27;NLS_NUMERIC_CHARACTERS=,.&#x27;)|| &#x27; GB&#x27; as PGA_Response 
 FROM (select sum(pga_alloc_mem/1024/1024/1024) as pga_sum_gb from v$process)
where pga_sum_gb &gt; 0.01; -- DONT FORGET TO SWITCH
SELECT &#x27;Highest PGA Session: &#x27; 
   || &#x27; PGA:&#x27; || to_char(p.pga_alloc_mem/1024/1024/1024, &#x27;999g999g990d00&#x27;, &#x27;NLS_NUMERIC_CHARACTERS=,.&#x27;)||&#x27; GB &#x27;
   || &#x27; ---- LOGON: &#x27; || to_char(h.LOGON_TIME,&#x27;YYYY/MM/DD HH:MI:SS&#x27;) 
   || &#x27; ---- SID: &#x27; || h.SID
   || &#x27; ---- SERIAL: &#x27; || h.SERIAL#
   || &#x27; ---- PROCESS: &#x27; || p.SPID
   || &#x27; ---- USERNAME: &#x27; || u.username
   || &#x27; ---- OSUSER: &#x27; || h.osuser
   || &#x27; ---- MACHINE: &#x27; || h.machine
   || &#x27; ---- PROGRAM: &#x27; || h.program
   || &#x27; ---- MODULE: &#x27; || h.module
   || &#x27; ----               SQL TEXT: &#x27; || s.sql_text
   FROM
   gv$session h
LEFT JOIN gv$SQLAREA s ON h.sql_hash_value = s.hash_value and h.sql_ADDRESS = s.ADDRESS and h.inst_id = s.inst_id 
LEFT JOIN DBA_USERS u ON h.USER# = u.USER_ID
LEFT JOIN gv$process  p ON p.ADDR = h.PADDR and p.inst_id = h.inst_id 
WHERE  1=1
and (select sum(pga_alloc_mem/1024/1024/1024) as pga_sum_gb from v$process) &gt; 0.01 -- DONT FORGET TO SWITCH
and rownum &lt;=1
ORDER BY p.pga_alloc_mem DESC;
quit;
/</code></pre></details></li></ul><p id="1fd405b6-23f1-4677-82be-baead2a5f379" class="">
</p><p id="5f3a176d-9bb7-47f1-aa86-5147bb5929a5" class=""><mark class="highlight-red">/**************************************************************************************<br/>--------------------------------------- ORACLE ASMCMD-------------------——————<br/>**************************************************************************************/</mark></p><p id="a7073103-c8a5-421b-be2f-8793e99afb43" class=""><a href="https://dbaclass.com/article/useful-asmcmd-commands-oracle-cluster/">https://dbaclass.com/article/useful-asmcmd-commands-oracle-cluster/</a></p><ul id="9ae0a576-3ae5-4e21-b55e-524d75d53944" class="toggle"><li><details open=""><summary>Se conectar ao usuário grid e acessar o ASM</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="91059d34-a948-4aac-a26f-b21c1e54ff91" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">su - grid
	
. oraenv
&gt; +ASM1</code></pre></details></li></ul><ul id="6c34a472-bb14-472b-a405-416981fa37c6" class="toggle"><li><details open=""><summary>Script shell para consultar o ASM, detalhes dos Diskgroups</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2227a0d6-dfbe-44b2-ad07-c3f5ecb1f4b9" class="code code-wrap"><code class="language-Shell" style="white-space:pre-wrap;word-break:break-all">./asmdu_v3 
./asmdu_v3.sh -g
https://unknowndba.blogspot.com/2018/03/asmdush-far-better-du-for-asmcmd.html



#!/bin/bash
# Fred Denis -- June 2016 -- fred.denis3@gmail.com -- http://unknowndba.blogspot.com
# asmdu.sh - Shows a clear and nice summary of the ASM diskgroups used and free space (https://bit.ly/3c1pvfQ)
# Copyright (C) 2021 Fred Denis
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.
#
#
# More info and git repo: https://bit.ly/3c1pvfQ -- https://github.com/freddenis/oracle-scripts
#
# A note on the --nocp option
# Note that the --nocp asmcmd option (it disables the connection pooling) has been originaly implemented
# as a workaround of a bug that appeared with the April 2016 PSU
# It resolves error messages like this one :
# sh: -c: line 0: unexpected EOF while looking for matching `&#x27;&#x27;
# sh: -c: line 1: syntax error: unexpected end of file
#
#
# The current version of the script is 20211111
#
# 20211111 - Fred Denis - GPLv3 licence
# 20211018 - Fred Denis - Cosmetic, indentation, protect and quote, $() instead of ``
#                         Use of olr.loc instead of oraenv if possible
# 20190906 - Fred Denis - A new -V option to show the version of the script
# 20190219 - Fred Denis - Some had issues with the instance list, I then moved from sed to cut to fix it -- Thanks Jakub !
# 20181218 - Fred Denis - A new -n option to print with no color -- DEFAULT_NOCOLOR can be used to modify the default behavior
#                         Fixed the regexp to list the instances running
# 20180827 - Fred Denis - A better regexp to list the instances running
# 20180503 - Fred Denis - GI 12c introduces a &quot;Logical_Sector&quot; column, took this into account (Thanks Leon !)
# 20180327 - Fred Denis - &quot;Raw Used &quot; label for the subdirectories &quot;Mirror_used_MB&quot; column, adjustments in the help
# 20180318 - Fred Denis - Shows only mirrored sizes by default and the total non mirrored size only shown with the -v option
# 20180211 - Fred Denis -  Many improvements :
#                       - -d options to list the subdirectories of a directory
#                       - -v option to show the Raw Free and Reserverd size
#                       - -m -g and -t to choose the Unit you want the report to be in
#                       - Default values and verbosity can be changed using the DEFAULT_UNIT and the DEFAULT_VERBOSE variables
#                       - A nice usage function
# 20170719 - Fred Denis - Remove the --nocp option as default
#
#
# Default values (when no option is specified in the command line)
# The last uncommented value wins
#
   DEFAULT_UNIT=&quot;MB&quot;                     # asmcmd default
   DEFAULT_UNIT=&quot;GB&quot;
   DEFAULT_UNIT=&quot;TB&quot;
DEFAULT_VERBOSE=&quot;Yes&quot;
DEFAULT_VERBOSE=&quot;No&quot;
DEFAULT_NOCOLOR=&quot;Yes&quot;                    # Print with no color
DEFAULT_NOCOLOR=&quot;No&quot;                     # Print with colors
       CRITICAL=90                       # Colored thresholds (Red, Yellow, Green)
        WARNING=75                       # Colored thresholds (Red, Yellow, Green)
          WHITE=&quot;\033[1;37m&quot;
      END_COLOR=&quot;\033[m&quot;
            OLR=&quot;/etc/oracle/olr.loc&quot;    # olr.loc file to get crs home if oratab does not have ASM entry

#
# Show the version of the script (-V)
#
show_version() {
    VERSION=$(awk &#x27;{if ($0 ~ /^# 20[0-9][0-9][0-1][0-9]/) {print $2; exit}}&#x27; $0)
    printf &quot;\n\t\033[1;36m%s\033[m\n&quot; &quot;The current version of &quot;`basename $0`&quot; is &quot;$VERSION&quot;.&quot;          ;
}
#
# An usage function
#
usage() {
printf &quot;\n\033[1;37m%-8s\033[m\n&quot; &quot;NAME&quot;                ;
cat &lt;&lt; END
    asmdu.sh - Shows a clear and nice summary of the ASM diskgroups used and free space (https://bit.ly/3c1pvfQ)
END

printf &quot;\n\033[1;37m%-8s\033[m\n&quot; &quot;SYNOPSIS&quot;            ;
cat &lt;&lt; END
    $0 [-d] [-m -g -t] [-n] [-v] [-V] [-h]
END

printf &quot;\n\033[1;37m%-8s\033[m\n&quot; &quot;DESCRIPTION&quot;         ;
cat &lt;&lt; END
    $0 needs to be executed as the GI owner user to be able to use asmcmd
    With no option $0 will be showing what instances are running and a size summary for each DiskGroup
END

printf &quot;\n\033[1;37m%-8s\033[m\n&quot; &quot;OPTIONS&quot;             ;
cat &lt;&lt; END
    -d        The directory you want the size details

    -v        Verbose -- show the &quot;Total Raw&quot;, &quot;Raw Free&quot; and &quot;Reserved&quot; size
              You can change the default behavior with the DEFAULT_VERBOSE variable

    -m        Shows the output in MB
    -g        Shows the output in GB
    -t        Shows the output in TB
    -m -g -t  The default Unit can be specified using the DEFAULT_UNIT variable
              If more than one of these options is specified, the last one wins

    -n        Shows the output with no color (handy to send it by email)

    -V        Shows the version of the script
    -h        Shows this help

END
exit 123
}
#
# Parameters management
#
    PARAM_UNIT=&quot;&quot;
 PARAM_VERBOSE=&quot;&quot;
#
while getopts &quot;d:mgtnvhV&quot; OPT; do
    case ${OPT} in
    d)                  D=${OPTARG}                         ;;
    m)         PARAM_UNIT=&quot;MB&quot;                              ;;
    g)         PARAM_UNIT=&quot;GB&quot;                              ;;
    t)         PARAM_UNIT=&quot;TB&quot;                              ;;
    n)      PARAM_NOCOLOR=&quot;Yes&quot;                             ;;
    v)      PARAM_VERBOSE=&quot;Yes&quot;                             ;;
    V)      show_version; exit 567                          ;;
    h)      usage                                           ;;
    \?) echo &quot;Invalid option: -$OPTARG&quot; &gt;&amp;2; usage          ;;
    esac
done
#
if [[ -z &quot;${PARAM_UNIT}&quot; ]]; then                           # No parameter specified, we use the default
    UNIT=&quot;${DEFAULT_UNIT}&quot;
else
    UNIT=&quot;${PARAM_UNIT}&quot;
fi
if [[ -z &quot;${PARAM_VERBOSE}&quot; ]]; then                        # No parameter specified, we use the default
        VERBOSE=&quot;${DEFAULT_VERBOSE}&quot;
else
        VERBOSE=&quot;${PARAM_VERBOSE}&quot;
fi
if [[ -z &quot;${PARAM_NOCOLOR}&quot; ]]; then                        # No parameter specified, we use the default
        NOCOLOR=&quot;${DEFAULT_NOCOLOR}&quot;
else
        NOCOLOR=&quot;${PARAM_NOCOLOR}&quot;
fi
if [[ &quot;${NOCOLOR}&quot; == &quot;Yes&quot; ]]; then
          WHITE=&quot;&quot;
      END_COLOR=&quot;&quot;
fi
#
# Set the ASM env
#
if [[ -f &quot;${OLR}&quot; ]]; then
    export ORACLE_HOME=$(cat &quot;${OLR}&quot; | grep &quot;^crs_home&quot; | awk -F &quot;=&quot; &#x27;{print $2}&#x27;)
    export ORACLE_BASE=$(${ORACLE_HOME}/bin/orabase)
    export        PATH=&quot;${PATH}:${ORACLE_HOME}/bin&quot;
else
    ORACLE_SID=$(ps -ef | grep pmon | grep asm | awk &#x27;{print $NF}&#x27; | sed s&#x27;/asm_pmon_//&#x27; | egrep &quot;^[+]&quot;)
    export ORAENV_ASK=NO
    . oraenv &gt; /dev/null 2&gt;&amp;1
fi
#
# A quick list of the instances that are running on the server
#
ps -ef | grep pmon | grep -v grep | awk &#x27;{print $NF}&#x27; | cut -d_ -f3,4 | sort | awk -v H=&quot;`hostname -s`&quot; &#x27;BEGIN {printf(&quot;\n%s&quot;, &quot;Instances running on &quot; H &quot; : &quot;)} { printf(&quot;%s, &quot;, $0)} END{printf(&quot;\n&quot;)}&#x27; | sed s&#x27;/, $//&#x27;
#
# Manage parameters
#
if [[ -z &quot;${D}&quot; ]]; then                                    # No directory provided, will check all the DG
        DG=$(asmcmd lsdg | grep -v State | awk &#x27;{print $NF}&#x27; | sed s&#x27;/\///&#x27;)
    SUBDIR=&quot;No&quot;                                             # Do not show the subdirectories details if no directory is specified
else
        DG=$(echo $D | sed s&#x27;/\/.*$//g&#x27;)
fi
#
# A header
#
printf &quot;\n%25s%16s${WHITE}%16s${END_COLOR}&quot;   &quot;DiskGroup&quot; &quot;Redundancy&quot; &quot;Total ${UNIT}&quot;  # &quot;Raw Free ${UNIT}&quot; &quot;Reserved ${UNIT}&quot;  &quot;Usable ${UNIT}&quot; &quot;% Free&quot;
if [[ &quot;${VERBOSE}&quot; == &quot;Yes&quot; ]]; then
    printf &quot;%16s%16s%16s&quot; &quot;Raw Total ${UNIT}&quot; &quot;Raw Free ${UNIT}&quot; &quot;Reserved ${UNIT}&quot;
fi
printf &quot;${WHITE}%16s%14s${END_COLOR}\n&quot; &quot;Usable ${UNIT}&quot; &quot;% Free&quot;

printf &quot;%25s%16s${WHITE}%16s${END_COLOR}&quot;   &quot;---------&quot;     &quot;-----------&quot; &quot;--------&quot;
if [[ &quot;${VERBOSE}&quot; == &quot;Yes&quot; ]]; then
    printf &quot;%16s%16s%16s&quot;           &quot;------------&quot;  &quot;-----------&quot; &quot;-----------&quot;
fi
printf &quot;${WHITE}%16s${END_COLOR}%14s\n&quot;     &quot;---------&quot;     &quot;------&quot;
#
# Show DG info
#
for X in ${DG}; do
    asmcmd lsdg &quot;${X}&quot; | tail -1 |\
    awk -v DG=&quot;$X&quot; -v W=&quot;$WARNING&quot; -v C=&quot;$CRITICAL&quot; -v UNIT=&quot;$UNIT&quot; -v VERBOSE=&quot;$VERBOSE&quot; -v NOCOLOR=&quot;$NOCOLOR&quot; &#x27;\
    BEGIN \
    {   if (NOCOLOR == &quot;Yes&quot;) {
            COLOR_BEGIN =           &quot;&quot;                                  ;
              COLOR_END =           &quot;&quot;                                  ;
                    RED =           &quot;&quot;                                  ;
                  GREEN =           &quot;&quot;                                  ;
                 YELLOW =           &quot;&quot;                                  ;
                  WHITE =           &quot;&quot;                                  ;
                  COLOR =           &quot;&quot;                                  ;
        } else {
            COLOR_BEGIN =           &quot;\033[1;&quot;                           ;
              COLOR_END =           &quot;\033[m&quot;                            ;
                    RED =           COLOR_BEGIN&quot;31m&quot;                    ;
                  GREEN =           COLOR_BEGIN&quot;32m&quot;                    ;
                 YELLOW =           COLOR_BEGIN&quot;33m&quot;                    ;
                  WHITE =           COLOR_BEGIN&quot;37m&quot;                    ;
                  COLOR =           GREEN                               ;
        }
        DIVIDER = 1                                                     ;       # Unit divider
        RED_DIV = 1                                                     ;       # Redundancy divider

        if (UNIT == &quot;GB&quot;)       { DIVIDER=&quot;1024&quot;   }                    ;
        if (UNIT == &quot;TB&quot;)       { DIVIDER=&quot;1048576&quot;}                    ;       # 1024 * 1024
    }
    {   if ($2 == &quot;HIGH&quot;)           {RED_DIV=3                          ;}      # Redundancy divider
        if ($2 == &quot;NORMAL&quot;)         {RED_DIV=2                          ;}      # Redundancy divider

         TOTAL = sprintf(&quot;%16.2f&quot;, $(NF-6)/DIVIDER/RED_DIV)             ;       # Total mirrored in Unit
        USABLE = sprintf(&quot;%16.2f&quot;, $(NF-3)/DIVIDER)                     ;       # Usable space in Unit
          FREE = sprintf(&quot;%12d&quot;  , USABLE/TOTAL*100)                    ;       # % Free calculated using the Usable size

        if ((100-FREE) &gt; W)     { COLOR=YELLOW                          ;}      # Colored %Free thresholds
        if ((100-FREE) &gt; C)     { COLOR=RED                             ;}      # Colored %Free thresholds

        printf(&quot;%25s%16s%16s&quot;, DG, $2, WHITE TOTAL COLOR_END)           ;       # DG Redundancy and Total

        if (VERBOSE == &quot;Yes&quot;) {
            printf(&quot;%16.2f%16.2f%16.2f&quot;, $(NF-6)/DIVIDER, $(NF-5)/DIVIDER, $(NF-4)/DIVIDER);       # Total Raw, Raw Free and reserved if Verbose
        }
        printf(&quot;%16s%14s\n&quot;, WHITE USABLE COLOR_END, COLOR FREE COLOR_END)  ;       # Usable and Free %
    }&#x27;
done
printf &quot;\n&quot;
#
# Subdirs info
#
if [[ -z &quot;${SUBDIR}&quot; ]]; then
(for DIR in $(asmcmd ls &quot;${D}&quot;); do
            echo &quot;${DIR}&quot; $(asmcmd --nocp du &quot;${D}/${DIR}&quot; | tail -1)      # Please look at the &quot;About the --nocp option&quot; notes in the header for more information
#            echo ${DIR} `asmcmd du ${D}/${DIR} | tail -1`
done) | awk -v D=&quot;${D}&quot; -v UNIT=&quot;${UNIT}&quot;\
    &#x27; BEGIN {      printf(&quot;\n\t\t%40s\n\n&quot;, D &quot; subdirectories size&quot;)                      ;
                   printf(&quot;%25s%16s%16s\n&quot;, &quot;Subdir&quot;, &quot;Used &quot; UNIT, &quot;Raw Used &quot; UNIT)      ;
                   printf(&quot;%25s%16s%16s\n&quot;, &quot;------&quot;, &quot;-------&quot;, &quot;-----------&quot;)            ;

                   DIVIDER=1                                                               ;
                   if (UNIT == &quot;GB&quot;)       { DIVIDER=&quot;1024&quot;        }                       ;
                   if (UNIT == &quot;TB&quot;)       { DIVIDER=&quot;1048576&quot;     }                       ;   # 1024 * 1024
            }
            {
                   use=sprintf(&quot;%16.2f&quot;, $2/DIVIDER)                                       ;
                   mir=sprintf(&quot;%16.2f&quot;, $3/DIVIDER)                                       ;

                   printf(&quot;%25s%16s%16s\n&quot;, $1, use, mir)                                  ;

                   total_use += $2                                                         ;
                   total_mir += $3                                                         ;
            }
     END    {      total_use = sprintf(&quot;%16.2f&quot;, total_use/DIVIDER)                        ;
                   total_mir = sprintf(&quot;%16.2f&quot;, total_mir/DIVIDER)                        ;
                   printf(&quot;\n\n%25s%16s%16s\n&quot;, &quot;------&quot;, &quot;-------&quot;, &quot;---------&quot;)          ;
                   printf(&quot;%25s%16s%16s\n\n&quot;, &quot;Total&quot;, total_use, total_mir)               ;
             } &#x27;
fi
#
# For information
#
if [[ &quot;${VERBOSE}&quot; == &quot;Yes&quot; ]]; then
    printf &quot;\t\t%40s\n\n&quot; &quot;Note : Usable = (Raw Free - Reserved)/Redundancy&quot;                ;
fi
#****************************************************************************************#
#*                          E N D          O F          S O U R C E                     *#
#****************************************************************************************#</code></pre></details></li></ul><ul id="ad9e4a3a-3946-41b5-b2ad-b2fb17379df5" class="toggle"><li><details open=""><summary>Listar todos os DiskGroups</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="434e244c-8c8b-434f-87b5-7152d4a2a8a2" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ASMCMD&gt; lsdg

# Include dismounted diskgroups
ASMCMD&gt; lsdg --discovery

# List diskgroups across all nodes of cluster
ASMCMD&gt; lsdg -g --discovery</code></pre></details></li></ul><ul id="b4356109-5bfb-4fa8-99ee-2579b6ac65d7" class="toggle"><li><details open=""><summary>Listar os discos do ASM</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ffd8612f-cd8f-43b6-9229-cf9db1cc3550" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--List all asm disks
ASMCMD&gt; lsdsk -k

--List disks of a Diskgroup &lt;Diskgroup_name&gt; with free and total mb
ASMCMD&gt; lsdsk -k -g &lt;Diskgroup_name&gt;

--List disks of a diskgroup &lt;diskgroup_name&gt; with group and disk number
ASMCMD&gt; lsdsk -p -G &lt;diskgroup_name&gt;

--List disks with disk creation data
ASMCMD&gt; lsdsk -t -G &lt;diskgroup_name&gt;

--List candidate disk only
ASMCMD&gt; lsdsk --candidate -k

--List member disks only
ASMCMD&gt; lsdsk --candidate -p
</code></pre></details></li></ul><ul id="a08bb630-fbb9-4149-85f9-ed982cdbbe7c" class="toggle"><li><details open=""><summary>pegar os atributos de um ASM Diskgroup</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9c7250f5-4013-4dfe-9421-01d34d7414fd" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">-- List attribute of all diskgroups
ASMCMD&gt; lsattr - lm

-- List attribute of specific diskgroup &lt;diskgroup_name&gt;
ASMCMD&gt; lsattr -lm -G &lt;diskgroup_name&gt;

-- List attributes with specific pattern

ASMCMD&gt; lsattr -lm %au_size%

</code></pre></details></li></ul><ul id="ecad8c55-2666-4041-9da2-f86d1eac60d8" class="toggle"><li><details open=""><summary>Comandos para montar e desmontar um diskgroup</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5a008959-83f2-44ba-8ee8-693a7616187e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all"># Mount command works only on the local node. So if you want to Mount the diskgroup from all nodes of cluster, then run this command from all the nodes.

-- mount all diskgroups on local node
ASMCMD&gt; mount -a

-- mount a specific diskgroup on local node
ASMCMD&gt; mount &lt;diskgroup&gt;


# Unmount command works only on the local node. So if you want to unmount the diskgroup from all nodes of cluster, then run this command from all the nodes.

-- unmount all diskgroups
ASMCMD&gt; umount -a

-- unmount specific diskgroup &lt;diskgroup_names&gt;
ASMCMD&gt; umount &lt;diskgroup_name&gt;</code></pre></details></li></ul><p id="4a790741-8123-43b9-9463-6ac8539390da" class="">
</p><p id="feb2d176-947e-4895-ab8a-bb2ccc495b03" class=""><mark class="highlight-red">/**************************************************************************************<br/>--------------------------------------- ORACLE CPU-------------------——————<br/>**************************************************************************************/</mark></p><ul id="01ca3136-cd96-4a2c-ba3f-11acf5d9b48d" class="toggle"><li><details open=""><summary>Parameter CPU</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d6ad1e8b-4476-4121-bea1-d63442e5ac0d" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SHOW PARAMETER CPU;</code></pre></details></li></ul><ul id="4436eac3-b959-425b-a929-a79c8ffe99fd" class="toggle"><li><details open=""><summary>For plotting CPU, we compute the deltas of &quot;busy&quot; and &quot;idle&quot; time and use &quot;busy / (busy + idle)&quot; to get a CPU utilization percentage (RETORNA A % DE CPU EM DETERMINADO TEMPO).</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="25e1eed3-cbc2-43e3-9af6-65968e2d9680" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select &#x27;OS Busy Time&#x27; series, to_char(snaptime, &#x27;DD/MM/YYYY hh24:MI:SS&#x27;) snap_time, round(busydelta / (busydelta + idledelta) * 100, 2) &quot;CPU Use (%)&quot;
from (
select s.begin_interval_time snaptime,
os1.value - lag(os1.value) over (order by s.snap_id) busydelta,
os2.value - lag(os2.value) over (order by s.snap_id) idledelta
from dba_hist_snapshot s, dba_hist_osstat os1, dba_hist_osstat os2
where
s.snap_id = os1.snap_id and s.snap_id = os2.snap_id
and s.instance_number = os1.instance_number and s.instance_number = os2.instance_number
and s.dbid = os1.dbid and s.dbid = os2.dbid
and s.instance_number = (select instance_number from v$instance)
and s.dbid = (select dbid from v$database)
and os1.stat_name = &#x27;BUSY_TIME&#x27;
and os2.stat_name = &#x27;IDLE_TIME&#x27;)
ORDER BY SNAP_TIME ASC;</code></pre></details></li></ul><ul id="bd4d9269-8ebc-48c0-9481-309780448a27" class="toggle"><li><details open=""><summary>Consultar, CPU_ORACLE, CPU_OS</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c1864af5-0d45-4709-98bc-beebf12280de" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">-- para single instance
SELECT &#x27;CPU_ORACLE&#x27;          TYPE,
       ROUND(value / 100, 2) COST_PERCENT_CORE 
  FROM v$sysmetric
 WHERE metric_name = &#x27;CPU Usage Per Sec&#x27;
   AND group_id = 2
 UNION
SELECT &#x27;CPU_OS&#x27;                                             TYPE,
       ROUND((percent.busy * parameter.cpu_count) / 100, 2) COST_PERCENT_CORE
  FROM
    (SELECT value busy
       FROM v$sysmetric
      WHERE metric_name = &#x27;Host CPU Utilization (%)&#x27;
        AND group_id=2) percent,
    (SELECT value cpu_count
       FROM v$parameter
      WHERE name = &#x27;cpu_count&#x27;) parameter;
      
    /


-- para RAC
SELECT inst_id instancia,
      &#x27;CPU_ORACLE&#x27;          TYPE,
       ROUND(value / 100, 2) COST_PERCENT_CORE 
  FROM gv$sysmetric
 WHERE metric_name = &#x27;CPU Usage Per Sec&#x27;
   AND group_id = 2
 UNION
SELECT percent.instancia,
       &#x27;CPU_OS&#x27;                                             TYPE,
       ROUND((percent.busy * parameter.cpu_count) / 100, 2) COST_PERCENT_CORE
  FROM
    (SELECT INST_ID instancia, value busy
       FROM gv$sysmetric
      WHERE metric_name = &#x27;Host CPU Utilization (%)&#x27;
        AND group_id=2) percent,
    (SELECT INST_ID instancia, value cpu_count
       FROM gv$parameter
      WHERE name = &#x27;cpu_count&#x27;) parameter;</code></pre></details></li></ul><ul id="8e0f45a9-2e6e-4e1e-8390-d9194d487021" class="toggle"><li><details open=""><summary>Top 10 CPU consuming Session in Oracle</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dbddd078-e30b-428a-8b40-0239684e9727" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">set linesize 200
column PROGRAM FORMAT A50
column CPUHours FORMAT A300
select rownum as rank, a.*
from (
SELECT v.sid,sess.Serial# ,program, ROUND(v.value / (100 * 60 * 60), 2) CPUHours
FROM v$statname s , v$sesstat v, v$session sess
WHERE s.name = &#x27;CPU used by this session&#x27;
and sess.sid = v.sid
and v.statistic#=s.statistic#
and v.value&gt;0
ORDER BY v.value DESC) a
where rownum &lt; 11;</code></pre></details></li></ul><ul id="bf657826-0f35-45dd-b99c-d034b353e7bf" class="toggle"><li><details open=""><summary>SQL Text top consuming CPU in Oracle (running)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b1dd0b8e-a22e-4c05-ab52-1233355cee71" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select * from (
select p.spid &quot;ospid&quot;,
(se.SID),q.sql_text,ss.serial#,ss.SQL_ID,ss.username,substr(ss.program,1,30) &quot;program&quot;,
ss.module,ss.osuser,ss.MACHINE,ss.status,
se.VALUE/100 cpu_usage_sec,
round(((se.VALUE/100) / 60), 2) cpu_usage_min,
round(((se.VALUE/100) / 60 / 60), 2) cpu_usage_hour
from v$session ss,v$sesstat se,
v$statname sn,v$process p, v$sql q
where
se.STATISTIC# = sn.STATISTIC#
and NAME like &#x27;%CPU used by this session%&#x27;
and se.SID = ss.SID
and ss.username !=&#x27;SYS&#x27;
and ss.status=&#x27;ACTIVE&#x27;
and ss.username is not null
and ss.paddr=p.addr and value &gt; 0
and rownum &lt; 11
order by se.VALUE desc);</code></pre></details></li></ul><ul id="12a049a6-946e-4906-a7df-c266b36bb174" class="toggle"><li><details open=""><summary>SQL Text top consuming CPU in Oracle not running</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a67f5634-24ec-4f4e-ad42-e6989ac7a3b5" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select * from (
select p.spid &quot;ospid&quot;,
(se.SID),ss.serial#,ss.SQL_ID,ss.username,substr(ss.program,1,30) &quot;program&quot;,
ss.module,ss.osuser,ss.MACHINE,ss.status,
se.VALUE/100 cpu_usage_sec,
round(((se.VALUE/100) / 60), 2) cpu_usage_min,
round(((se.VALUE/100) / 60 / 60), 2) cpu_usage_hour
from v$session ss,v$sesstat se,
v$statname sn,v$process p
where
se.STATISTIC# = sn.STATISTIC#
and NAME like &#x27;%CPU used by this session%&#x27;
and se.SID = ss.SID
and ss.username !=&#x27;SYS&#x27;
and ss.status=&#x27;INACTIVE&#x27;
and ss.username is not null
and ss.paddr=p.addr and value &gt; 0
and rownum &lt; 11
order by se.VALUE desc);</code></pre></details></li></ul><ul id="6788afb3-11ae-442f-8cd0-89a1d3b690e1" class="toggle"><li><details open=""><summary><strong>SQL id consuming more CPU in Oracle</strong></summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f0206206-dc31-44de-81d7-6dcc323a9a2e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">col program form a30 heading &quot;Program&quot;
col cpu_usage_sec form 99990 heading &quot;CPU in Seconds&quot;
col MODULE for a18
col OSUSER for a10
col USERNAME for a15
col OSPID for a06 heading &quot;OS PID&quot;
col SID for 99999
col SERIAL# for 999999
col SQL_ID for a15
select * from (
select p.spid &quot;ospid&quot;,
(se.SID),ss.serial#,ss.SQL_ID,ss.username,substr(ss.program,1,30) &quot;program&quot;,
ss.module,ss.osuser,ss.MACHINE,ss.status,
se.VALUE/100 cpu_usage_sec
from v$session ss,v$sesstat se,
v$statname sn,v$process p
where
se.STATISTIC# = sn.STATISTIC#
and NAME like &#x27;%CPU used by this session%&#x27;
and se.SID = ss.SID
and ss.username !=&#x27;SYS&#x27;
and ss.status=&#x27;ACTIVE&#x27;
and ss.username is not null
and ss.paddr=p.addr and value &gt; 0
order by se.VALUE desc);</code></pre></details></li></ul><ul id="565a9f10-6d61-41df-805b-11f8689886ff" class="toggle"><li><details open=""><summary><strong>SQL Text top consuming CPU in Oracle</strong></summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2026a318-3cee-4575-a3ef-39606f91dddd" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">col cpu_usage_sec form 99990 heading &quot;CPU in Seconds&quot;
select * from (
select
(se.SID),q.sql_text,ss.module,ss.status,se.VALUE/100 cpu_usage_sec
from v$session ss,v$sesstat se,
v$statname sn, v$process p, v$sql q
where
se.STATISTIC# = sn.STATISTIC#
AND ss.sql_address = q.address
AND ss.sql_hash_value = q.hash_value
and NAME like &#x27;%CPU used by this session%&#x27;
and se.SID = ss.SID
and ss.username !=&#x27;SYS&#x27;
and ss.status=&#x27;ACTIVE&#x27;
and ss.username is not null
and ss.paddr=p.addr and value &gt; 0
order by se.VALUE desc);</code></pre></details></li></ul><ul id="e6745425-99b0-4b1d-afb3-ed0d779beecc" class="toggle"><li><details open=""><summary>SQL para encontrar sessões com maior consumo de CPU.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0bb3e3f5-f2f9-4c29-bbc7-ba451d5930e6" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Use below query to find the sessions using a lot of CPU for 1 node
select rownum as rank, a.* 
from ( 
SELECT 
       sess.username,
       sess.osuser,
       sess.sql_id,
       sess.prev_exec_start,
       sess.sid,
       sess.serial#, 
       program,
       sess.machine,
       sess.module,
       sess.status,
       round((v.value / (100 * 60 * 60)), 2) CPUHours,
       sess.type
FROM v$statname s , v$sesstat v, v$session sess 
WHERE s.name = &#x27;CPU used by this session&#x27; 
and sess.sid = v.sid 
and v.statistic#=s.statistic# 
and v.value&gt;0 
and username is not null
and username not in (&#x27;SYS&#x27;, &#x27;SYSRAC&#x27;, &#x27;DBSNMP&#x27;)
ORDER BY v.value DESC) a 
where rownum &lt; 11;</code></pre></details></li></ul><p id="e162f956-76da-43d7-a24a-58ba0dcd22b5" class="">
</p><p id="b95da192-0b07-41dd-975d-931e8f0f9413" class=""><mark class="highlight-red">/**************************************************************************************<br/>--------------------------------------- COLETA DE ESTATISTICAS-------------------——————<br/>**************************************************************************************/</mark></p><ul id="440db20c-5ca4-481d-9c01-1316d00b76c1" class="toggle"><li><details open=""><summary>Comando usado para consultar a data da ultima coleta</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="01808a41-c3da-4ef1-af86-418534fe6206" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">select t.owner, t.table_name, t.last_analyzed from all_all_tables t
where t.owner like (&#x27;%&lt;OWNER&gt;&#x27;)
Na coluna LAST_ANALYZED a data deve ser atual, se não for atual (maior do que 3 meses) acione o DBA responsável pela base para que possa realizar a coleta de estatísticas</code></pre></details></li></ul><ul id="cddedebe-3b55-47f3-8056-85d8369f6fa7" class="toggle"><li><details open=""><summary>Comando usado para consultar a data da ultima coleta (2)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="175a4a77-3ad5-41c1-9c73-5528cca46b01" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Na projeção da primeira consulta, deve-se observar a data de atualização das estatísticas das tabelas do seu ambiente:

SELECT TABLE_NAME, NUM_ROWS, BLOCKS, AVG_ROW_LEN, TO_CHAR(LAST_ANALYZED, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;) FROM DBA_TABLES WHERE TABLE_NAME IN (&#x27;FAT_SUMARI_NOTA_FISCAL_DEST&#x27;);
/

SELECT STAT.OWNER AS &quot;Schema proprietário&quot;,
         STAT.TABLE_NAME AS &quot;Nome do objeto&quot;,
         STAT.OBJECT_TYPE AS &quot;Tipo do objeto&quot;,
         STAT.NUM_ROWS AS &quot;Quant. de Linhas&quot;,
         TO_CHAR(STAT.LAST_ANALYZED, &#x27;DD/MM/YYYY HH24:MI:SS&#x27;) AS &quot;Última coleta das estatísticas&quot;
    FROM SYS.DBA_TAB_STATISTICS STAT
   WHERE STAT.OWNER =  &#x27;U_SAS&#x27; AND STAT.TABLE_NAME = &#x27;FAT_SUMARI_NOTA_FISCAL_DEST&#x27;
ORDER BY LAST_ANALYZED;</code></pre></details></li></ul><ul id="3a49bc11-0b9d-410a-9ea4-fe2d7d7d1b05" class="toggle"><li><details open=""><summary>Comando usado para listar as tabelas de um determinado schema/usuario ordenado pela data da ultima coleta.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3cc40159-3836-4734-8d19-dbade5966ca8" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT OWNER, TABLE_NAME, LAST_ANALYZED FROM DBA_TABLES
WHERE OWNER = &#x27;&lt;OWNER_NAME&gt;&#x27; ORDER BY 3;</code></pre></details></li></ul><ul id="4d2c7ff1-63cd-404d-a03a-3153cb6cfe77" class="toggle"><li><details open=""><summary>Comando usado para consultar estatistica</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f570619d-d4a9-4f25-9fed-ce77c1877206" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">saber quando as estatísticas dos índices foram coletadas pela última vez:

SELECT STAT.OWNER AS &quot;Schema proprietário&quot;,
         STAT. TABLE_NAME AS &quot;Nome do objeto&quot;,
         STAT.OBJECT_TYPE AS &quot;Tipo do objeto&quot;,
         STAT.NUM_ROWS AS &quot;Quant. de Linhas&quot;,
         STAT.LAST_ANALYZED AS &quot;Última coleta das estatísticas&quot;
    FROM SYS.DBA_IND_STATISTICS STAT
   WHERE STAT.OWNER NOT IN (&#x27;SYS&#x27;, &#x27;SYSTEM&#x27;, &#x27;SYSMAN&#x27;, &#x27;DBSNMP&#x27;)
ORDER BY LAST_ANALYZED;

Os campos projetados em ambas as consultas são:
&quot;Schema proprietário&quot;: - campo que informa o esquema dono do objeto;
&quot;Nome do objeto&quot;: - campo que informa o nome do objeto;
&quot;Tipo do objeto&quot;: - informa o tipo do campo, no caso: tabela ou índice;
&quot;Quant. de Linhas&quot;: - exibe a quantidade de registros do objeto;
&quot;Última coleta das estatísticas&quot;: - data e hora da realização da última coleta (mais recente) das estatísticas do objeto em questão.</code></pre></details></li></ul><ul id="d6adf90b-72e9-4e20-8e1e-ada3970be5c1" class="toggle"><li><details open=""><summary>Comando para coletar estatísticas de todos os objetos(tabelas, indeces…) do banco.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4d39488a-6d4d-4502-b773-3585bbd168f9" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">EXEC DBMS_STATS.GATHER_DATABASE_STATS;
--OU
EXECT DBMS_STATS.GATHER_DATABASE_STATS(
																			CASCADE=&gt;TRUE, 
                                      METHOD_OPT=&gt; &#x27;FOR ALL COLUMNS SIZE AUTO);
																			);</code></pre></details></li></ul><ul id="f7b5ab04-c07d-4796-b2a4-f5eddf2f8416" class="toggle"><li><details open=""><summary>Comando para coletar estatística do dicionário de dados</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0e96b81f-d6ae-4f2b-93be-bc06cd7697ee" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">EXEC DBMS_STATS.GATHER_DICTIONARY_STATS;</code></pre></details></li></ul><ul id="97233878-2f85-4e8e-b964-9f2ba1f30768" class="toggle"><li><details open=""><summary>Comando usado para coletar estatística de todas as tabelas de um schema/usuario</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b18810d7-bd47-4df7-88cb-5b3e9062228f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">	EXEC DBMS_STATS.GETHER_SCHEMA_STATS(&#x27;&lt;owner_name&gt;&#x27;,
																		 ESTIMATE_PERCENT=&gt;DBMS_STATS_AUTO_SAMPLE_SIZE,
																			 GRANULARITY=&gt;&#x27;GLOBAL AND PARTITION&#x27;
																		); 

--OU

exec DBMS_STATS.GATHER_SCHEMA_STATS(ownname=&gt;&#x27;&lt;OWNER_NAME&gt;&#x27;,estimate_percent=&gt;dbms_stats.auto_sample_size);</code></pre></details></li></ul><ul id="2e51f67e-55ae-445b-9bf8-5116a85be754" class="toggle"><li><details open=""><summary>Comando de cima porem com paralelismo</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a2e02cb8-5fab-4a3d-a106-84c0d41e9f8f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">EXEC DBMS_STATS.GATHER_SCHEMA_STATS(&#x27;&lt;owner_name&gt;&#x27;, ESTIMATE_PERCENT=&gt;DBMS_STATS.AUTO_SAMPLE_SIZE, GRANULARITY=&gt;&#x27;GLOBAL AND PARTITION&#x27;, DEGREE=&gt;8)</code></pre></details></li></ul><ul id="c3f87994-c336-41a3-8027-70fa5d380043" class="toggle"><li><details open=""><summary>Comando  para <strong>Coletar estatísticas básicas para uma tabela:</strong></summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bec42d53-c7d3-49d5-94d5-4c2de3836111" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">BEGIN
  DBMS_STATS.GATHER_TABLE_STATS(
    ownname =&gt; &#x27;esquema&#x27;,  -- Substitua pelo nome do esquema/proprietário da tabela
    tabname =&gt; &#x27;tabela&#x27;,   -- Substitua pelo nome da tabela
    estimate_percent =&gt; DBMS_STATS.AUTO_SAMPLE_SIZE,
    method_opt =&gt; &#x27;FOR ALL COLUMNS SIZE AUTO&#x27;
  );
END;
/</code></pre><p id="e4c3974d-7ecf-4507-b9e6-ac75a8c4fda4" class="">
</p></details></li></ul><ul id="220236c6-36be-4382-9652-c45dd411277f" class="toggle"><li><details open=""><summary>Comando para <strong>Coletar estatísticas com amostragem aleatória de 10%:</strong></summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="13f6273d-b373-4741-8f71-0f4caf9c1f29" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">BEGIN
  DBMS_STATS.GATHER_TABLE_STATS(
    ownname =&gt; &#x27;esquema&#x27;,
    tabname =&gt; &#x27;tabela&#x27;,
    estimate_percent =&gt; 10,
    method_opt =&gt; &#x27;FOR ALL COLUMNS SIZE AUTO&#x27;
  );
END;
/</code></pre></details></li></ul><ul id="f7c4251c-32ce-4585-801a-86776e6aec82" class="toggle"><li><details open=""><summary>Comando para <strong>Coletar estatísticas com amostragem por bloco de 10%:</strong></summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5141f48b-c170-49a6-8c26-465aec5f0537" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">BEGIN
  DBMS_STATS.GATHER_TABLE_STATS(
    ownname =&gt; &#x27;esquema&#x27;,
    tabname =&gt; &#x27;tabela&#x27;,
    estimate_percent =&gt; DBMS_STATS.AUTO_SAMPLE_SIZE,
    method_opt =&gt; &#x27;FOR ALL COLUMNS SIZE 1&#x27;
  );
END;
/</code></pre></details></li></ul><p id="2722f4ff-23af-404d-8bdf-dd0b2c4b8e7d" class="">
</p><p id="2ffece59-ab17-4578-873b-49fd48c41bef" class=""><mark class="highlight-red">/**************************************************************************************<br/>--------------------------------------- SQL PROFILE-------------------——————<br/>**************************************************************************************/</mark></p><ul id="8e7638ef-1204-47a6-84ae-7730836e266c" class="toggle"><li><details open=""><summary>Rodar o comando abaixo para utilizar o SQL PROFILE recomendado pelo STA</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b83503b9-be0b-4c6b-aa9e-b9535498ee92" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all"> execute dbms_sqltune.accept_sql_profile(task_name =&gt; &#x27;&lt;profile_name&gt;&#x27;,
            task_owner =&gt; &#x27;SYS&#x27;, replace =&gt; TRUE);
            
            
 SQL &gt; alter system flush shared_pool;</code></pre></details></li></ul><p id="7b3675b2-4281-4877-be32-e6566c0c1199" class="">
</p><p id="395fd8d3-a0e3-49b4-b03f-32c2d390806d" class="">
</p><p id="5107efd7-d57d-411f-a9bf-ef9996363a04" class=""><mark class="highlight-red">/**************************************************************************************<br/>--------------------------------------- RECOVERY AREA (RECOC)-------------------——————<br/>**************************************************************************************/</mark></p><ul id="03bc5e6a-f07e-4cbc-a08e-8b6cc4fe5e58" class="toggle"><li><details open=""><summary>Script para</summary></details></li></ul><p id="1e5673d2-52ed-4f6e-ae73-91550b214e21" class=""><mark class="highlight-red">/**************************************************************************************<br/>--------------------------------------- JOBS-------------------——————<br/>**************************************************************************************/</mark></p><ul id="508977d7-3cf7-4089-a323-d3d3e0346828" class="toggle"><li><details open=""><summary>Verificar JOBs executadas</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="31f9b949-1d04-4951-8e5c-98d5fd4acee2" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT to_char(log_date, &#x27;DD-MON-YY HH24:MM:SS&#x27;) TIMESTAMP, job_name, status,
   SUBSTR(additional_info, 1, 40) ADDITIONAL_INFO
   FROM user_scheduler_job_run_details ORDER BY log_date;</code></pre></details></li></ul><p id="f5e4a676-206b-46e7-89e3-6112a1198751" class="">
</p><ul id="76096ded-c3f5-4658-98a4-db400081a932" class="toggle"><li><details open=""><summary>Verificar JOBs em execução</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6de9b3a2-5cd2-4baf-acfe-7e9dcd3d6419" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SELECT OWNER, job_name, state FROM DBA_SCHEDULER_JOBS 
where job_name = &#x27;&lt;job_name&gt;&#x27;;</code></pre></details></li></ul><p id="c5cc2e95-80f6-4761-b3b3-b657173d6ecf" class="">
</p><ul id="f9fb1ec3-d318-4f36-b05b-2caa7af7ce9a" class="toggle"><li><details open=""><summary>Parar execução da JOB e desabilitar o agendamento de todo o banco.</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ab889fe3-cb40-42f5-b2af-0f26d7ad22da" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">BEGIN
    DBMS_SCHEDULER.DISABLE(&#x27;&quot;&lt;jobname&gt;&quot;&#x27;,true);
    DBMS_SCHEDULER.STOP_JOB(&#x27;&quot;&lt;jobname&gt;&quot;&#x27;);
END;


</code></pre></details></li></ul><p id="98cec5fa-038c-45ef-8bc7-cc1e0869aebb" class="">
</p><ul id="671894dc-5cbe-4360-880b-f20e07fbc76b" class="toggle"><li><details open=""><summary>Executar JOB</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="613089ef-b6d7-45c1-b902-2ad9a8c6bb7e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">Begin
  DBMS_SCHEDULER.RUN_JOB( 
    JOB_NAME            =&gt; &#x27;&lt;JOB_NAME&gt;&#x27;, 
    USE_CURRENT_SESSION =&gt; FALSE); 
END;</code></pre></details></li></ul><p id="75036e7a-dcf3-4586-b954-afa49debeb0e" class="">
</p><ul id="f78602be-4431-4479-8603-8deaf933135f" class="toggle"><li><details open=""><summary>Erro em executar job ORA-20001: comma-separated list (SOLUÇÃO)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="619797ab-b3d2-4756-86f0-af0bec738e5f" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">Begin
  DBMS_SCHEDULER.RUN_JOB( 
    JOB_NAME            =&gt; &#x27;&quot;CORPORATIVO CARGA AIDF&quot;&#x27;, 
    USE_CURRENT_SESSION =&gt; FALSE); 
END;</code></pre></details></li></ul><p id="7b6636f0-9def-49f6-97da-64691aa1fbc6" class="">
</p><ul id="91767089-8ca9-42e1-ba66-fd0200f89e29" class="toggle"><li><details open=""><summary>Copiar JOBs</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d92c1925-a2a7-4070-b92f-9418db78609c" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">DBMS_SCHEDULER.COPY_JOB
(
 old_job                       in varchar2,
 new_job                      in varchar2);</code></pre></details></li></ul><p id="0c6121c6-4588-46eb-8455-633b21e2f9fa" class="">
</p><ul id="ca1c79e1-ff17-4b5c-b5d0-99f28450bf26" class="toggle"><li><details open=""><summary>Apagar JOB</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f28b762f-3ef0-447c-a05e-8955b64b536d" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">DBMS_SCHEDULER.DROP_JOB
(
 job_name                    in varchar2,
 force               in Boolean default false
);</code></pre></details></li></ul><p id="7852636a-33ec-422d-98bf-3cd12ce5cdbd" class="">
</p><ul id="ef9387d0-e5e9-402a-89bc-f9578f994319" class="toggle"><li><details open=""><summary>Desabilitar JOB</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4f6e8780-e424-479e-aa8d-8b354855afec" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">exec dbms_scheduler.disable(&#x27;&quot;&lt;schema&gt;&quot;.&quot;&lt;job_name&gt;&quot;&#x27;);</code></pre></details></li></ul><p id="30b94976-9e05-4613-922f-3d2eb794125d" class="">
</p><ul id="142306dc-0fcf-496e-9718-cff7e5cecf23" class="toggle"><li><details open=""><summary>Parando a JOB com scheduler desativado</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="073e396c-c370-4e5d-b11e-752b12381bd8" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Importante: Esse procedimento fará todas as JOBS da database serem interrompidas, portanto avise os responsáveis antes de realizar o processo.
--1 ) Dentro do user SYS do esquema
show parameter job_queue_processes; (anote o valor do job_queue_processes)

exec dbms_scheduler.set_scheduler_attribute(&#x27;SCHEDULER_DISABLED&#x27;, &#x27;TRUE&#x27;);

exec dbms_scheduler.stop_job(&#x27;&#x27;SCHEMA&#x27;.&quot;JOB&quot;&#x27;,true);

alter system set job_queue_processes=0;
exec dbms_ijob.set_enabled(FALSE);

alter system flush shared_pool;

exec dbms_ijob.set_enabled(TRUE);
alter system set job_queue_processes=1000;
exec dbms_scheduler.set_scheduler_attribute(&#x27;SCHEDULER_DISABLED&#x27;, &#x27;FALSE&#x27;);</code></pre></details></li></ul><ul id="ad82968c-4e11-49a0-aef0-4ab80c74b204" class="toggle"><li><details open=""><summary>Correção para Jobs pulando agendamento</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a44c0927-a4bd-4545-a70f-9cfb9836a73b" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Importante: Esse procedimento fará todas as JOBS da database serem interrompidas, portanto avise os responsáveis antes de realizar o processo.
--1) Execute os seguintes comandos em sequência:
--&#x27;&#x27;&#x27;OBS: Execute os comandos no esquema SYS&#x27;&#x27;&#x27;
exec dbms_scheduler.disable(&#x27;MONDAY_WINDOW&#x27;);
exec dbms_scheduler.disable(&#x27;TUESDAY_WINDOW&#x27;);
exec dbms_scheduler.disable(&#x27;WEDNESDAY_WINDOW&#x27;);
exec dbms_scheduler.disable(&#x27;THURSDAY_WINDOW&#x27;);
exec dbms_scheduler.disable(&#x27;FRIDAY_WINDOW&#x27;);
exec dbms_scheduler.disable(&#x27;SATURDAY_WINDOW&#x27;);
exec dbms_scheduler.disable(&#x27;SUNDAY_WINDOW&#x27;);

exec dbms_scheduler.set_scheduler_attribute(&#x27;SCHEDULER_DISABLED&#x27;, &#x27;TRUE&#x27;);

alter system set job_queue_processes=0;

exec dbms_ijob.set_enabled(FALSE);

alter system flush shared_pool;
alter system flush shared_pool;

exec dbms_ijob.set_enabled(TRUE);

alter system set job_queue_processes=1000;

exec dbms_scheduler.set_scheduler_attribute(&#x27;SCHEDULER_DISABLED&#x27;, &#x27;FALSE&#x27;);

exec dbms_scheduler.enable(&#x27;MONDAY_WINDOW&#x27;);
exec dbms_scheduler.enable(&#x27;TUESDAY_WINDOW&#x27;);
exec dbms_scheduler.enable(&#x27;WEDNESDAY_WINDOW&#x27;);
exec dbms_scheduler.enable(&#x27;THURSDAY_WINDOW&#x27;);
exec dbms_scheduler.enable(&#x27;FRIDAY_WINDOW&#x27;);
exec dbms_scheduler.enable(&#x27;SATURDAY_WINDOW&#x27;);
exec dbms_scheduler.enable(&#x27;SUNDAY_WINDOW&#x27;);

--2) Logo em seguida tente executar a job manualmente com o seguinte comando:
--&#x27;&#x27;&#x27;OBS: Execute o script no esquema que a JOB está criada.&#x27;&#x27;&#x27;
BEGIN
DBMS_SCHEDULER.RUN_JOB(
JOB_NAME =&gt; &#x27;&#x27;,
USE_CURRENT_SESSION =&gt; FALSE);
END;
/

--3) Verifique se o job rodou em:
select * from dba_scheduler_job_run_details where job_name=&#x27;&#x27;;

--4) Em último caso, se mesmo assim a job não tiver rodado:
--Crie a DDL do job:
--&#x27;&#x27;&#x27;OBS: Execute o script no esquema que a JOB está criada.&#x27;&#x27;&#x27;
--&#x27;&#x27;&#x27;OBS: Mantenha o &quot;PROCOBJ&quot;, altere apenas o nome do job no segundo parâmetro&#x27;&#x27;&#x27;

select dbms_metadata.get_ddl(&#x27;PROCOBJ&#x27;, &#x27;&#x27;) from dual;

ATENÇÃO: Após rodar a consulta, na linha da DDL onde tem o sys.dbms_scheduler.set_attribute verifique se as configurações do NLS estão para o Brasil,
se não estiver, será necessário realizar a alteração!

--Exemplo:

sys.dbms_scheduler.set_attribute(&#x27;&quot;MONITORAMENTO_JOB_2&quot;&#x27;,&#x27;NLS_ENV&#x27;,&#x27;NLS_LANGUAGE=&#x27;&#x27;BRAZILIAN PORTUGUESE&#x27;&#x27; NLS_TERRITORY=&#x27;&#x27;BRAZIL&#x27;&#x27; NLS_CURRENCY=&#x27;&#x27;R$&#x27;&#x27; NLS_ISO_CURRENCY=&#x27;&#x27;BRAZIL&#x27;&#x27; NLS_NUMERIC_CHARACTERS=&#x27;&#x27;,.&#x27;&#x27; NLS_CALENDAR=&#x27;&#x27;GREGORIAN&#x27;&#x27; NLS_DATE_FORMAT=&#x27;&#x27;DD/MM/YYYY HH24:MI:SS&#x27;&#x27; NLS_DATE_LANGUAGE=&#x27;&#x27;BRAZILIAN PORTUGUESE&#x27;&#x27; NLS_SORT=&#x27;&#x27;WEST_EUROPEAN&#x27;&#x27; NLS_TIME_FORMAT=&#x27;&#x27;HH24:MI:SSXFF&#x27;&#x27; NLS_TIMESTAMP_FORMAT=&#x27;&#x27;DD/MM/YYYY HH24:MI:SSXFF&#x27;&#x27; NLS_TIME_TZ_FORMAT=&#x27;&#x27;HH24:MI:SSXFF TZR&#x27;&#x27; NLS_TIMESTAMP_TZ_FORMAT=&#x27;&#x27;DD/MM/YYYY HH24:MI:SSXFF TZR&#x27;&#x27; NLS_DUAL_CURRENCY=&#x27;&#x27;Cr$&#x27;&#x27; NLS_COMP=&#x27;&#x27;BINARY&#x27;&#x27; NLS_LENGTH_SEMANTICS=&#x27;&#x27;BYTE&#x27;&#x27; NLS_NCHAR_CONV_EXCP=&#x27;&#x27;FALSE&#x27;&#x27;&#x27;);</code></pre></details></li></ul><p id="8d15f801-67fa-43ae-9d8e-80bdf9ee0f72" class="">
</p><p id="a34a5038-389d-45ba-9738-6775c8fa1bb7" class=""><mark class="highlight-red">/**************************************************************************************<br/>--------------------------------------- JAVA -------------------——————<br/>**************************************************************************************/</mark></p><ul id="abd3a530-6980-41f7-aa1c-af2c248bd946" class="toggle"><li><details open=""><summary>Verificar/Atribuir permissões do JAVA</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="983192fe-5599-43f0-93c9-1a62f0d0cd59" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">--Para verificar todos os GRANTs do java atribuidos a um usuário / esquema
SELECT * FROM DBA_JAVA_POLICY WHERE GRANTEE = &#x27;&lt;user_schema&gt;&#x27;;
   --substituir &lt;user_schema&gt; pelo nome do esquema / usuário

   SELECT * FROM SYS.dba_tab_privs
   WHERE OWNER = &#x27;SYS&#x27;
   AND TABLE_NAME LIKE &#x27;%JAVA%&#x27;

--Para atribuir um GRANT de acesso do java a um diretorio:
exec dbms_java.grant_permission( &#x27;&lt;user_schema&gt;&#x27;, &#x27;SYS:java.io.FilePermission&#x27;, &#x27;&lt;dir_name&gt;&#x27;, &#x27;read&#x27; )

   --I) substituir &lt;user_schema&gt; pelo nome do esquema / usuário
   --II) SYS:java.io.FilePermission é o tipo de permissão a ser atribuída
   --III) &lt;dir_name&gt; é o caminho completo do diretório
   --IV) read é a permissão de somente leitura, podendo ser também write para gravação e delete para exclusão</code></pre></details></li></ul><p id="4e4d690f-e1fb-466a-9508-6a56f9b34c96" class="">
</p><p id="e9979a64-4217-40b0-97bd-e6ba415365a7" class="">
</p><p id="977b87a6-4c3a-445d-89f8-bbe1ce88eab9" class=""><mark class="highlight-red">/**************************************************************************************<br/>-------------------------------------ORACLE MULTITENANT-------------------——————<br/>**************************************************************************************/</mark></p><p id="76c8cd75-18e7-4dc5-93da-d976dd74da9a" class="">
</p><ul id="2672301b-7abd-4b0e-aae4-63a4e50d218a" class="toggle"><li><details open=""><summary>Comando para mudar de container (PDB) dentro do CDB</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d790b48d-cc92-4bb0-a74e-6d5c4f7f0f5e" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">ALTER SESSION SET CONTAINER=PDB_NAME;</code></pre></details></li></ul><ul id="a9e205e6-5da5-44b3-965b-ea874b54d0a2" class="toggle"><li><details open=""><summary>Comando para checar o container atual</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ac03dcc7-21f5-4ac0-bf66-fddad74febec" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SHOW CON_NAME</code></pre></details></li></ul><ul id="927a5775-62c0-4f5a-a376-b0f5798b22b9" class="toggle"><li><details open=""><summary>Comando para listar os PDBs</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f23bb5d4-0672-44e1-89e4-f8cddc7aa647" class="code code-wrap"><code class="language-SQL" style="white-space:pre-wrap;word-break:break-all">SHOW PDBS;</code></pre></details></li></ul><p id="0e837bc6-8718-4e17-b2a1-06ab1ea4f404" class="">
</p><p id="5f428ebe-ac98-4e2e-aeb0-9d06cf72cac4" class="">
</p><p id="065d7567-f66b-45d3-9bd1-5207e2fb1837" class=""><mark class="highlight-red">/**************************************************************************************<br/>--------------------------------------- DOC PARA INSTALAR UM ORACLE SINGLE INSTANCE -------------------——————<br/>**************************************************************************************/</mark></p><p id="45bd5f7c-0960-4480-9344-41df2fded991" class="">
</p><figure id="f607c84e-4a07-4591-ab5e-51626111dae1" class="link-to-page"><a href="https://www.notion.so/DOC-INSTALA-O-ORACLE-GRID-ASM-SINGLE-INSTANCE-f607c84e4a074591ab5e51626111dae1?pvs=21">DOC INSTALAÇÃO ORACLE GRID ASM SINGLE INSTANCE</a></figure><p id="b0579291-6b22-46c2-8e1a-067f4b88a0fb" class="">
</p><p id="3cefac10-9a1a-43e3-ba75-e33b5c1acd21" class="">
</p><p id="3ae5f3e1-0a78-49fb-87e2-0a9a34084a7d" class="">
</p><p id="7435f8e4-b0d0-41f0-9b55-8c206c999607" class="">
</p><p id="34fce26a-0b73-4244-959b-393ab11c5243" class="">ORA-00257: Erro de archiver. Conecte como SYSDBA só até ser resolvido.</p><p id="2b4864eb-009a-8067-b65a-ccdf8a6b755b" class="">
</p><p id="2b4864eb-009a-808b-a173-ecd27d14b2a3" class="">/t</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>